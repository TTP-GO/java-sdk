<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TTP Agent SDK - Documentation</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Mobile Header (only visible on mobile) -->
  <header class="mobile-header">
    <div class="mobile-header-logo">
      <img src="https://talktopc.com/logo192.png" alt="TTP Logo">
      <h1 class="mobile-header-title">TTP Agent SDK</h1>
    </div>
  </header>

  <div class="documentation">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
          <img src="https://talktopc.com/logo192.png" alt="TTP Logo" style="width: 40px; height: 40px; border-radius: 8px;">
          <div>
            <h1 style="margin: 0; font-size: 1.4rem;">TTP Agent SDK</h1>
            <p class="version" style="margin: 0;">v2.3.18</p>
          </div>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <div class="nav-section">
          <h3>Getting Started</h3>
          <ul>
            <li><a href="#introduction" class="nav-link active">Introduction</a></li>
            <li><a href="#installation" class="nav-link">Installation</a></li>
            <li><a href="#quick-start" class="nav-link">Quick Start</a></li>
          </ul>
        </div>

        <div class="nav-section">
          <h3>Core Concepts</h3>
          <ul>
            <li><a href="#authentication" class="nav-link">Authentication</a></li>
            <li><a href="#agent-override" class="nav-link">Agent Override</a></li>
            <li><a href="#events" class="nav-link">Events & Callbacks</a></li>
            <li><a href="#protocol-v2" class="nav-link">Protocol v2 - Format Negotiation</a></li>
          </ul>
        </div>

        <div class="nav-section">
          <h3>Guides</h3>
          <ul>
            <li><a href="#text-chat-widget" class="nav-link">Voice & Chat Widget</a></li>
            <li><a href="#vanilla-js" class="nav-link">Vanilla JavaScript</a></li>
            <li><a href="#react" class="nav-link">React Integration</a></li>
            <li><a href="#voice-button" class="nav-link">VoiceButton Component</a></li>
          </ul>
        </div>

        <div class="nav-section">
          <h3>Backend SDKs</h3>
          <ul>
            <li><a href="#java-sdk" class="nav-link">Java SDK</a></li>
            <li><a href="#java-sdk-installation" class="nav-link">Installation</a></li>
            <li><a href="#java-sdk-quick-start" class="nav-link">Quick Start</a></li>
            <li><a href="#java-sdk-api" class="nav-link">API Reference</a></li>
            <li><a href="#java-sdk-examples" class="nav-link">Examples</a></li>
          </ul>
        </div>

        <div class="nav-section">
          <h3>API Reference</h3>
          <ul>
            <li><a href="#voicesdk" class="nav-link">VoiceSDK Class</a></li>
            <li><a href="#methods" class="nav-link">Methods</a></li>
            <li><a href="#events-api" class="nav-link">Events</a></li>
            <li><a href="#configuration" class="nav-link">Configuration</a></li>
            <li><a href="#text-to-speech" class="nav-link">Text-to-Speech API</a></li>
          </ul>
        </div>

        <div class="nav-section">
          <h3>Examples</h3>
          <ul>
            <li><a href="../examples/test-text-chat.html" target="_blank">Live Widget Demo üöÄ</a></li>
          </ul>
        </div>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="content">
      <div class="content-wrapper">
        <!-- Introduction -->
        <section id="introduction" class="doc-section">
          <h1>Introduction</h1>
          <p class="lead">TTP Agent SDK is a powerful JavaScript library for building AI-powered voice and chat interactions in your web applications.</p>
          
          <!-- Quick Links Menu -->
          <div class="quick-links-container">
            <h2 style="text-align: center; margin-bottom: 25px; color: var(--text-primary);">What We Offer</h2>
            <div class="quick-links-grid">
              <a href="#text-chat-widget" class="quick-link-card">
                <div class="quick-link-icon">üéôÔ∏èüí¨</div>
                <h3>Voice & Chat Widget</h3>
                <p>Drop-in widget with voice & text for any website</p>
                <span class="quick-link-arrow">‚Üí</span>
              </a>
              
              <a href="#vanilla-js" class="quick-link-card">
                <div class="quick-link-icon">üé§</div>
                <h3>Voice SDK</h3>
                <p>Real-time voice AI integration</p>
                <span class="quick-link-arrow">‚Üí</span>
              </a>
              
              <a href="#react" class="quick-link-card">
                <div class="quick-link-icon" style="display: flex; gap: 8px; align-items: center;">
                  <span style="font-size: 2rem;">‚öõÔ∏è</span>
                  <span style="font-size: 2rem; color: #dd0031;">üÖ∞Ô∏è</span>
                  <span style="font-size: 1.5rem; font-weight: bold; background: #f7df1e; color: #000; padding: 4px 8px; border-radius: 4px; font-family: monospace;">JS</span>
                </div>
                <h3>Integrations</h3>
                <p>React / Angular / Vanilla JS</p>
                <span class="quick-link-arrow">‚Üí</span>
              </a>
              
              <a href="#agent-override" class="quick-link-card">
                <div class="quick-link-icon">‚öôÔ∏è</div>
                <h3>Agent Override</h3>
                <p>Dynamic AI customization</p>
                <span class="quick-link-arrow">‚Üí</span>
              </a>
              
              <a href="#text-to-speech" class="quick-link-card">
                <div class="quick-link-icon">üîä</div>
                <h3>Text To Speech</h3>
                <p>REST API for voice synthesis</p>
                <span class="quick-link-arrow">‚Üí</span>
              </a>
              
              <a href="#java-sdk" class="quick-link-card">
                <div class="quick-link-icon">‚òï</div>
                <h3>Java SDK</h3>
                <p>Backend SDK for server-side TTS</p>
                <span class="quick-link-arrow">‚Üí</span>
              </a>
            </div>
          </div>

          <!-- Key Features -->
          <div style="margin-top: 50px;">
            <h2 style="margin-bottom: 20px;">Key Features</h2>
            <div class="features-compact">
              <div class="feature-compact-item">
                <span class="feature-compact-icon">üîí</span>
                <div>
                  <strong>Secure Authentication</strong>
                  <p>Backend-to-backend signed link authentication with JWT and TTL-based expiration</p>
                </div>
              </div>
              <div class="feature-compact-item">
                <span class="feature-compact-icon">üé®</span>
                <div>
                  <strong>Fully Customizable</strong>
                  <p>Colors, branding, languages, RTL support, and custom agent settings</p>
                </div>
              </div>
              <div class="feature-compact-item">
                <span class="feature-compact-icon">üì±</span>
                <div>
                  <strong>Mobile Optimized</strong>
                  <p>Works seamlessly on desktop, tablet, and mobile devices</p>
                </div>
              </div>
              <div class="feature-compact-item">
                <span class="feature-compact-icon">üåç</span>
                <div>
                  <strong>Multi-language</strong>
                  <p>Built-in support for multiple languages and custom translations</p>
                </div>
              </div>
              <div class="feature-compact-item">
                <span class="feature-compact-icon">‚ö°</span>
                <div>
                  <strong>Real-time Streaming</strong>
                  <p>WebSocket-based audio streaming with low latency</p>
                </div>
              </div>
              <div class="feature-compact-item">
                <span class="feature-compact-icon">üîß</span>
                <div>
                  <strong>Easy Integration</strong>
                  <p>Simple CDN setup or NPM package with comprehensive API</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Installation -->
        <section id="installation" class="doc-section">
          <h1>Installation</h1>
          
          <h2>NPM</h2>
          <pre><code>npm install ttp-agent-sdk</code></pre>

          <h2>CDN</h2>
          <pre><code>&lt;script src="https://unpkg.com/ttp-agent-sdk/dist/agent-widget.js"&gt;&lt;/script&gt;</code></pre>

          <h2>Import</h2>
          <pre><code>// ES6 Import
import { VoiceSDK } from 'ttp-agent-sdk';

// CommonJS
const { VoiceSDK } = require('ttp-agent-sdk');

// Browser Global
const sdk = new window.TTPAgentSDK.VoiceSDK(config);</code></pre>
        </section>

        <!-- Quick Start -->
        <section id="quick-start" class="doc-section">
          <h1>Quick Start</h1>
          <p>Get up and running in 5 minutes with this simple example.</p>

          <div class="step-card">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3>Get a Signed URL</h3>
              <div class="warning-box">
                <strong>üîí Backend-to-Backend:</strong> Your frontend requests from YOUR backend, which then communicates with TTP backend. Never expose your API key to the frontend!
              </div>
              <p><strong>Frontend ‚Üí Your Backend:</strong></p>
              <pre><code>const response = await fetch('/api/get-voice-session', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    agentId: 'agent_123'
  })
});

const { signedUrl } = await response.json();</code></pre>
              <p><strong>Your Backend ‚Üí TTP Backend:</strong> (See Authentication section for details)</p>
            </div>
          </div>

          <div class="step-card">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3>Initialize the SDK</h3>
              <p>Create a VoiceSDK instance with the signed URL:</p>
              <pre><code>import { VoiceSDK } from 'ttp-agent-sdk';

const voiceSDK = new VoiceSDK({
  websocketUrl: signedUrl,  // Signed URL from step 1
  appId: 'your_app_id',     // Your application ID
  agentId: 'agent_123',     // The AI agent to connect to
  
  // Optional: Configure audio formats (v2 protocol)
  outputContainer: 'raw',      // 'raw' or 'wav'
  outputEncoding: 'pcm',       // 'pcm', 'pcmu', 'pcma'
  outputSampleRate: 44100,     // Higher quality audio
  protocolVersion: 2           // Use v2 protocol for format negotiation
});

// Listen to events
voiceSDK.on('connected', () => {
  console.log('‚úÖ Connected to agent');
});

voiceSDK.on('formatNegotiated', (format) => {
  console.log('‚úÖ Format negotiated:', format);
  // Format contains: container, encoding, sampleRate, channels, bitDepth
});

voiceSDK.on('message', (msg) => {
  if (msg.t === 'agent_response') {
    console.log('Agent:', msg.agent_response);
  }
});</code></pre>
            </div>
          </div>

          <div class="step-card">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3>Connect & Start Recording</h3>
              <p>Connect to the agent and start capturing audio:</p>
              <pre><code>// Connect
await voiceSDK.connect();

// Start recording
await voiceSDK.startRecording();

// Stop recording
await voiceSDK.stopRecording();</code></pre>
            </div>
          </div>
        </section>

        <!-- Authentication -->
        <section id="authentication" class="doc-section">
          <h1>Authentication</h1>
          <p>TTP Agent SDK uses signed WebSocket URLs for secure authentication.</p>

          <div class="info-box">
            <strong>üîí Security First:</strong> All connections require signed URLs obtained from your backend, which authenticates with the TTP backend using an API key.
          </div>

          <h2>Authentication Flow</h2>
          <div class="warning-box">
            <strong>üîê Critical Security Note:</strong> The signed URL generation happens <strong>Backend-to-Backend</strong>. Your frontend NEVER directly contacts TTP backend. This protects your API key!
          </div>
          <div class="flow-diagram">
            <div class="flow-step">
              <div class="flow-box" style="background: linear-gradient(135deg, #e0f2fe 0%, #bfdbfe 100%);">
                <strong>1. üñ•Ô∏è Your Frontend</strong>
                <p>User clicks "Start Voice Chat"</p>
              </div>
              <div class="flow-arrow">‚Üì</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                <strong>2. üîß Your Backend</strong>
                <p>Receives: POST /api/get-voice-session</p>
              </div>
              <div class="flow-arrow">‚Üì üîí Backend-to-Backend (API Key)</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #e9d5ff 0%, #d8b4fe 100%);">
                <strong>3. üè¢ TTP Backend</strong>
                <p>Validates API key & generates signed JWT</p>
              </div>
              <div class="flow-arrow">‚Üë Returns signed URL</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                <strong>4. üîß Your Backend</strong>
                <p>Forwards signed URL to frontend</p>
              </div>
              <div class="flow-arrow">‚Üì</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #e0f2fe 0%, #bfdbfe 100%);">
                <strong>5. üñ•Ô∏è Your Frontend</strong>
                <p>Uses SDK with signed URL (WebSocket)</p>
              </div>
            </div>
          </div>

          <h2>Backend Implementation (Backend-to-Backend)</h2>
          <p><strong>Your backend acts as a secure proxy between your frontend and TTP backend:</strong></p>
          
          <div class="info-box">
            <strong>üí° Architecture:</strong> Frontend ‚Üí Your Backend ‚Üí TTP Backend ‚Üí Your Backend ‚Üí Frontend
          </div>
          
          <div class="success-box">
            <strong>‚è±Ô∏è Configurable TTL:</strong> You can specify <code>expirationMs</code> (in milliseconds) to control how long the signed URL is valid. Default is 1 hour (3600000ms) if not specified.
            <br><br>
            <strong>Examples:</strong>
            <ul style="margin-top: 10px; margin-left: 20px;">
              <li>5 minutes: <code>300000</code></li>
              <li>1 hour (default): <code>3600000</code></li>
              <li>24 hours: <code>86400000</code></li>
            </ul>
          </div>
          
          <pre><code>// Example: Node.js/Express
// This endpoint is called by YOUR FRONTEND
app.post('/api/get-voice-session', async (req, res) => {
  const { agentId } = req.body;
  
  // 1Ô∏è‚É£ Authenticate YOUR user (your auth logic)
  if (!req.user) {
    return res.status(401).json({ error: 'Unauthorized' });
  }
  
  // 2Ô∏è‚É£ Backend-to-Backend: Call TTP Backend with YOUR API Key
  // ‚ö†Ô∏è This happens SERVER-SIDE only - API key never exposed to frontend
  const response = await fetch('https://backend.talktopc.com/api/public/agents/signed-url', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${process.env.TTP_API_KEY}`  // üîí Secret - never in frontend!
    },
    body: JSON.stringify({
      agentId: agentId,
      appId: process.env.TTP_APP_ID,
      expirationMs: 3600000,  // Optional: Token TTL in milliseconds (default: 1 hour)
      allowOverride: true     // Optional: Enable agent settings override (default: false)
    })
  });
  
  const { signedLink } = await response.json();
  
  // 3Ô∏è‚É£ Return signed URL to YOUR frontend
  res.json({ signedUrl: signedLink });
});</code></pre>

          <div class="warning-box">
            <strong>‚ö†Ô∏è Never expose your API key:</strong> The API key should only be used on your backend server, never in frontend code.
          </div>

          <h2>Response Format</h2>
          <p>The signed URL endpoint returns the following response:</p>
          <pre><code>{
  "signedLink": "wss://speech.talktopc.com/ws/conv?signed_token=eyJ...",
  "agentId": "agent_123",
  "userId": "user_789",
  "appId": "your_app_id",
  "expiresAt": "2025-11-11T21:00:00.000+00:00",
  "expiresIn": 3600000,
  "generatedAt": "2025-11-11T20:00:00.000+00:00",
  "availableCredits": 150.5,
  "authenticationStatus": "SUCCESS"
}</code></pre>

          <table class="properties-table">
            <thead>
              <tr>
                <th>Property</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>signedLink</code></td>
                <td>string</td>
                <td>The WebSocket URL with signed JWT token</td>
              </tr>
              <tr>
                <td><code>agentId</code></td>
                <td>string</td>
                <td>The AI agent identifier</td>
              </tr>
              <tr>
                <td><code>userId</code></td>
                <td>string</td>
                <td>Your user's identifier (ttpId)</td>
              </tr>
              <tr>
                <td><code>appId</code></td>
                <td>string</td>
                <td>Your application identifier</td>
              </tr>
              <tr>
                <td><code>expiresAt</code></td>
                <td>Date</td>
                <td>When the signed URL expires (ISO 8601 format)</td>
              </tr>
              <tr>
                <td><code>expiresIn</code></td>
                <td>number</td>
                <td>Token validity duration in milliseconds</td>
              </tr>
              <tr>
                <td><code>generatedAt</code></td>
                <td>Date</td>
                <td>When the signed URL was generated (ISO 8601 format)</td>
              </tr>
              <tr>
                <td><code>availableCredits</code></td>
                <td>number</td>
                <td>User's remaining credit balance</td>
              </tr>
              <tr>
                <td><code>authenticationStatus</code></td>
                <td>string</td>
                <td>Always "SUCCESS" for successful requests</td>
              </tr>
            </tbody>
          </table>

          <h2>JWT Token Properties</h2>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Property</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>agentId</code></td>
                <td>The AI agent identifier</td>
              </tr>
              <tr>
                <td><code>userId</code></td>
                <td>Your user's identifier</td>
              </tr>
              <tr>
                <td><code>appId</code></td>
                <td>Your application identifier</td>
              </tr>
              <tr>
                <td><code>allowOverride</code></td>
                <td>Permission flag for agent settings override (optional)</td>
              </tr>
              <tr>
                <td><code>exp</code></td>
                <td>Token expiration time (TTL - configurable via <code>expirationMs</code>, defaults to 1 hour)</td>
              </tr>
            </tbody>
          </table>
          
          <h2>Request Parameters</h2>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Required</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>agentId</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>The AI agent identifier</td>
              </tr>
              <tr>
                <td><code>appId</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>Your application identifier</td>
              </tr>
              <tr>
                <td><code>expirationMs</code></td>
                <td>number</td>
                <td>No</td>
                <td>Token TTL in milliseconds (default: 3600000 = 1 hour)</td>
              </tr>
              <tr>
                <td><code>allowOverride</code></td>
                <td>boolean</td>
                <td>No</td>
                <td>Enable agent settings override permission (default: false)</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- Agent Override -->
        <section id="agent-override" class="doc-section">
          <h1>Agent Settings Override</h1>
          <p class="badge-new">NEW FEATURE</p>
          <p>Dynamically customize agent behavior, voice, and personality on a per-session basis.</p>

          <div class="info-box">
            <strong>üîí Security:</strong> Agent overrides are only available with signed link authentication where <code>allowOverride: true</code> is granted by your backend.
          </div>

          <h2>How It Works</h2>
          <div class="info-box">
            <strong>üîê Backend-to-Backend First:</strong> The signed URL with override permission is obtained via backend-to-backend communication before your frontend can use it.
          </div>
          <ol class="numbered-list">
            <li><strong>Backend-to-Backend:</strong> Your backend requests a signed URL from TTP backend with <code>allowOverride: true</code></li>
            <li><strong>Backend ‚Üí Frontend:</strong> Your backend returns the signed URL to your frontend</li>
            <li><strong>Frontend:</strong> Your frontend uses the SDK with the signed URL + custom agent settings</li>
            <li><strong>TTP Backend:</strong> Validates the JWT signature and applies your overrides if permission granted</li>
          </ol>

          <h2>Example</h2>
          <pre><code>const voiceSDK = new VoiceSDK({
  websocketUrl: signedUrl,  // Signed URL from your backend
  appId: 'your_app_id',     // Your application ID
  agentId: 'agent_123',     // The AI agent to connect to
  
  // Override agent settings
  agentSettingsOverride: {
    // Core settings
    prompt: "You are a friendly Spanish-speaking travel assistant",
    language: "es",
    temperature: 0.9,
    maxTokens: 200,
    
    // Voice settings
    voiceSpeed: 1.2,
    voiceId: "nova",  // Use voiceId (not selectedVoice)
    
    // Behavior
    firstMessage: "¬°Hola! ¬øC√≥mo puedo ayudarte hoy?",
    disableInterruptions: false,
    autoDetectLanguage: true,
    
    // Tools (optional)
    toolIds: [123, 456, 789],              // Custom tool IDs
    internalToolIds: ['calendar', 'email'] // Internal tool IDs
  }
});</code></pre>

          <h2>Available Override Settings</h2>
          <p><strong>15 out of 16 settings can be overridden.</strong> Only <code>model</code> selection is not supported (requires infrastructure changes).</p>
          <div class="settings-grid">
            <div class="settings-category">
              <h3>üìù Core Settings</h3>
              <ul>
                <li><code>prompt</code> - System prompt/instructions</li>
                <li><code>temperature</code> - LLM temperature (0-2)</li>
                <li><code>maxTokens</code> - Maximum response tokens</li>
                <li><code>model</code> - <strong>‚ö†Ô∏è NOT SUPPORTED</strong></li>
                <li><code>language</code> - Response language code</li>
              </ul>
            </div>
            <div class="settings-category">
              <h3>üîä Voice Settings</h3>
              <ul>
                <li><code>voiceId</code> - Specific voice ID</li>
                <li><code>voiceSpeed</code> - Speed multiplier (0.5-2)</li>
              </ul>
            </div>
            <div class="settings-category">
              <h3>‚öôÔ∏è Behavior</h3>
              <ul>
                <li><code>firstMessage</code> - Initial greeting</li>
                <li><code>disableInterruptions</code> - Allow/prevent barge-in</li>
                <li><code>autoDetectLanguage</code> - Auto language detection</li>
                <li><code>candidateLanguages</code> - List of languages for auto-detection</li>
                <li><code>maxCallDuration</code> - Max session duration (seconds)</li>
              </ul>
            </div>
            <div class="settings-category">
              <h3>üõ†Ô∏è Advanced</h3>
              <ul>
                <li><code>toolIds</code> - Array of custom tool IDs</li>
                <li><code>internalToolIds</code> - Array of internal tool IDs</li>
                <li><code>timezone</code> - User timezone</li>
              </ul>
            </div>
          </div>

          <div class="warning-box">
            <strong>‚ö†Ô∏è Validation:</strong> All overrides are validated and sanitized on the server. Invalid values will be rejected or clamped to safe ranges.
          </div>
        </section>

        <!-- Events -->
        <section id="events" class="doc-section">
          <h1>Events & Callbacks</h1>
          <p>The SDK emits events for all important state changes and interactions.</p>

          <h2>Event Categories</h2>

          <h3>Connection Events</h3>
          <pre><code>voiceSDK.on('connected', () => {
  console.log('‚úÖ Connected to agent');
});

voiceSDK.on('disconnected', (event) => {
  console.log('‚ùå Disconnected:', event.reason);
  console.log('Close code:', event.code);
});

voiceSDK.on('error', (error) => {
  console.error('Error:', error);
});</code></pre>

          <h3>Recording Events</h3>
          <pre><code>voiceSDK.on('recordingStarted', () => {
  console.log('üé§ Recording started');
});

voiceSDK.on('recordingStopped', () => {
  console.log('‚èπÔ∏è Recording stopped');
});</code></pre>

          <h3>Message Events</h3>
          <pre><code>voiceSDK.on('message', (msg) => {
  switch(msg.type) {
    case 'agent_response':
      console.log('Agent:', msg.agent_response);
      break;
    case 'transcription':
      console.log('You said:', msg.text);
      break;
    // ... other message types
  }
});</code></pre>

          <h3>Audio Events</h3>
          <pre><code>voiceSDK.on('playbackStarted', () => {
  console.log('üîä Audio playback started');
});

voiceSDK.on('playbackStopped', () => {
  console.log('üîá Audio playback stopped');
});

voiceSDK.on('audioData', (audioData) => {
  // Raw audio data (Uint8Array)
});</code></pre>

          <h3>Special Events</h3>
          <pre><code>// Barge-in (user interrupts agent)
voiceSDK.on('bargeIn', (message) => {
  console.log('User interrupted the agent');
});

// Format negotiation (v2 protocol only)
voiceSDK.on('formatNegotiated', (format) => {
  console.log('Format negotiated:', format);
  // format: { container, encoding, sampleRate, channels, bitDepth }
});

// Greeting audio
voiceSDK.on('greetingStarted', () => {
  console.log('Playing greeting message');
});

// Domain whitelist error
voiceSDK.on('domainError', (error) => {
  console.error('Domain not whitelisted:', error.reason);
});</code></pre>
        </section>

        <!-- Protocol v2 Features -->
        <section id="protocol-v2" class="doc-section">
          <h1>Protocol v2 - Format Negotiation</h1>
          <p>The SDK v2 introduces format negotiation, allowing you to specify exactly what audio format you want to receive from the server.</p>

          <div class="info-box">
            <strong>üéØ Key Benefits:</strong>
            <ul style="margin-top: 10px;">
              <li><strong>Format Control:</strong> Request specific audio formats (container, encoding, sample rate, bit depth)</li>
              <li><strong>Automatic Conversion:</strong> SDK automatically converts audio if backend sends different format</li>
              <li><strong>Quality Optimization:</strong> Choose optimal formats for your use case (e.g., 48kHz for high quality, 8kHz for bandwidth savings)</li>
              <li><strong>Backward Compatible:</strong> Works with v1 protocol (set protocolVersion: 1)</li>
            </ul>
          </div>

          <h2>Supported Formats</h2>
          
          <h3>Input Formats (What SDK Sends)</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Property</th>
                <th>Supported Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>encoding</code></td>
                <td>'pcm', 'pcmu' (Œº-law), 'pcma' (A-law)</td>
              </tr>
              <tr>
                <td><code>sampleRate</code></td>
                <td>8000, 16000, 24000, 48000 Hz</td>
              </tr>
              <tr>
                <td><code>bitDepth</code></td>
                <td>8, 16, 24 bits</td>
              </tr>
              <tr>
                <td><code>channels</code></td>
                <td>1 (mono only)</td>
              </tr>
            </tbody>
          </table>

          <h3>Output Formats (What SDK Receives)</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Property</th>
                <th>Supported Values</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>container</code></td>
                <td>'raw' (no header), 'wav' (with WAV header)</td>
              </tr>
              <tr>
                <td><code>encoding</code></td>
                <td>'pcm', 'pcmu' (Œº-law), 'pcma' (A-law)</td>
              </tr>
              <tr>
                <td><code>sampleRate</code></td>
                <td>8000, 16000, 22050, 24000, 44100, 48000 Hz</td>
              </tr>
              <tr>
                <td><code>bitDepth</code></td>
                <td>8, 16, 24 bits</td>
              </tr>
              <tr>
                <td><code>channels</code></td>
                <td>1 (mono only)</td>
              </tr>
            </tbody>
          </table>

          <h2>Format Negotiation Flow</h2>
          <div class="flow-diagram">
            <div class="flow-step">
              <div class="flow-box" style="background: linear-gradient(135deg, #e0f2fe 0%, #bfdbfe 100%);">
                <strong>1. SDK Initialization</strong>
                <p>Configure requested output format</p>
              </div>
              <div class="flow-arrow">‚Üì</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                <strong>2. Connect & Send Hello</strong>
                <p>SDK sends format request in hello message</p>
              </div>
              <div class="flow-arrow">‚Üì</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);">
                <strong>3. Server Response</strong>
                <p>Server sends hello_ack with negotiated format</p>
              </div>
              <div class="flow-arrow">‚Üì</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);">
                <strong>4. Format Negotiated Event</strong>
                <p>SDK emits 'formatNegotiated' event</p>
              </div>
              <div class="flow-arrow">‚Üì</div>
              <div class="flow-box" style="background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);">
                <strong>5. Automatic Conversion</strong>
                <p>If formats differ, SDK converts automatically</p>
              </div>
            </div>
          </div>

          <h2>Example: High-Quality Audio</h2>
          <pre><code>const voiceSDK = new VoiceSDK({
  websocketUrl: signedUrl,
  appId: 'your_app_id',
  agentId: 'agent_123',
  
  // Request high-quality audio
  outputContainer: 'raw',        // Raw PCM for lower latency
  outputEncoding: 'pcm',         // Uncompressed PCM
  outputSampleRate: 48000,       // 48kHz for high quality
  outputBitDepth: 16,            // 16-bit depth
  outputChannels: 1,             // Mono
  outputFrameDurationMs: 600,    // 600ms frames
  
  protocolVersion: 2             // Enable format negotiation
});

voiceSDK.on('formatNegotiated', (format) => {
  console.log('Negotiated format:', format);
  // If backend sends different format, SDK will convert automatically
});</code></pre>

          <h2>Example: Bandwidth-Optimized Audio</h2>
          <pre><code>const voiceSDK = new VoiceSDK({
  websocketUrl: signedUrl,
  appId: 'your_app_id',
  agentId: 'agent_123',
  
  // Request compressed, low-bandwidth audio
  outputContainer: 'raw',
  outputEncoding: 'pcmu',        // Œº-law compression (8kHz equivalent)
  outputSampleRate: 8000,        // 8kHz for bandwidth savings
  outputBitDepth: 16,
  outputChannels: 1,
  
  protocolVersion: 2
});</code></pre>

          <h2>Format Conversion</h2>
          <p>If the backend sends audio in a different format than requested, the SDK automatically converts it:</p>
          <ul>
            <li><strong>Container:</strong> WAV ‚Üî Raw PCM extraction/wrapping</li>
            <li><strong>Encoding:</strong> PCM ‚Üî PCMU/PCMA encoding/decoding</li>
            <li><strong>Sample Rate:</strong> Automatic resampling using Web Audio API</li>
            <li><strong>Bit Depth:</strong> 8-bit ‚Üî 16-bit ‚Üî 24-bit conversion</li>
            <li><strong>Channels:</strong> Mono/stereo conversion (if needed)</li>
          </ul>

          <div class="info-box">
            <strong>üí° Best Practices:</strong>
            <ul style="margin-top: 10px;">
              <li>Use <code>protocolVersion: 2</code> for new projects</li>
              <li>Request formats that match your use case (quality vs. bandwidth)</li>
              <li>48kHz is recommended for best quality (matches most browser defaults)</li>
              <li>Raw PCM is lower latency than WAV (no header overhead)</li>
              <li>Listen to <code>formatNegotiated</code> event to verify format</li>
            </ul>
          </div>
        </section>

        <!-- Voice & Chat Widget -->
        <section id="text-chat-widget" class="doc-section">
          <h1>Voice & Chat Widget</h1>
          <p>Pre-built, customizable widget with voice and text chat - perfect for adding AI conversation to any website.</p>

          <div class="feature-grid">
            <div class="feature-card">
              <div class="feature-icon">üí¨</div>
              <h3>Voice & Text Chat</h3>
              <p>Beautiful interface with voice recording, text chat, and message history</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">üé®</div>
              <h3>Fully Customizable</h3>
              <p>Colors, position, size, RTL support, and custom branding</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">üì±</div>
              <h3>Mobile Optimized</h3>
              <p>Responsive design that works perfectly on all devices</p>
            </div>
            <div class="feature-card">
              <div class="feature-icon">üåç</div>
              <h3>Multi-language</h3>
              <p>Built-in support for multiple languages with custom translations</p>
            </div>
          </div>

          <h2>Installation</h2>
          <pre><code>&lt;!-- Add the SDK script to your page --&gt;
&lt;script src="https://unpkg.com/ttp-agent-sdk/dist/agent-widget.js"&gt;&lt;/script&gt;

&lt;!-- Initialize the widget --&gt;
&lt;script&gt;
  const widget = new TTPAgentSDK.TTPChatWidget({
    agentId: 'agent_123',
    appId: 'your_app_id'
  });
&lt;/script&gt;</code></pre>

          <h2>Basic Configuration</h2>
          <pre><code>const widget = new TTPAgentSDK.TTPChatWidget({
  // Required
  agentId: 'agent_123',       // Your AI agent ID
  appId: 'your_app_id',       // Your application ID
  
  // Optional - Appearance
  primaryColor: '#7C3AED',    // Widget theme color
  position: 'bottom-right',   // 'bottom-right', 'bottom-left'
  language: 'en',             // 'en', 'es', 'fr', 'de', 'he', etc.
  direction: 'ltr',           // 'ltr' or 'rtl' for right-to-left languages
  
  // Optional - Variables
  variables: {
    userName: 'John Doe',
    page: 'homepage',
    customData: 'value'
  }
});</code></pre>

          <h2>Advanced Customization</h2>
          
          <h3>Icon Customization</h3>
          <pre><code>const widget = new TTPAgentSDK.TTPChatWidget({
  agentId: 'agent_123',
  appId: 'your_app_id',
  
  icon: {
    type: 'custom',                              // 'default', 'emoji', or 'custom'
    customImage: 'https://your-site.com/logo.png', // Custom image URL
    size: 60,                                    // Icon size in pixels
    backgroundColor: '#FFFFFF',                  // Background color
    borderRadius: '50%'                         // Border radius (50% for circle)
  }
});</code></pre>

          <h3>Chat Window Customization</h3>
          <pre><code>const widget = new TTPAgentSDK.TTPChatWidget({
  agentId: 'agent_123',
  appId: 'your_app_id',
  
  chatWindow: {
    width: 400,                    // Width in pixels
    height: 600,                   // Height in pixels
    title: 'Chat with us!',        // Custom title
    subtitle: 'We reply instantly', // Custom subtitle
    placeholder: 'Type here...',   // Input placeholder
    borderRadius: 12               // Window border radius
  }
});</code></pre>

          <h3>Branding</h3>
          <pre><code>const widget = new TTPAgentSDK.TTPChatWidget({
  agentId: 'agent_123',
  appId: 'your_app_id',
  
  branding: {
    companyName: 'Your Company',
    logo: 'https://your-site.com/logo.png',
    showPoweredBy: false           // Hide "Powered by TTP" footer
  }
});</code></pre>

          <h3>RTL (Right-to-Left) Support</h3>
          <pre><code>// For Hebrew, Arabic, etc.
const widget = new TTPAgentSDK.TTPChatWidget({
  agentId: 'agent_123',
  appId: 'your_app_id',
  direction: 'rtl',
  language: 'he',                  // Hebrew
  position: 'bottom-left'          // Better for RTL
});</code></pre>

          <h2>Widget Methods</h2>
          
          <div class="method-card">
            <h3><code>widget.open()</code></h3>
            <p>Programmatically open the chat window.</p>
            <pre><code>// Open chat from your own button
document.getElementById('myButton').onclick = () => {
  widget.open();
};</code></pre>
          </div>

          <div class="method-card">
            <h3><code>widget.close()</code></h3>
            <p>Close the chat window.</p>
            <pre><code>widget.close();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>widget.toggle()</code></h3>
            <p>Toggle chat window open/closed.</p>
            <pre><code>widget.toggle();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>widget.destroy()</code></h3>
            <p>Remove the widget from the page.</p>
            <pre><code>widget.destroy();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>widget.updateConfig(config)</code></h3>
            <p>Update widget configuration dynamically.</p>
            <pre><code>widget.updateConfig({
  primaryColor: '#FF5733',
  language: 'es'
});</code></pre>
          </div>

          <h2>Widget Events</h2>
          <pre><code>const widget = new TTPAgentSDK.TTPChatWidget({
  agentId: 'agent_123',
  appId: 'your_app_id',
  
  // Event callbacks
  onOpen: () => {
    console.log('Chat opened');
  },
  
  onClose: () => {
    console.log('Chat closed');
  },
  
  onMessage: (message) => {
    console.log('New message:', message);
  },
  
  onError: (error) => {
    console.error('Widget error:', error);
  },
  
  onReady: () => {
    console.log('Widget initialized');
  }
});</code></pre>

          <h2>Complete Example</h2>
          <pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;title&gt;My Website with AI Chat&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Welcome to my website!&lt;/h1&gt;
  
  &lt;!-- Load the SDK --&gt;
  &lt;script src="https://unpkg.com/ttp-agent-sdk/dist/agent-widget.js"&gt;&lt;/script&gt;
  
  &lt;!-- Initialize widget --&gt;
  &lt;script&gt;
    const widget = new TTPAgentSDK.TTPChatWidget({
      agentId: 'agent_123',
      appId: 'your_app_id',
      
      // Customize appearance
      primaryColor: '#7C3AED',
      position: 'bottom-right',
      language: 'en',
      
      // Custom branding
      chatWindow: {
        title: 'Chat with us!',
        subtitle: 'We typically reply instantly'
      },
      
      // Pass context variables
      variables: {
        userName: 'Visitor',
        page: window.location.pathname,
        referrer: document.referrer
      },
      
      // Event handlers
      onReady: () => {
        console.log('Chat widget ready!');
      },
      
      onMessage: (message) => {
        // Track messages in analytics
        console.log('Message:', message);
      }
    });
    
    // Optional: Open chat programmatically
    // widget.open();
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

          <h2>Configuration Reference</h2>
          <div class="info-box">
            <p><strong>üé® Extensive Customization</strong></p>
            <p>The Voice & Chat Widget can be customized in almost every aspect - colors, text, icons, sizes, behaviors, and more!</p>
          </div>

          <p>See the <a href="../examples/test-text-chat.html" target="_blank">live demo</a> to experiment with all customization options interactively.</p>

          <details open>
            <summary><strong>Required Configuration</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>agentId</code></td>
                  <td>string</td>
                  <td>Your AI agent identifier</td>
                </tr>
                <tr>
                  <td><code>appId</code></td>
                  <td>string</td>
                  <td>Your application identifier</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details open>
            <summary><strong>General Configuration</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>primaryColor</code></td>
                  <td>string</td>
                  <td>'#7C3AED'</td>
                  <td>Main theme color (hex)</td>
                </tr>
                <tr>
                  <td><code>direction</code></td>
                  <td>string</td>
                  <td>'ltr'</td>
                  <td>'ltr' or 'rtl'</td>
                </tr>
                <tr>
                  <td><code>language</code></td>
                  <td>string</td>
                  <td>'en'</td>
                  <td>Language code (en, es, fr, de, he, ar, etc.)</td>
                </tr>
                <tr>
                  <td><code>variables</code></td>
                  <td>object</td>
                  <td>{}</td>
                  <td>Custom variables to pass to agent</td>
                </tr>
                <tr>
                  <td><code>customStyles</code></td>
                  <td>string</td>
                  <td>''</td>
                  <td>Custom CSS to inject</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Positioning</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>position</code></td>
                  <td>string | object</td>
                  <td>'bottom-right'</td>
                  <td>String: 'bottom-right', 'bottom-left'. Object: { vertical, horizontal, offset }</td>
                </tr>
                <tr>
                  <td><code>position.vertical</code></td>
                  <td>string</td>
                  <td>'bottom'</td>
                  <td>'top' or 'bottom'</td>
                </tr>
                <tr>
                  <td><code>position.horizontal</code></td>
                  <td>string</td>
                  <td>'right'</td>
                  <td>'left' or 'right'</td>
                </tr>
                <tr>
                  <td><code>position.offset</code></td>
                  <td>object</td>
                  <td>{ x: 20, y: 20 }</td>
                  <td>Offset from edges (pixels)</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Icon & Button</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>icon.type</code></td>
                  <td>string</td>
                  <td>'custom'</td>
                  <td>'microphone', 'custom', 'emoji', 'text'</td>
                </tr>
                <tr>
                  <td><code>icon.customImage</code></td>
                  <td>string</td>
                  <td>TTP logo</td>
                  <td>URL to custom icon image</td>
                </tr>
                <tr>
                  <td><code>icon.size</code></td>
                  <td>string</td>
                  <td>'medium'</td>
                  <td>'small', 'medium', 'large', 'xl'</td>
                </tr>
                <tr>
                  <td><code>icon.backgroundColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Icon background color</td>
                </tr>
                <tr>
                  <td><code>button.size</code></td>
                  <td>string</td>
                  <td>'medium'</td>
                  <td>'small', 'medium', 'large'</td>
                </tr>
                <tr>
                  <td><code>button.shape</code></td>
                  <td>string</td>
                  <td>'circle'</td>
                  <td>'circle', 'rounded', 'square'</td>
                </tr>
                <tr>
                  <td><code>button.backgroundColor</code></td>
                  <td>string</td>
                  <td>primaryColor</td>
                  <td>Button background color</td>
                </tr>
                <tr>
                  <td><code>button.hoverColor</code></td>
                  <td>string</td>
                  <td>'#7C3AED'</td>
                  <td>Button hover color</td>
                </tr>
                <tr>
                  <td><code>button.shadow</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Enable button shadow</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Panel & Header</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>panel.width</code></td>
                  <td>number</td>
                  <td>350</td>
                  <td>Panel width (pixels)</td>
                </tr>
                <tr>
                  <td><code>panel.height</code></td>
                  <td>number</td>
                  <td>500</td>
                  <td>Panel height (pixels)</td>
                </tr>
                <tr>
                  <td><code>panel.borderRadius</code></td>
                  <td>number</td>
                  <td>12</td>
                  <td>Border radius (pixels)</td>
                </tr>
                <tr>
                  <td><code>panel.backgroundColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Panel background color</td>
                </tr>
                <tr>
                  <td><code>header.title</code></td>
                  <td>string</td>
                  <td>'Chat Assistant'</td>
                  <td>Header title text</td>
                </tr>
                <tr>
                  <td><code>header.showTitle</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Show/hide header title</td>
                </tr>
                <tr>
                  <td><code>header.backgroundColor</code></td>
                  <td>string</td>
                  <td>'#7C3AED'</td>
                  <td>Header background color</td>
                </tr>
                <tr>
                  <td><code>header.textColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Header text color</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Messages & Chat</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>messages.userBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#E5E7EB'</td>
                  <td>User message background</td>
                </tr>
                <tr>
                  <td><code>messages.agentBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#F3F4F6'</td>
                  <td>Agent message background</td>
                </tr>
                <tr>
                  <td><code>messages.systemBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#DCFCE7'</td>
                  <td>System message background</td>
                </tr>
                <tr>
                  <td><code>messages.errorBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#FEE2E2'</td>
                  <td>Error message background</td>
                </tr>
                <tr>
                  <td><code>messages.textColor</code></td>
                  <td>string</td>
                  <td>'#1F2937'</td>
                  <td>Message text color</td>
                </tr>
                <tr>
                  <td><code>messages.fontSize</code></td>
                  <td>string</td>
                  <td>'14px'</td>
                  <td>Message font size</td>
                </tr>
                <tr>
                  <td><code>messages.borderRadius</code></td>
                  <td>number</td>
                  <td>8</td>
                  <td>Message bubble radius</td>
                </tr>
                <tr>
                  <td><code>text.sendButtonColor</code></td>
                  <td>string</td>
                  <td>'#7C3AED'</td>
                  <td>Send button color</td>
                </tr>
                <tr>
                  <td><code>text.sendButtonHoverColor</code></td>
                  <td>string</td>
                  <td>'#6D28D9'</td>
                  <td>Send button hover color</td>
                </tr>
                <tr>
                  <td><code>text.sendButtonActiveColor</code></td>
                  <td>string</td>
                  <td>'#6D28D9'</td>
                  <td>Send button active color</td>
                </tr>
                <tr>
                  <td><code>text.sendButtonText</code></td>
                  <td>string</td>
                  <td>'‚û§'</td>
                  <td>Send button text/icon</td>
                </tr>
                <tr>
                  <td><code>text.sendButtonTextColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Send button text color</td>
                </tr>
                <tr>
                  <td><code>text.sendButtonFontSize</code></td>
                  <td>string</td>
                  <td>'18px'</td>
                  <td>Send button font size</td>
                </tr>
                <tr>
                  <td><code>text.sendButtonFontWeight</code></td>
                  <td>string</td>
                  <td>'500'</td>
                  <td>Send button font weight</td>
                </tr>
                <tr>
                  <td><code>text.inputPlaceholder</code></td>
                  <td>string</td>
                  <td>'Type your message...'</td>
                  <td>Input placeholder text</td>
                </tr>
                <tr>
                  <td><code>text.inputBorderColor</code></td>
                  <td>string</td>
                  <td>'#E5E7EB'</td>
                  <td>Input border color</td>
                </tr>
                <tr>
                  <td><code>text.inputFocusColor</code></td>
                  <td>string</td>
                  <td>'#7C3AED'</td>
                  <td>Input focus color</td>
                </tr>
                <tr>
                  <td><code>text.inputBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Input background color</td>
                </tr>
                <tr>
                  <td><code>text.inputTextColor</code></td>
                  <td>string</td>
                  <td>'#1F2937'</td>
                  <td>Input text color</td>
                </tr>
                <tr>
                  <td><code>text.inputFontSize</code></td>
                  <td>string</td>
                  <td>'14px'</td>
                  <td>Input font size</td>
                </tr>
                <tr>
                  <td><code>text.inputBorderRadius</code></td>
                  <td>number</td>
                  <td>20</td>
                  <td>Input border radius (pixels)</td>
                </tr>
                <tr>
                  <td><code>text.inputPadding</code></td>
                  <td>string</td>
                  <td>'6px 14px'</td>
                  <td>Input padding</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Voice Configuration</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>voice.micButtonColor</code></td>
                  <td>string</td>
                  <td>primaryColor</td>
                  <td>Microphone button color (inside panel)</td>
                </tr>
                <tr>
                  <td><code>voice.micButtonActiveColor</code></td>
                  <td>string</td>
                  <td>'#EF4444'</td>
                  <td>Microphone button color when active</td>
                </tr>
                <tr>
                  <td><code>voice.micButtonHint.text</code></td>
                  <td>string</td>
                  <td>'Click the button to start...'</td>
                  <td>Hint text below mic button</td>
                </tr>
                <tr>
                  <td><code>voice.micButtonHint.color</code></td>
                  <td>string</td>
                  <td>'#6B7280'</td>
                  <td>Hint text color</td>
                </tr>
                <tr>
                  <td><code>voice.avatarBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#667eea'</td>
                  <td>Voice avatar background</td>
                </tr>
                <tr>
                  <td><code>voice.avatarActiveBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#667eea'</td>
                  <td>Avatar background when active</td>
                </tr>
                <tr>
                  <td><code>voice.statusTitleColor</code></td>
                  <td>string</td>
                  <td>'#1e293b'</td>
                  <td>Status title text color</td>
                </tr>
                <tr>
                  <td><code>voice.statusSubtitleColor</code></td>
                  <td>string</td>
                  <td>'#64748b'</td>
                  <td>Status subtitle text color</td>
                </tr>
                <tr>
                  <td><code>voice.startCallButtonColor</code></td>
                  <td>string</td>
                  <td>'#667eea'</td>
                  <td>Start call button color</td>
                </tr>
                <tr>
                  <td><code>voice.startCallButtonTextColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Start call button text color</td>
                </tr>
                <tr>
                  <td><code>voice.endCallButtonColor</code></td>
                  <td>string</td>
                  <td>'#ef4444'</td>
                  <td>End call button color</td>
                </tr>
                <tr>
                  <td><code>voice.transcriptBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Transcript background</td>
                </tr>
                <tr>
                  <td><code>voice.transcriptTextColor</code></td>
                  <td>string</td>
                  <td>'#1e293b'</td>
                  <td>Transcript text color</td>
                </tr>
                <tr>
                  <td><code>voice.transcriptLabelColor</code></td>
                  <td>string</td>
                  <td>'#94a3b8'</td>
                  <td>Transcript label color</td>
                </tr>
                <tr>
                  <td><code>voice.controlButtonColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Control button color</td>
                </tr>
                <tr>
                  <td><code>voice.controlButtonSecondaryColor</code></td>
                  <td>string</td>
                  <td>'#64748b'</td>
                  <td>Secondary control button color</td>
                </tr>
                <tr>
                  <td><code>voice.language</code></td>
                  <td>string</td>
                  <td>'en'</td>
                  <td>Voice language (overrides global)</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Behavior</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>behavior.mode</code></td>
                  <td>string</td>
                  <td>'unified'</td>
                  <td>'unified' (both), 'voice-only', 'text-only'</td>
                </tr>
                <tr>
                  <td><code>behavior.autoOpen</code></td>
                  <td>boolean</td>
                  <td>false</td>
                  <td>Auto-open widget on page load</td>
                </tr>
                <tr>
                  <td><code>behavior.startOpen</code></td>
                  <td>boolean</td>
                  <td>false</td>
                  <td>Start with widget open</td>
                </tr>
                <tr>
                  <td><code>behavior.hidden</code></td>
                  <td>boolean</td>
                  <td>false</td>
                  <td>Hide the widget completely</td>
                </tr>
                <tr>
                  <td><code>behavior.autoConnect</code></td>
                  <td>boolean</td>
                  <td>false</td>
                  <td>Auto-connect on widget open</td>
                </tr>
                <tr>
                  <td><code>behavior.showWelcomeMessage</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Show welcome message</td>
                </tr>
                <tr>
                  <td><code>behavior.welcomeMessage</code></td>
                  <td>string</td>
                  <td>'Hello! How can I help...'</td>
                  <td>Welcome message text</td>
                </tr>
                <tr>
                  <td><code>behavior.enableVoiceMode</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Enable voice mode option (in unified mode)</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Animation & Tooltips</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>animation.enableHover</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Enable hover animations</td>
                </tr>
                <tr>
                  <td><code>animation.enablePulse</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Enable pulse animations</td>
                </tr>
                <tr>
                  <td><code>animation.enableSlide</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Enable slide animations</td>
                </tr>
                <tr>
                  <td><code>animation.duration</code></td>
                  <td>number</td>
                  <td>0.3</td>
                  <td>Animation duration (seconds)</td>
                </tr>
                <tr>
                  <td><code>tooltips.newChat</code></td>
                  <td>string</td>
                  <td>Auto</td>
                  <td>New chat button tooltip</td>
                </tr>
                <tr>
                  <td><code>tooltips.back</code></td>
                  <td>string</td>
                  <td>Auto</td>
                  <td>Back button tooltip</td>
                </tr>
                <tr>
                  <td><code>tooltips.close</code></td>
                  <td>string</td>
                  <td>Auto</td>
                  <td>Close button tooltip</td>
                </tr>
                <tr>
                  <td><code>tooltips.mute</code></td>
                  <td>string</td>
                  <td>Auto</td>
                  <td>Mute button tooltip</td>
                </tr>
                <tr>
                  <td><code>tooltips.speaker</code></td>
                  <td>string</td>
                  <td>Auto</td>
                  <td>Speaker button tooltip</td>
                </tr>
                <tr>
                  <td><code>tooltips.endCall</code></td>
                  <td>string</td>
                  <td>Auto</td>
                  <td>End call button tooltip</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Landing Screen (Unified Mode)</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>landing.backgroundColor</code></td>
                  <td>string</td>
                  <td>Gradient</td>
                  <td>Landing screen background (color or gradient)</td>
                </tr>
                <tr>
                  <td><code>landing.logo</code></td>
                  <td>string</td>
                  <td>'ü§ñ'</td>
                  <td>Landing screen logo (emoji or text)</td>
                </tr>
                <tr>
                  <td><code>landing.title</code></td>
                  <td>string</td>
                  <td>null</td>
                  <td>Landing screen title (null uses translation)</td>
                </tr>
                <tr>
                  <td><code>landing.titleColor</code></td>
                  <td>string</td>
                  <td>'#1e293b'</td>
                  <td>Landing title text color</td>
                </tr>
                <tr>
                  <td><code>landing.modeCardBackgroundColor</code></td>
                  <td>string</td>
                  <td>'#FFFFFF'</td>
                  <td>Mode selection card background</td>
                </tr>
                <tr>
                  <td><code>landing.modeCardBorderColor</code></td>
                  <td>string</td>
                  <td>'#E2E8F0'</td>
                  <td>Mode card border color</td>
                </tr>
                <tr>
                  <td><code>landing.modeCardHoverBorderColor</code></td>
                  <td>string</td>
                  <td>header.backgroundColor</td>
                  <td>Mode card border color on hover</td>
                </tr>
                <tr>
                  <td><code>landing.modeCardIconBackgroundColor</code></td>
                  <td>string</td>
                  <td>header.backgroundColor</td>
                  <td>Mode card icon background</td>
                </tr>
                <tr>
                  <td><code>landing.modeCardTitleColor</code></td>
                  <td>string</td>
                  <td>'#111827'</td>
                  <td>Mode card title text color</td>
                </tr>
                <tr>
                  <td><code>landing.voiceCardIcon</code></td>
                  <td>string</td>
                  <td>'üé§'</td>
                  <td>Voice mode card icon</td>
                </tr>
                <tr>
                  <td><code>landing.textCardIcon</code></td>
                  <td>string</td>
                  <td>'üí¨'</td>
                  <td>Text mode card icon</td>
                </tr>
              </tbody>
            </table>
          </details>

          <details>
            <summary><strong>Advanced Configuration</strong></summary>
            <table class="properties-table">
              <thead>
                <tr>
                  <th>Property</th>
                  <th>Type</th>
                  <th>Default</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><code>websocketUrl</code></td>
                  <td>string</td>
                  <td>Auto-detected</td>
                  <td>Custom WebSocket URL for text chat</td>
                </tr>
                <tr>
                  <td><code>voice.websocketUrl</code></td>
                  <td>string</td>
                  <td>Auto-detected</td>
                  <td>Custom WebSocket URL for voice chat</td>
                </tr>
                <tr>
                  <td><code>demo</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Enable demo mode</td>
                </tr>
                <tr>
                  <td><code>panel.backdropFilter</code></td>
                  <td>string</td>
                  <td>null</td>
                  <td>CSS backdrop filter (e.g., 'blur(10px)')</td>
                </tr>
                <tr>
                  <td><code>panel.border</code></td>
                  <td>string</td>
                  <td>'1px solid rgba(0,0,0,0.1)'</td>
                  <td>Panel border style</td>
                </tr>
                <tr>
                  <td><code>button.shadowColor</code></td>
                  <td>string</td>
                  <td>'rgba(0,0,0,0.15)'</td>
                  <td>Button shadow color</td>
                </tr>
                <tr>
                  <td><code>icon.emoji</code></td>
                  <td>string</td>
                  <td>'üé§'</td>
                  <td>Emoji when icon.type = 'emoji'</td>
                </tr>
                <tr>
                  <td><code>icon.text</code></td>
                  <td>string</td>
                  <td>'AI'</td>
                  <td>Text when icon.type = 'text'</td>
                </tr>
                <tr>
                  <td><code>accessibility.ariaLabel</code></td>
                  <td>string</td>
                  <td>'Chat Assistant'</td>
                  <td>ARIA label for the widget</td>
                </tr>
                <tr>
                  <td><code>accessibility.ariaDescription</code></td>
                  <td>string</td>
                  <td>'Click to open chat assistant'</td>
                  <td>ARIA description</td>
                </tr>
                <tr>
                  <td><code>accessibility.keyboardNavigation</code></td>
                  <td>boolean</td>
                  <td>true</td>
                  <td>Enable keyboard navigation</td>
                </tr>
              </tbody>
            </table>
          </details>

          <div class="info-box" style="margin: 20px 0;">
            <p><strong>‚úÖ Configuration Verified:</strong></p>
            <p>All configuration options listed above have been verified against the source code and are fully supported. The widget has 80+ customization options across 13 categories:</p>
            <ul style="margin: 10px 0 0 20px; columns: 2; column-gap: 20px;">
              <li>General (5 options)</li>
              <li>Positioning (4 options)</li>
              <li>Icon & Button (9 options)</li>
              <li>Panel & Header (8 options)</li>
              <li>Messages (7 options)</li>
              <li>Text Chat (13 options)</li>
              <li>Voice Interface (17 options)</li>
              <li>Landing Screen (11 options)</li>
              <li>Tooltips (6 options)</li>
              <li>Animations (4 options)</li>
              <li>Behavior (8 options)</li>
              <li>Accessibility (3 options)</li>
              <li>Advanced (11 options)</li>
            </ul>
            <p style="margin-top: 10px;">Experiment with all options interactively in the <a href="../examples/test-text-chat.html" target="_blank" style="color: inherit; text-decoration: underline;">live demo</a>.</p>
          </div>

          <p style="margin-top: 20px;"><strong>üìñ Tip:</strong> All configuration options support the spread operator (...), so you can pass additional custom properties that will be merged with defaults.</p>

          <div class="info-box">
            <strong>üéÆ Live Demo:</strong> Try the fully functional widget with customization options at <a href="../examples/test-text-chat.html" target="_blank">test-text-chat.html</a>
          </div>

          <h2>Use Cases</h2>
          <div class="features">
            <div class="feature">
              <h4>üíº Customer Support</h4>
              <p>Add 24/7 AI-powered support to your website</p>
            </div>
            <div class="feature">
              <h4>üõí E-commerce</h4>
              <p>Help customers find products and answer questions</p>
            </div>
            <div class="feature">
              <h4>üìö Documentation</h4>
              <p>Provide interactive help for your docs</p>
            </div>
            <div class="feature">
              <h4>üéì Education</h4>
              <p>Create AI tutors and learning assistants</p>
            </div>
          </div>
        </section>

        <!-- Vanilla JS Guide -->
        <section id="vanilla-js" class="doc-section">
          <h1>Vanilla JavaScript Guide</h1>
          <p>Use the SDK in any JavaScript application without frameworks.</p>

          <h2>Complete Example</h2>
          <pre><code>import { VoiceSDK } from 'ttp-agent-sdk';

class VoiceAssistant {
  constructor() {
    this.sdk = null;
    this.isConnected = false;
    this.isRecording = false;
  }

  async initialize(agentId, overrides = {}) {
    // Step 1: Get signed URL
    const signedUrl = await this.getSignedUrl(agentId);

    // Step 2: Create SDK
    this.sdk = new VoiceSDK({
      websocketUrl: signedUrl,
      appId: 'your_app_id',
      agentId: agentId,
      agentSettingsOverride: overrides
    });

    // Setup event listeners
    this.setupEventListeners();

    // Connect
    await this.sdk.connect();
  }

  setupEventListeners() {
    this.sdk.on('connected', () => {
      this.isConnected = true;
      this.updateUI('connected');
    });

    this.sdk.on('disconnected', () => {
      this.isConnected = false;
      this.isRecording = false;
      this.updateUI('disconnected');
    });

    this.sdk.on('recordingStarted', () => {
      this.isRecording = true;
      this.updateUI('recording');
    });

    this.sdk.on('recordingStopped', () => {
      this.isRecording = false;
      this.updateUI('connected');
    });

    this.sdk.on('message', (msg) => {
      if (msg.type === 'agent_response') {
        this.displayMessage('agent', msg.agent_response);
      }
    });

    this.sdk.on('error', (error) => {
      this.handleError(error);
    });
  }

  async getSignedUrl(agentId) {
    const response = await fetch('/api/get-voice-session', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        agentId: agentId
      })
    });
    
    const { signedUrl } = await response.json();
    return signedUrl;
  }

  async toggleRecording() {
    if (!this.isConnected) return;

    if (this.isRecording) {
      await this.sdk.stopRecording();
    } else {
      await this.sdk.startRecording();
    }
  }

  disconnect() {
    if (this.sdk) {
      this.sdk.disconnect();
      this.sdk = null;
    }
  }

  updateUI(state) {
    // Update your UI based on state
  }

  displayMessage(role, text) {
    // Display message in your UI
  }

  handleError(error) {
    // Handle errors
  }
}

// Usage
const assistant = new VoiceAssistant();

await assistant.initialize('agent_123', {
  language: 'es',
  temperature: 0.9
});</code></pre>
        </section>

        <!-- React Guide -->
        <section id="react" class="doc-section">
          <h1>React Integration</h1>
          <p>Use the SDK in React applications with hooks and components.</p>

          <h2>Using Hooks</h2>
          <pre><code>import React, { useState, useEffect, useRef } from 'react';
import { VoiceSDK } from 'ttp-agent-sdk';

function VoiceChat() {
  const [status, setStatus] = useState('disconnected');
  const [isRecording, setIsRecording] = useState(false);
  const [messages, setMessages] = useState([]);
  const sdkRef = useRef(null);

  // Initialize SDK
  useEffect(() => {
    async function initSDK() {
      // Get signed URL
      const response = await fetch('/api/get-voice-session', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          agentId: 'agent_123'
        })
      });
      
      const { signedUrl } = await response.json();

      // Create SDK
      const sdk = new VoiceSDK({
        websocketUrl: signedUrl,
        appId: 'your_app_id',
        agentId: 'agent_123',
        agentSettingsOverride: {
          language: 'es',
          temperature: 0.9
        }
      });

      // Event listeners
      sdk.on('connected', () => setStatus('connected'));
      sdk.on('disconnected', () => {
        setStatus('disconnected');
        setIsRecording(false);
      });
      sdk.on('recordingStarted', () => setIsRecording(true));
      sdk.on('recordingStopped', () => setIsRecording(false));
      sdk.on('message', (msg) => {
        if (msg.type === 'agent_response') {
          setMessages(prev => [
            ...prev,
            { role: 'agent', text: msg.agent_response }
          ]);
        }
      });

      await sdk.connect();
      sdkRef.current = sdk;
    }

    initSDK();

    // Cleanup
    return () => {
      if (sdkRef.current) {
        sdkRef.current.disconnect();
      }
    };
  }, []);

  const toggleRecording = async () => {
    if (sdkRef.current) {
      await sdkRef.current.toggleRecording();
    }
  };

  return (
    &lt;div&gt;
      &lt;div&gt;Status: {status}&lt;/div&gt;
      &lt;button onClick={toggleRecording} disabled={status !== 'connected'}&gt;
        {isRecording ? 'Stop' : 'Start'} Recording
      &lt;/button&gt;
      &lt;div&gt;
        {messages.map((msg, i) => (
          &lt;div key={i}&gt;{msg.role}: {msg.text}&lt;/div&gt;
        ))}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}

export default VoiceChat;</code></pre>
        </section>

        <!-- VoiceButton Component -->
        <section id="voice-button" class="doc-section">
          <h1>VoiceButton Component</h1>
          <p>Pre-built React component for quick integration.</p>

          <h2>Installation</h2>
          <pre><code>import { VoiceButton } from 'ttp-agent-sdk/react';</code></pre>

          <h2>Basic Usage</h2>
          <pre><code>import React, { useState, useEffect } from 'react';
import { VoiceButton } from 'ttp-agent-sdk/react';

function App() {
  const [signedUrl, setSignedUrl] = useState(null);

  useEffect(() => {
    async function fetchSignedUrl() {
      const response = await fetch('/api/get-voice-session', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          agentId: 'agent_123'
        })
      });
      
      const { signedUrl } = await response.json();
      setSignedUrl(signedUrl);
    }
    
    fetchSignedUrl();
  }, []);

  if (!signedUrl) return &lt;div&gt;Loading...&lt;/div&gt;;

  return (
    &lt;VoiceButton
      websocketUrl={signedUrl}
      appId="your_app_id"
      agentId="agent_123"
      agentSettingsOverride={{
        language: 'es',
        temperature: 0.9
      }}
      onConnected={() => console.log('Connected')}
      onMessage={(msg) => console.log('Message:', msg)}
      onError={(error) => console.error('Error:', error)}
    /&gt;
  );
}</code></pre>

          <h2>Props</h2>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Prop</th>
                <th>Type</th>
                <th>Required</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>websocketUrl</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>Signed WebSocket URL</td>
              </tr>
              <tr>
                <td><code>appId</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>Your application ID</td>
              </tr>
              <tr>
                <td><code>agentId</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>The AI agent identifier</td>
              </tr>
              <tr>
                <td><code>agentSettingsOverride</code></td>
                <td>object</td>
                <td>No</td>
                <td>Custom agent settings</td>
              </tr>
              <tr>
                <td><code>voice</code></td>
                <td>string</td>
                <td>No</td>
                <td>Voice preset (default: 'default')</td>
              </tr>
              <tr>
                <td><code>language</code></td>
                <td>string</td>
                <td>No</td>
                <td>Language code (default: 'en')</td>
              </tr>
              <tr>
                <td><code>autoReconnect</code></td>
                <td>boolean</td>
                <td>No</td>
                <td>Auto-reconnect on disconnect (default: true)</td>
              </tr>
              <tr>
                <td><code>className</code></td>
                <td>string</td>
                <td>No</td>
                <td>Custom CSS class for the button</td>
              </tr>
              <tr>
                <td><code>style</code></td>
                <td>object</td>
                <td>No</td>
                <td>Inline styles for the button</td>
              </tr>
              <tr>
                <td><code>children</code></td>
                <td>React.Node</td>
                <td>No</td>
                <td>Custom button content (replaces default icon)</td>
              </tr>
            </tbody>
          </table>

          <h3>Event Callbacks</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Callback</th>
                <th>Parameters</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>onConnected</code></td>
                <td>-</td>
                <td>Called when successfully connected</td>
              </tr>
              <tr>
                <td><code>onDisconnected</code></td>
                <td>-</td>
                <td>Called when disconnected</td>
              </tr>
              <tr>
                <td><code>onRecordingStarted</code></td>
                <td>-</td>
                <td>Called when recording starts</td>
              </tr>
              <tr>
                <td><code>onRecordingStopped</code></td>
                <td>-</td>
                <td>Called when recording stops</td>
              </tr>
              <tr>
                <td><code>onPlaybackStarted</code></td>
                <td>-</td>
                <td>Called when audio playback starts</td>
              </tr>
              <tr>
                <td><code>onPlaybackStopped</code></td>
                <td>-</td>
                <td>Called when audio playback stops</td>
              </tr>
              <tr>
                <td><code>onMessage</code></td>
                <td><code>message</code></td>
                <td>Called for all WebSocket messages</td>
              </tr>
              <tr>
                <td><code>onError</code></td>
                <td><code>error</code></td>
                <td>Called on errors</td>
              </tr>
              <tr>
                <td><code>onBargeIn</code></td>
                <td><code>message</code></td>
                <td>Called when user interrupts agent</td>
              </tr>
              <tr>
                <td><code>onStopPlaying</code></td>
                <td><code>message</code></td>
                <td>Called when server requests to stop audio</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- VoiceSDK API -->
        <section id="voicesdk" class="doc-section">
          <h1>VoiceSDK Class</h1>
          <p>Core class for voice interaction functionality.</p>

          <h2>Constructor</h2>
          <pre><code>new VoiceSDK(config)</code></pre>

          <h3>Configuration Object</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Property</th>
                <th>Type</th>
                <th>Required</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>websocketUrl</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>Signed WebSocket URL from your backend</td>
              </tr>
              <tr>
                <td><code>appId</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>Your application identifier</td>
              </tr>
              <tr>
                <td><code>agentId</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>The AI agent identifier to connect to</td>
              </tr>
              <tr>
                <td><code>agentSettingsOverride</code></td>
                <td>object</td>
                <td>No</td>
                <td>Custom agent configuration</td>
              </tr>
              <tr>
                <td><code>voice</code></td>
                <td>string</td>
                <td>No</td>
                <td>Voice preset name (default: 'default')</td>
              </tr>
              <tr>
                <td><code>language</code></td>
                <td>string</td>
                <td>No</td>
                <td>Language code (default: 'en')</td>
              </tr>
              <tr>
                <td><code>sampleRate</code></td>
                <td>number</td>
                <td>No</td>
                <td>Input audio sample rate: 8000, 16000, 24000, or 48000 Hz (default: 16000)</td>
              </tr>
              <tr>
                <td><code>channels</code></td>
                <td>number</td>
                <td>No</td>
                <td>Input audio channels (default: 1, mono only)</td>
              </tr>
              <tr>
                <td><code>bitDepth</code></td>
                <td>number</td>
                <td>No</td>
                <td>Input audio bit depth: 8, 16, or 24 bits (default: 16)</td>
              </tr>
              <tr>
                <td><code>outputContainer</code></td>
                <td>string</td>
                <td>No</td>
                <td>Output container format: 'raw' or 'wav' (default: 'raw')</td>
              </tr>
              <tr>
                <td><code>outputEncoding</code></td>
                <td>string</td>
                <td>No</td>
                <td>Output audio encoding: 'pcm', 'pcmu' (Œº-law), or 'pcma' (A-law) (default: 'pcm')</td>
              </tr>
              <tr>
                <td><code>outputSampleRate</code></td>
                <td>number</td>
                <td>No</td>
                <td>Output audio sample rate: 8000, 16000, 22050, 24000, 44100, or 48000 Hz (default: 16000)</td>
              </tr>
              <tr>
                <td><code>outputChannels</code></td>
                <td>number</td>
                <td>No</td>
                <td>Output audio channels (default: 1, mono only)</td>
              </tr>
              <tr>
                <td><code>outputBitDepth</code></td>
                <td>number</td>
                <td>No</td>
                <td>Output audio bit depth: 8, 16, or 24 bits (default: 16)</td>
              </tr>
              <tr>
                <td><code>outputFrameDurationMs</code></td>
                <td>number</td>
                <td>No</td>
                <td>Frame duration for raw PCM streaming in milliseconds (default: 600)</td>
              </tr>
              <tr>
                <td><code>protocolVersion</code></td>
                <td>number</td>
                <td>No</td>
                <td>Protocol version: 1 (legacy) or 2 (format negotiation) (default: 2)</td>
              </tr>
              <tr>
                <td><code>autoReconnect</code></td>
                <td>boolean</td>
                <td>No</td>
                <td>Auto-reconnect on disconnect (default: true)</td>
              </tr>
            </tbody>
          </table>

          <h3>Audio Format Configuration (v2 Protocol)</h3>
          <p>The SDK v2 supports format negotiation with the backend. You can specify both input and output audio formats:</p>
          
          <div class="info-box">
            <strong>üìã Format Support:</strong>
            <ul style="margin-top: 10px;">
              <li><strong>Input Encodings:</strong> PCM, PCMU (Œº-law), PCMA (A-law)</li>
              <li><strong>Input Sample Rates:</strong> 8000, 16000, 24000, 48000 Hz</li>
              <li><strong>Input Bit Depths:</strong> 8, 16, 24 bits</li>
              <li><strong>Output Containers:</strong> 'raw' (no header) or 'wav' (with header)</li>
              <li><strong>Output Encodings:</strong> PCM, PCMU (Œº-law), PCMA (A-law)</li>
              <li><strong>Output Sample Rates:</strong> 8000, 16000, 22050, 24000, 44100, 48000 Hz</li>
              <li><strong>Output Bit Depths:</strong> 8, 16, 24 bits</li>
            </ul>
          </div>

          <h4>Example: Custom Audio Format</h4>
          <pre><code>const voiceSDK = new VoiceSDK({
  websocketUrl: signedUrl,
  appId: 'your_app_id',
  agentId: 'agent_123',
  
  // Input format (what we send to server)
  sampleRate: 16000,
  channels: 1,
  bitDepth: 16,
  
  // Output format (what we want from server)
  outputContainer: 'raw',        // 'raw' or 'wav'
  outputEncoding: 'pcm',          // 'pcm', 'pcmu', 'pcma'
  outputSampleRate: 44100,       // Higher quality
  outputChannels: 1,
  outputBitDepth: 16,
  outputFrameDurationMs: 600,    // Frame duration for streaming
  
  // Protocol version
  protocolVersion: 2              // Use v2 protocol for format negotiation
});

// Listen for format negotiation
voiceSDK.on('formatNegotiated', (format) => {
  console.log('Format negotiated:', format);
  // format contains: { container, encoding, sampleRate, channels, bitDepth }
});</code></pre>
        </section>

        <!-- Methods -->
        <section id="methods" class="doc-section">
          <h1>Methods</h1>

          <div class="method-card">
            <h3><code>connect()</code></h3>
            <p>Connect to the voice agent.</p>
            <p><strong>Returns:</strong> <code>Promise&lt;boolean&gt;</code></p>
            <pre><code>await voiceSDK.connect();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>disconnect()</code></h3>
            <p>Disconnect from the voice agent.</p>
            <p><strong>Returns:</strong> <code>void</code></p>
            <pre><code>voiceSDK.disconnect();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>startRecording()</code></h3>
            <p>Start capturing and streaming audio.</p>
            <p><strong>Returns:</strong> <code>Promise&lt;boolean&gt;</code></p>
            <pre><code>await voiceSDK.startRecording();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>stopRecording()</code></h3>
            <p>Stop capturing audio.</p>
            <p><strong>Returns:</strong> <code>Promise&lt;boolean&gt;</code></p>
            <pre><code>await voiceSDK.stopRecording();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>toggleRecording()</code></h3>
            <p>Toggle recording state (start/stop).</p>
            <p><strong>Returns:</strong> <code>Promise&lt;boolean&gt;</code></p>
            <pre><code>await voiceSDK.toggleRecording();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>getStatus()</code></h3>
            <p>Get current connection and recording status.</p>
            <p><strong>Returns:</strong> <code>Object</code></p>
            <pre><code>const status = voiceSDK.getStatus();
// Returns: {
//   version: '2.0.0',
//   isConnected: boolean,
//   isRecording: boolean,
//   isPlaying: boolean,
//   outputFormat: object,      // Negotiated output format (v2)
//   audioPlayer: object,       // AudioPlayer status
//   audioRecorder: object      // AudioRecorder status
// }</code></pre>
          </div>

          <div class="method-card">
            <h3><code>validateInputFormat(format)</code></h3>
            <p><strong>v2 only:</strong> Validate input audio format configuration.</p>
            <p><strong>Parameters:</strong></p>
            <ul>
              <li><code>format</code> (object) - Format object with encoding, sampleRate, bitDepth, channels</li>
            </ul>
            <p><strong>Returns:</strong> <code>string|null</code> - Error message if invalid, null if valid</p>
            <pre><code>const error = voiceSDK.validateInputFormat({
  encoding: 'pcm',
  sampleRate: 16000,
  bitDepth: 16,
  channels: 1
});
if (error) {
  console.error('Invalid format:', error);
}</code></pre>
          </div>

          <div class="method-card">
            <h3><code>validateOutputFormat(format)</code></h3>
            <p><strong>v2 only:</strong> Validate output audio format configuration.</p>
            <p><strong>Parameters:</strong></p>
            <ul>
              <li><code>format</code> (object) - Format object with container, encoding, sampleRate, bitDepth, channels</li>
            </ul>
            <p><strong>Returns:</strong> <code>string|null</code> - Error message if invalid, null if valid</p>
            <pre><code>const error = voiceSDK.validateOutputFormat({
  container: 'raw',
  encoding: 'pcm',
  sampleRate: 44100,
  bitDepth: 16,
  channels: 1
});
if (error) {
  console.error('Invalid format:', error);
}</code></pre>
          </div>

          <div class="method-card">
            <h3><code>updateConfig(newConfig)</code></h3>
            <p>Update SDK configuration dynamically.</p>
            <p><strong>Parameters:</strong></p>
            <ul>
              <li><code>newConfig</code> (object) - Partial configuration object to merge with existing config</li>
            </ul>
            <p><strong>Returns:</strong> <code>void</code></p>
            <pre><code>voiceSDK.updateConfig({
  outputSampleRate: 48000,
  outputEncoding: 'pcmu'
});</code></pre>
          </div>

          <div class="method-card">
            <h3><code>reconnect()</code></h3>
            <p>Manually reconnect to the agent.</p>
            <p><strong>Returns:</strong> <code>Promise&lt;boolean&gt;</code></p>
            <pre><code>await voiceSDK.reconnect();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>stopAudioPlayback()</code></h3>
            <p>Immediately stop audio playback (for barge-in).</p>
            <p><strong>Returns:</strong> <code>void</code></p>
            <pre><code>voiceSDK.stopAudioPlayback();</code></pre>
          </div>

          <div class="method-card">
            <h3><code>on(event, callback)</code></h3>
            <p>Register an event listener.</p>
            <p><strong>Parameters:</strong></p>
            <ul>
              <li><code>event</code> (string) - Event name</li>
              <li><code>callback</code> (function) - Event handler</li>
            </ul>
            <pre><code>voiceSDK.on('connected', () => {
  console.log('Connected!');
});</code></pre>
          </div>

          <div class="method-card">
            <h3><code>destroy()</code></h3>
            <p>Cleanup all resources and disconnect.</p>
            <p><strong>Returns:</strong> <code>void</code></p>
            <pre><code>voiceSDK.destroy();</code></pre>
          </div>
        </section>

        <!-- Events API -->
        <section id="events-api" class="doc-section">
          <h1>Events Reference</h1>

          <table class="properties-table">
            <thead>
              <tr>
                <th>Event</th>
                <th>Parameters</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>connected</code></td>
                <td>-</td>
                <td>Emitted when successfully connected</td>
              </tr>
              <tr>
                <td><code>disconnected</code></td>
                <td><code>event</code></td>
                <td>Emitted when disconnected (includes reason)</td>
              </tr>
              <tr>
                <td><code>error</code></td>
                <td><code>error</code></td>
                <td>Emitted on errors</td>
              </tr>
              <tr>
                <td><code>recordingStarted</code></td>
                <td>-</td>
                <td>Emitted when recording starts</td>
              </tr>
              <tr>
                <td><code>recordingStopped</code></td>
                <td>-</td>
                <td>Emitted when recording stops</td>
              </tr>
              <tr>
                <td><code>message</code></td>
                <td><code>message</code></td>
                <td>Emitted for all WebSocket messages</td>
              </tr>
              <tr>
                <td><code>playbackStarted</code></td>
                <td>-</td>
                <td>Emitted when audio playback starts</td>
              </tr>
              <tr>
                <td><code>playbackStopped</code></td>
                <td>-</td>
                <td>Emitted when audio playback stops</td>
              </tr>
              <tr>
                <td><code>playbackError</code></td>
                <td><code>error</code></td>
                <td>Emitted on audio playback errors</td>
              </tr>
              <tr>
                <td><code>bargeIn</code></td>
                <td><code>message</code></td>
                <td>Emitted when user interrupts agent</td>
              </tr>
              <tr>
                <td><code>stopPlaying</code></td>
                <td><code>message</code></td>
                <td>Emitted when server requests to stop audio</td>
              </tr>
              <tr>
                <td><code>formatNegotiated</code></td>
                <td><code>format</code></td>
                <td><strong>v2 only:</strong> Emitted when audio format is negotiated with server. Format object contains: container, encoding, sampleRate, channels, bitDepth</td>
              </tr>
              <tr>
                <td><code>greetingStarted</code></td>
                <td>-</td>
                <td>Emitted when greeting audio starts</td>
              </tr>
              <tr>
                <td><code>domainError</code></td>
                <td><code>error</code></td>
                <td>Emitted when domain is not whitelisted</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- Configuration -->
        <section id="configuration" class="doc-section">
          <h1>Configuration Options</h1>

          <h2>Agent Settings Override</h2>
          <p>Complete reference for all overridable settings:</p>

          <h3>Core Settings</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Setting</th>
                <th>Type</th>
                <th>Range/Values</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>prompt</code></td>
                <td>string</td>
                <td>Any text</td>
                <td>System prompt/instructions for the agent</td>
              </tr>
              <tr>
                <td><code>temperature</code></td>
                <td>number</td>
                <td>0.0 - 2.0</td>
                <td>LLM creativity level</td>
              </tr>
              <tr>
                <td><code>maxTokens</code></td>
                <td>number</td>
                <td>1 - 4096</td>
                <td>Maximum tokens per response</td>
              </tr>
              <tr>
                <td><code>model</code></td>
                <td>string</td>
                <td>Model names</td>
                <td><strong>‚ö†Ô∏è NOT SUPPORTED</strong> - LLM model selection requires infrastructure changes</td>
              </tr>
              <tr>
                <td><code>language</code></td>
                <td>string</td>
                <td>ISO codes</td>
                <td>Response language (e.g., 'en', 'es', 'fr')</td>
              </tr>
            </tbody>
          </table>

          <h3>Voice Settings</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Setting</th>
                <th>Type</th>
                <th>Range/Values</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>voiceId</code></td>
                <td>string</td>
                <td>Voice IDs</td>
                <td>Specific voice identifier</td>
              </tr>
              <tr>
                <td><code>voiceSpeed</code></td>
                <td>number</td>
                <td>0.5 - 2.0</td>
                <td>Voice speed multiplier</td>
              </tr>
            </tbody>
          </table>

          <h3>Behavior Settings</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Setting</th>
                <th>Type</th>
                <th>Range/Values</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>firstMessage</code></td>
                <td>string</td>
                <td>Any text</td>
                <td>Initial greeting message</td>
              </tr>
              <tr>
                <td><code>disableInterruptions</code></td>
                <td>boolean</td>
                <td>true/false</td>
                <td>Prevent user from interrupting agent</td>
              </tr>
              <tr>
                <td><code>autoDetectLanguage</code></td>
                <td>boolean</td>
                <td>true/false</td>
                <td>Automatically detect user's language</td>
              </tr>
              <tr>
                <td><code>candidateLanguages</code></td>
                <td>array</td>
                <td>Language codes</td>
                <td>List of candidate languages for auto-detection (e.g., ['en', 'es', 'fr'])</td>
              </tr>
              <tr>
                <td><code>maxCallDuration</code></td>
                <td>number</td>
                <td>Seconds</td>
                <td>Maximum session duration</td>
              </tr>
            </tbody>
          </table>

          <h3>Advanced Settings</h3>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Setting</th>
                <th>Type</th>
                <th>Range/Values</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>toolIds</code></td>
                <td>array</td>
                <td>Array of numbers</td>
                <td>Array of custom tool IDs to enable for this agent (e.g., [123, 456, 789])</td>
              </tr>
              <tr>
                <td><code>internalToolIds</code></td>
                <td>array</td>
                <td>Array of strings</td>
                <td>Array of internal tool IDs to enable for this agent (e.g., ['calendar', 'weather', 'email'])</td>
              </tr>
              <tr>
                <td><code>timezone</code></td>
                <td>string</td>
                <td>TZ names</td>
                <td>User timezone (e.g., 'America/New_York')</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- Text-to-Speech API -->
        <section id="text-to-speech" class="doc-section">
          <h1>Text-to-Speech API</h1>
          <p class="badge-new">PUBLIC REST API</p>
          <p>Generate high-quality voice audio from text using our public REST API endpoint.</p>

          <div class="info-box">
            <strong>üîí Authentication:</strong> This endpoint requires API key authentication. Never expose your API key in frontend code - always call from your backend.
          </div>

          <h2>Endpoint</h2>
          <pre><code>POST https://backend.talktopc.com/api/public/agents/tts/generate</code></pre>

          <h2>Authentication</h2>
          <p>Include your API key in the Authorization header:</p>
          <pre><code>Authorization: Bearer YOUR_API_KEY</code></pre>

          <h2>Request Parameters</h2>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Type</th>
                <th>Required</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>text</code></td>
                <td>string</td>
                <td>Yes</td>
                <td>The text to convert to speech</td>
              </tr>
              <tr>
                <td><code>voiceId</code></td>
                <td>string</td>
                <td>No</td>
                <td>Voice identifier (default: agent's configured voice)</td>
              </tr>
              <tr>
                <td><code>voiceSpeed</code></td>
                <td>number</td>
                <td>No</td>
                <td>Voice speed multiplier: 0.5 - 2.0 (default: 1.0)</td>
              </tr>
              <tr>
                <td><code>language</code></td>
                <td>string</td>
                <td>No</td>
                <td>Language code (e.g., 'en', 'es', 'fr')</td>
              </tr>
              <tr>
                <td><code>agentId</code></td>
                <td>string</td>
                <td>No</td>
                <td>Agent ID to use voice settings from</td>
              </tr>
            </tbody>
          </table>

          <h2>Example Requests</h2>
          
          <style>
            .code-tabs {
              margin: 20px 0;
            }
            .code-tabs-header {
              display: flex;
              gap: 5px;
              border-bottom: 2px solid #e2e8f0;
              margin-bottom: 0;
            }
            .code-tab-button {
              padding: 10px 20px;
              background: #f8fafc;
              border: none;
              border-bottom: 3px solid transparent;
              cursor: pointer;
              font-weight: 500;
              color: #64748b;
              transition: all 0.2s;
            }
            .code-tab-button:hover {
              background: #e2e8f0;
              color: #334155;
            }
            .code-tab-button.active {
              background: white;
              color: #7c3aed;
              border-bottom-color: #7c3aed;
            }
            .code-tab-content {
              display: none;
            }
            .code-tab-content.active {
              display: block;
            }
          </style>
          
          <div class="code-tabs">
            <div class="code-tabs-header">
              <button class="code-tab-button active" onclick="showTab(event, 'tab-curl')">cURL</button>
              <button class="code-tab-button" onclick="showTab(event, 'tab-nodejs')">Node.js</button>
              <button class="code-tab-button" onclick="showTab(event, 'tab-python')">Python</button>
              <button class="code-tab-button" onclick="showTab(event, 'tab-php')">PHP</button>
              <button class="code-tab-button" onclick="showTab(event, 'tab-java')">Java</button>
            </div>
            
            <div id="tab-curl" class="code-tab-content active">
              <pre><code>curl -X POST https://backend.talktopc.com/api/public/agents/tts/generate \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "text": "Hello! Welcome to our service.",
    "voiceId": "nova",
    "voiceSpeed": 1.2,
    "language": "en"
  }' \
  --output speech.mp3</code></pre>
            </div>
            
            <div id="tab-nodejs" class="code-tab-content">
              <pre><code>const response = await fetch('https://backend.talktopc.com/api/public/agents/tts/generate', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${process.env.TTP_API_KEY}`
  },
  body: JSON.stringify({
    text: 'Hello! Welcome to our service.',
    voiceId: 'nova',
    voiceSpeed: 1.2,
    language: 'en'
  })
});

// Response is audio file
const audioBuffer = await response.arrayBuffer();
const audioBlob = new Blob([audioBuffer], { type: 'audio/mpeg' });

// Play or save the audio
const audioUrl = URL.createObjectURL(audioBlob);
const audio = new Audio(audioUrl);
audio.play();</code></pre>
            </div>
            
            <div id="tab-python" class="code-tab-content">
              <pre><code>import requests
import os

url = "https://backend.talktopc.com/api/public/agents/tts/generate"
headers = {
    "Content-Type": "application/json",
    "Authorization": f"Bearer {os.environ['TTP_API_KEY']}"
}
data = {
    "text": "Hello! Welcome to our service.",
    "voiceId": "nova",
    "voiceSpeed": 1.2,
    "language": "en"
}

response = requests.post(url, json=data, headers=headers)

if response.status_code == 200:
    # Save audio to file
    with open("speech.mp3", "wb") as f:
        f.write(response.content)
    print("Audio saved to speech.mp3")
else:
    print(f"Error: {response.status_code}")</code></pre>
            </div>
            
            <div id="tab-php" class="code-tab-content">
              <pre><code>&lt;?php
$url = "https://backend.talktopc.com/api/public/agents/tts/generate";
$apiKey = getenv('TTP_API_KEY');

$data = [
    'text' => 'Hello! Welcome to our service.',
    'voiceId' => 'nova',
    'voiceSpeed' => 1.2,
    'language' => 'en'
];

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($data));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Content-Type: application/json',
    'Authorization: Bearer ' . $apiKey
]);

$response = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);

if ($httpCode === 200) {
    file_put_contents('speech.mp3', $response);
    echo "Audio saved to speech.mp3";
} else {
    echo "Error: HTTP $httpCode";
}
?&gt;</code></pre>
            </div>
            
            <div id="tab-java" class="code-tab-content">
              <pre><code>import java.net.http.*;
import java.net.URI;
import java.nio.file.*;

public class TTSExample {
    public static void main(String[] args) throws Exception {
        String url = "https://backend.talktopc.com/api/public/agents/tts/generate";
        String apiKey = System.getenv("TTP_API_KEY");
        
        String json = """
            {
                "text": "Hello! Welcome to our service.",
                "voiceId": "nova",
                "voiceSpeed": 1.2,
                "language": "en"
            }
            """;
        
        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
            .uri(URI.create(url))
            .header("Content-Type", "application/json")
            .header("Authorization", "Bearer " + apiKey)
            .POST(HttpRequest.BodyPublishers.ofString(json))
            .build();
        
        HttpResponse&lt;byte[]&gt; response = client.send(
            request, 
            HttpResponse.BodyHandlers.ofByteArray()
        );
        
        if (response.statusCode() == 200) {
            Files.write(Paths.get("speech.mp3"), response.body());
            System.out.println("Audio saved to speech.mp3");
        } else {
            System.out.println("Error: " + response.statusCode());
        }
    }
}</code></pre>
            </div>
          </div>
          
          <script>
            function showTab(event, tabId) {
              // Hide all tab contents
              const contents = document.querySelectorAll('.code-tab-content');
              contents.forEach(content => content.classList.remove('active'));
              
              // Deactivate all tab buttons
              const buttons = document.querySelectorAll('.code-tab-button');
              buttons.forEach(button => button.classList.remove('active'));
              
              // Show selected tab and activate button
              document.getElementById(tabId).classList.add('active');
              event.currentTarget.classList.add('active');
            }
          </script>

          <h2>Response</h2>
          <p>The endpoint returns audio data directly with the following headers:</p>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Header</th>
                <th>Value</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>Content-Type</code></td>
                <td>audio/mpeg</td>
                <td>Audio format (MP3)</td>
              </tr>
              <tr>
                <td><code>Content-Length</code></td>
                <td>number</td>
                <td>Size of audio file in bytes</td>
              </tr>
            </tbody>
          </table>

          <h2>Voice Speed Examples</h2>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Speed</th>
                <th>Effect</th>
                <th>Use Case</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>0.5</code></td>
                <td>50% slower (half speed)</td>
                <td>Educational content, accessibility</td>
              </tr>
              <tr>
                <td><code>0.75</code></td>
                <td>25% slower</td>
                <td>Clear pronunciation, language learning</td>
              </tr>
              <tr>
                <td><code>1.0</code></td>
                <td>Normal speed (default)</td>
                <td>Standard conversation</td>
              </tr>
              <tr>
                <td><code>1.2</code></td>
                <td>20% faster</td>
                <td>Quick updates, notifications</td>
              </tr>
              <tr>
                <td><code>1.5</code></td>
                <td>50% faster</td>
                <td>Rapid information delivery</td>
              </tr>
              <tr>
                <td><code>2.0</code></td>
                <td>2x speed (double speed)</td>
                <td>Maximum speed, time-saving</td>
              </tr>
            </tbody>
          </table>

          <h2>Backend Implementation Example</h2>
          <pre><code>// Your backend endpoint
app.post('/api/generate-speech', async (req, res) => {
  const { text, voiceSpeed = 1.0 } = req.body;
  
  // Call TTP TTS API
  const ttpResponse = await fetch('https://backend.talktopc.com/api/public/agents/tts/generate', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${process.env.TTP_API_KEY}`  // üîí Secret!
    },
    body: JSON.stringify({
      text: text,
      voiceSpeed: voiceSpeed,
      voiceId: 'nova',
      language: 'en'
    })
  });
  
  if (!ttpResponse.ok) {
    return res.status(ttpResponse.status).json({ 
      error: 'TTS generation failed' 
    });
  }
  
  // Forward audio to client
  const audioBuffer = await ttpResponse.arrayBuffer();
  res.set('Content-Type', 'audio/mpeg');
  res.send(Buffer.from(audioBuffer));
});</code></pre>

          <h2>Error Responses</h2>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Status Code</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>400</code></td>
                <td>Bad Request - Invalid parameters</td>
              </tr>
              <tr>
                <td><code>401</code></td>
                <td>Unauthorized - Invalid or missing API key</td>
              </tr>
              <tr>
                <td><code>429</code></td>
                <td>Too Many Requests - Rate limit exceeded</td>
              </tr>
              <tr>
                <td><code>500</code></td>
                <td>Internal Server Error - TTS generation failed</td>
              </tr>
            </tbody>
          </table>

          <div class="warning-box">
            <strong>‚ö†Ô∏è Security Best Practices:</strong>
            <ul style="margin-top: 10px; margin-left: 20px;">
              <li>Never expose your API key in frontend JavaScript</li>
              <li>Always call this endpoint from your backend server</li>
              <li>Implement rate limiting on your backend</li>
              <li>Validate and sanitize text input to prevent abuse</li>
            </ul>
          </div>

          <h2>Use Cases</h2>
          <div class="features">
            <div class="feature">
              <h4>üì¢ Announcements</h4>
              <p>Generate audio announcements for notifications</p>
            </div>
            <div class="feature">
              <h4>üìö Content Creation</h4>
              <p>Convert articles or books to audio format</p>
            </div>
            <div class="feature">
              <h4>‚ôø Accessibility</h4>
              <p>Provide audio alternatives for text content</p>
            </div>
            <div class="feature">
              <h4>üéì E-Learning</h4>
              <p>Create voice-overs for educational materials</p>
            </div>
          </div>
        </section>

        <!-- Java SDK Section -->
        <section id="java-sdk" class="doc-section">
          <h1>Java SDK</h1>
          <p class="lead">Server-side Java SDK for text-to-speech conversion. Perfect for backend applications, phone systems, and server-to-server integrations.</p>

          <div class="info-box">
            <strong>üéØ Use Cases:</strong>
            <ul style="margin-top: 10px; margin-left: 20px;">
              <li><strong>Backend TTS:</strong> Generate speech on your server without exposing API keys</li>
              <li><strong>Phone Systems:</strong> Integrate with Twilio, Telnyx, or custom VoIP systems</li>
              <li><strong>Server-to-Server:</strong> Automated voice generation for notifications, alerts, or content</li>
              <li><strong>Audio Format Control:</strong> Request specific formats (PCMU, PCMA, PCM) for phone systems</li>
            </ul>
          </div>

          <h2 id="java-sdk-installation">Installation</h2>

          <h3>Maven</h3>
          <pre><code>&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;github&lt;/id&gt;
        &lt;url&gt;https://maven.pkg.github.com/TTP-GO/java-sdk&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.talktopc&lt;/groupId&gt;
        &lt;artifactId&gt;ttp-agent-sdk-java&lt;/artifactId&gt;
        &lt;version&gt;1.0.5&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>

          <div class="warning-box">
            <strong>‚ö†Ô∏è GitHub Packages Authentication:</strong>
            <p>You'll need to authenticate with GitHub Packages. Add credentials to your <code>~/.m2/settings.xml</code>:</p>
            <pre><code>&lt;settings&gt;
    &lt;servers&gt;
        &lt;server&gt;
            &lt;id&gt;github&lt;/id&gt;
            &lt;username&gt;YOUR_GITHUB_USERNAME&lt;/username&gt;
            &lt;password&gt;YOUR_GITHUB_TOKEN&lt;/password&gt;
        &lt;/server&gt;
    &lt;/servers&gt;
&lt;/settings&gt;</code></pre>
          </div>

          <h3>Gradle</h3>
          <pre><code>repositories {
    maven {
        url = uri("https://maven.pkg.github.com/TTP-GO/java-sdk")
        credentials {
            username = project.findProperty("gpr.user") ?: System.getenv("USERNAME")
            password = project.findProperty("gpr.key") ?: System.getenv("TOKEN")
        }
    }
}

dependencies {
    implementation 'com.talktopc:ttp-agent-sdk-java:1.0.5'
}</code></pre>

          <h2 id="java-sdk-quick-start">Quick Start</h2>

          <h3>1. Initialize SDK</h3>
          <pre><code>import com.talktopc.sdk.VoiceSDK;

// Get API key from environment variable
String apiKey = System.getenv("TALKTOPC_API_KEY");

VoiceSDK sdk = VoiceSDK.builder()
    .apiKey(apiKey)
    .baseUrl("https://api.talktopc.com")  // Optional
    .build();</code></pre>

          <h3>2. Simple TTS (Blocking)</h3>
          <pre><code>// Generate complete audio file
byte[] audio = sdk.textToSpeech("Hello world", "mamre");

// Save to file
Files.write(Paths.get("output.wav"), audio);

// Or send to phone system
phoneSystem.playAudio(audio);</code></pre>

          <h3>3. Streaming TTS (Real-time)</h3>
          <pre><code>// Stream audio chunks as they're generated
sdk.textToSpeechStream(
    "Hello world, this is a longer text that will be streamed",
    "mamre",
    audioChunk -> {
        // Receive chunks in real-time
        phoneSystem.playAudio(audioChunk);
    }
);</code></pre>

          <h2 id="java-sdk-api">API Reference</h2>

          <h3>VoiceSDK</h3>
          <p>Main SDK entry point for text-to-speech operations.</p>

          <h4>Builder Methods</h4>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Method</th>
                <th>Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>apiKey(String)</code></td>
                <td>String</td>
                <td>Your TalkToPC API key (required)</td>
              </tr>
              <tr>
                <td><code>baseUrl(String)</code></td>
                <td>String</td>
                <td>API base URL (default: https://api.talktopc.com)</td>
              </tr>
              <tr>
                <td><code>connectTimeout(int)</code></td>
                <td>int</td>
                <td>Connection timeout in milliseconds (default: 30000)</td>
              </tr>
              <tr>
                <td><code>readTimeout(int)</code></td>
                <td>int</td>
                <td>Read timeout in milliseconds (default: 60000)</td>
              </tr>
            </tbody>
          </table>

          <h4>Methods</h4>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Method</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>textToSpeech(String text, String voiceId)</code></td>
                <td>Simple TTS (blocking) - returns complete audio as byte array</td>
              </tr>
              <tr>
                <td><code>textToSpeech(String text, String voiceId, double speed)</code></td>
                <td>TTS with speed control (0.1 - 3.0)</td>
              </tr>
              <tr>
                <td><code>textToSpeech(TTSRequest request)</code></td>
                <td>TTS with full configuration (format, speed, etc.)</td>
              </tr>
              <tr>
                <td><code>synthesize(TTSRequest request)</code></td>
                <td>Get full response with metadata (sample rate, duration, credits)</td>
              </tr>
              <tr>
                <td><code>textToSpeechStream(String text, String voiceId, Consumer&lt;byte[]&gt; chunkHandler)</code></td>
                <td>Streaming TTS - chunks delivered to handler as they're generated</td>
              </tr>
              <tr>
                <td><code>textToSpeechStream(TTSRequest request, Consumer&lt;byte[]&gt; chunkHandler, Consumer&lt;StreamMetadata&gt; onComplete, Consumer&lt;Throwable&gt; onError)</code></td>
                <td>Streaming TTS with completion and error callbacks</td>
              </tr>
            </tbody>
          </table>

          <h3>TTSRequest Builder</h3>
          <p>Configure TTS requests with audio format options.</p>

          <h4>Basic Configuration</h4>
          <pre><code>TTSRequest request = TTSRequest.builder()
    .text("Hello world")              // Required
    .voiceId("mamre")                // Required
    .speed(1.0)                      // Optional (0.1 - 3.0)
    .build();</code></pre>

          <h4>Audio Format Configuration</h4>
          <pre><code>TTSRequest request = TTSRequest.builder()
    .text("Hello world")
    .voiceId("mamre")
    .outputContainer("raw")          // "raw" or "wav"
    .outputEncoding("pcm")           // "pcm", "pcmu", "pcma"
    .outputSampleRate(16000)         // Hz (8000, 16000, 22050, 44100)
    .outputBitDepth(16)              // bits (8, 16, 24)
    .outputChannels(1)               // 1 (mono) or 2 (stereo)
    .outputFrameDurationMs(600)     // ms per frame (for streaming)
    .build();</code></pre>

          <h4>Preset Methods</h4>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Method</th>
                <th>Format</th>
                <th>Use Case</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>phoneSystem()</code></td>
                <td>PCMU @ 8kHz, 20ms frames</td>
                <td>Phone systems (Twilio, Telnyx, VoIP)</td>
              </tr>
              <tr>
                <td><code>highQuality()</code></td>
                <td>WAV @ 44.1kHz</td>
                <td>High-quality audio files</td>
              </tr>
              <tr>
                <td><code>standardQuality()</code></td>
                <td>PCM @ 22.05kHz</td>
                <td>Standard quality audio</td>
              </tr>
            </tbody>
          </table>

          <h3>TTSResponse</h3>
          <p>Response object containing audio and metadata.</p>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Method</th>
                <th>Return Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>getAudio()</code></td>
                <td>byte[]</td>
                <td>Audio data</td>
              </tr>
              <tr>
                <td><code>getSampleRate()</code></td>
                <td>int</td>
                <td>Sample rate in Hz</td>
              </tr>
              <tr>
                <td><code>getDurationMs()</code></td>
                <td>long</td>
                <td>Playback duration in milliseconds</td>
              </tr>
              <tr>
                <td><code>getAudioSizeBytes()</code></td>
                <td>long</td>
                <td>Audio size in bytes</td>
              </tr>
              <tr>
                <td><code>getCreditsUsed()</code></td>
                <td>double</td>
                <td>Credits consumed</td>
              </tr>
              <tr>
                <td><code>getConversationId()</code></td>
                <td>String</td>
                <td>Unique conversation ID</td>
              </tr>
            </tbody>
          </table>

          <h2 id="java-sdk-examples">Examples</h2>

          <h3>Basic Usage</h3>
          <pre><code>VoiceSDK sdk = VoiceSDK.builder()
    .apiKey(System.getenv("TALKTOPC_API_KEY"))
    .build();

// Simple TTS
byte[] audio = sdk.textToSpeech("Welcome to TalkToPC", "mamre");
System.out.println("Generated " + audio.length + " bytes of audio");

// Save to file
Files.write(Paths.get("output.wav"), audio);</code></pre>

          <h3>With Speed Control</h3>
          <pre><code>// Faster speech (1.5x speed)
byte[] fastAudio = sdk.textToSpeech("Quick message", "mamre", 1.5);

// Slower speech (0.8x speed)
byte[] slowAudio = sdk.textToSpeech("Slow and clear", "mamre", 0.8);</code></pre>

          <h3>Streaming with Metadata</h3>
          <pre><code>sdk.textToSpeechStream(
    TTSRequest.builder()
        .text("Streaming example with full configuration")
        .voiceId("mamre")
        .speed(1.0)
        .build(),
    audioChunk -> {
        // Handle each audio chunk
        System.out.println("Received chunk: " + audioChunk.length + " bytes");
        phoneSystem.playAudio(audioChunk);
    },
    metadata -> {
        // Handle completion
        System.out.println("Stream completed:");
        System.out.println("  Total chunks: " + metadata.getTotalChunks());
        System.out.println("  Total bytes: " + metadata.getTotalBytes());
        System.out.println("  Duration: " + metadata.getDurationMs() + " ms");
        System.out.println("  Credits: " + metadata.getCreditsUsed());
    },
    error -> {
        // Handle errors
        System.err.println("Stream error: " + error.getMessage());
    }
);</code></pre>

          <h3>Phone System Integration</h3>
          <p>Perfect for Twilio, Telnyx, or custom VoIP systems.</p>

          <h4>Standard Phone System (PCMU @ 8kHz)</h4>
          <pre><code>// Using convenient phoneSystem() preset
TTSRequest request = TTSRequest.builder()
    .text("Hello, thank you for calling. How can I help you today?")
    .voiceId("en-US-female")
    .phoneSystem()  // ‚úÖ PCMU @ 8kHz, 20ms frames
    .build();

sdk.textToSpeechStream(
    request,
    audioChunk -> {
        // audioChunk is PCMU @ 8kHz, 20ms frames (160 bytes)
        // Ready to send directly to phone connection
        phoneConnection.sendAudio(audioChunk);
    }
);</code></pre>

          <h4>Twilio Integration</h4>
          <pre><code>TTSRequest request = TTSRequest.builder()
    .text("Your appointment is confirmed for tomorrow at 3 PM")
    .voiceId("en-US-male")
    .outputContainer("raw")
    .outputEncoding("pcmu")      // Œº-law for Twilio
    .outputSampleRate(8000)       // 8kHz
    .outputBitDepth(16)
    .outputChannels(1)            // Mono
    .outputFrameDurationMs(20)    // 20ms frames
    .build();

sdk.textToSpeechStream(
    request,
    audioChunk -> {
        // Send to Twilio Media Stream
        twilioStream.sendMedia(audioChunk);
    }
);</code></pre>

          <h3>Custom Audio Format</h3>
          <pre><code>TTSRequest request = TTSRequest.builder()
    .text("Custom format example")
    .voiceId("mamre")
    .outputContainer("raw")
    .outputEncoding("pcm")
    .outputSampleRate(16000)      // 16kHz
    .outputBitDepth(16)           // 16-bit
    .outputChannels(1)            // Mono
    .outputFrameDurationMs(100)   // 100ms frames
    .build();

byte[] audio = sdk.textToSpeech(request);
// Expected: 16kHz PCM, 16-bit, mono</code></pre>

          <h3>High Quality Audio</h3>
          <pre><code>TTSRequest request = TTSRequest.builder()
    .text("This is a high quality recording")
    .voiceId("mamre")
    .highQuality()  // WAV @ 44.1kHz
    .build();

byte[] audio = sdk.textToSpeech(request);
Files.write(Paths.get("high_quality.wav"), audio);</code></pre>

          <h3>Error Handling</h3>
          <pre><code>import com.talktopc.sdk.exception.TtsException;

try {
    byte[] audio = sdk.textToSpeech("Test", "mamre");
} catch (TtsException e) {
    System.err.println("TTS Error [" + e.getStatusCode() + "]: " + e.getErrorMessage());
    
    switch (e.getStatusCode()) {
        case 401:
            System.err.println("‚Üí Invalid API key");
            break;
        case 402:
            System.err.println("‚Üí Insufficient credits");
            break;
        case 400:
            System.err.println("‚Üí Invalid parameters");
            break;
        default:
            System.err.println("‚Üí Other error");
    }
}</code></pre>

          <h3>Full Configuration Example</h3>
          <pre><code>import com.talktopc.sdk.models.TTSRequest;
import com.talktopc.sdk.models.TTSResponse;

// Build request with all options
TTSRequest request = TTSRequest.builder()
    .text("Full configuration example")
    .voiceId("mamre")
    .speed(1.2)
    .outputContainer("wav")
    .outputEncoding("pcm")
    .outputSampleRate(44100)
    .outputBitDepth(16)
    .outputChannels(1)
    .build();

// Get response with metadata
TTSResponse response = sdk.synthesize(request);

System.out.println("Audio: " + response.getAudioSizeBytes() + " bytes");
System.out.println("Sample rate: " + response.getSampleRate() + " Hz");
System.out.println("Duration: " + response.getDurationMs() + " ms");
System.out.println("Credits: " + response.getCreditsUsed());

// Save audio
Files.write(Paths.get("output.wav"), response.getAudio());</code></pre>

          <h2>Supported Audio Formats</h2>
          <table class="properties-table">
            <thead>
              <tr>
                <th>Format</th>
                <th>Encoding</th>
                <th>Sample Rates</th>
                <th>Use Case</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>PCM</td>
                <td><code>pcm</code></td>
                <td>8000, 16000, 22050, 24000, 44100 Hz</td>
                <td>General purpose, high quality</td>
              </tr>
              <tr>
                <td>PCMU (Œº-law)</td>
                <td><code>pcmu</code></td>
                <td>8000 Hz</td>
                <td>Phone systems (Twilio, Telnyx, VoIP)</td>
              </tr>
              <tr>
                <td>PCMA (A-law)</td>
                <td><code>pcma</code></td>
                <td>8000 Hz</td>
                <td>Phone systems (European standards)</td>
              </tr>
            </tbody>
          </table>

          <h2>Requirements</h2>
          <ul>
            <li><strong>Java 11 or higher</strong></li>
            <li><strong>Valid TalkToPC API key</strong></li>
            <li><strong>No external dependencies</strong> - Uses Java 11+ HttpClient</li>
          </ul>

          <div class="info-box">
            <strong>üí° Key Differences from Frontend SDK:</strong>
            <ul style="margin-top: 10px; margin-left: 20px;">
              <li><strong>Backend-only:</strong> Designed for server-side use, not browser</li>
              <li><strong>Format Pass-through:</strong> Can request PCMU/PCMA and forward directly to phone systems</li>
              <li><strong>No Audio Playback:</strong> Returns raw audio bytes - you handle playback/forwarding</li>
              <li><strong>REST API:</strong> Uses REST endpoints instead of WebSocket</li>
            </ul>
          </div>

          <h2>Resources</h2>
          <ul>
            <li><strong>GitHub Repository:</strong> <a href="https://github.com/TTP-GO/java-sdk" target="_blank">TTP-GO/java-sdk</a></li>
            <li><strong>Maven Package:</strong> <code>com.talktopc:ttp-agent-sdk-java:1.0.5</code></li>
            <li><strong>Documentation:</strong> See <code>README.md</code> in the repository</li>
            <li><strong>Examples:</strong> Check <code>src/main/java/com/talktopc/sdk/examples/</code></li>
          </ul>
        </section>
      </div>

      <!-- Footer -->
      <footer class="doc-footer">
        <p>¬© 2024 TTP Agent SDK. Built with ‚ù§Ô∏è for developers.</p>
        <p>
          <a href="https://github.com/your-org/ttp-agent-sdk" target="_blank">GitHub</a> ¬∑ 
          <a href="../examples/test-text-chat.html" target="_blank">Live Demo</a> ¬∑ 
          <a href="mailto:support@talktopc.com">Support</a>
        </p>
      </footer>
    </main>
  </div>

  <script src="script.js"></script>
</body>
</html>


