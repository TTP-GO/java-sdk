/*! For license information please see agent-widget.js.LICENSE.txt */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.TTPAgentSDK=n():t.TTPAgentSDK=n()}(window,()=>(()=>{"use strict";var t={540:(t,n,e)=>{t.exports=e(869)},698:(t,n)=>{var e=Symbol.for("react.transitional.element");function o(t,n,o){var i=null;if(void 0!==o&&(i=""+o),void 0!==n.key&&(i=""+n.key),"key"in n)for(var r in o={},n)"key"!==r&&(o[r]=n[r]);else o=n;return n=o.ref,{$$typeof:e,type:t,key:i,ref:void 0!==n?n:null,props:o}}Symbol.for("react.fragment"),n.jsx=o,n.jsxs=o},848:(t,n,e)=>{t.exports=e(698)},869:(t,n)=>{Symbol.for("react.transitional.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.consumer"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.activity"),Symbol.iterator;var e={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o=Object.assign,i={};function r(t,n,o){this.props=t,this.context=n,this.refs=i,this.updater=o||e}function a(){}function c(t,n,o){this.props=t,this.context=n,this.refs=i,this.updater=o||e}r.prototype.isReactComponent={},r.prototype.setState=function(t,n){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")},r.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},a.prototype=r.prototype;var s=c.prototype=new a;s.constructor=c,o(s,r.prototype),s.isPureReactComponent=!0;Array.isArray;var l={H:null,A:null,T:null,S:null};Object.prototype.hasOwnProperty;"function"==typeof reportError&&reportError;n.useEffect=function(t,n){return l.H.useEffect(t,n)},n.useRef=function(t){return l.H.useRef(t)},n.useState=function(t){return l.H.useState(t)}}},n={};function e(o){var i=n[o];if(void 0!==i)return i.exports;var r=n[o]={exports:{}};return t[o](r,r.exports,e),r.exports}e.d=(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function r(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,a(o.key),o)}}function a(t){var n=function(t){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(n)?n:n+""}e.r(o),e.d(o,{AgentSDK:()=>nn,AudioPlayer:()=>X,AudioRecorder:()=>K,EventEmitter:()=>c,TTPChatWidget:()=>En,TextChatSDK:()=>Ot,VERSION:()=>Tn,VanillaVoiceButton:()=>Qt,VoiceButton:()=>Mt,VoiceSDK:()=>ft,WebSocketManager:()=>T,default:()=>Fn});var c=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.events={}},n=[{key:"on",value:function(t,n){this.events[t]||(this.events[t]=[]),this.events[t].push(n)}},{key:"off",value:function(t,n){this.events[t]&&(this.events[t]=this.events[t].filter(function(t){return t!==n}))}},{key:"emit",value:function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),o=1;o<n;o++)e[o-1]=arguments[o];this.events[t]&&this.events[t].forEach(function(n){try{n.apply(void 0,e)}catch(n){console.error("Error in event listener for ".concat(t,":"),n)}})}},{key:"removeAllListeners",value:function(t){t?delete this.events[t]:this.events={}}}],n&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var o,i,r,a,c=[],s=!0,l=!1;try{if(r=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;s=!1}else for(;!(s=(o=r.call(e)).done)&&(c.push(o.value),c.length!==n);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,n)||d(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=d(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,r=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw r}}}}function d(t,n){if(t){if("string"==typeof t)return f(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?f(t,n):void 0}}function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=Array(n);e<n;e++)o[e]=t[e];return o}function p(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return v(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(v(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,v(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,v(d,"constructor",l),v(l,"constructor",s),s.displayName="GeneratorFunction",v(l,i,"GeneratorFunction"),v(d),v(d,i,"Generator"),v(d,o,function(){return this}),v(d,"toString",function(){return"[object Generator]"}),(p=function(){return{w:r,m:f}})()}function v(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}v=function(t,n,e,o){function r(n,e){v(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},v(t,n,e,o)}function h(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function g(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,y(o.key),o)}}function y(t){var n=function(t){if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=s(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(n)?n:n+""}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(m=function(){return!!t})()}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function x(t,n){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},x(t,n)}const w=new(function(t){function n(){var t;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(t,n,e){return n=b(n),function(t,n){if(n&&("object"==s(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,m()?Reflect.construct(n,e||[],b(t).constructor):n.apply(t,e))}(this,n)).connections=new Map,t.connectionCounts=new Map,t.creatingConnections=new Set,t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&x(t,n)}(n,t),e=n,o=[{key:"getConnection",value:(i=p().m(function t(n){var e,o,i=this;return p().w(function(t){for(;;)switch(t.n){case 0:if(!this.connections.has(n)){t.n=1;break}return e=this.connections.get(n),this.connectionCounts.set(n,(this.connectionCounts.get(n)||0)+1),t.a(2,e);case 1:if(!this.creatingConnections||!this.creatingConnections.has(n)){t.n=2;break}return t.a(2,new Promise(function(t){var e=function(){if(i.connections.has(n)){var o=i.connections.get(n);i.connectionCounts.set(n,(i.connectionCounts.get(n)||0)+1),t(o)}else setTimeout(e,50)};e()}));case 2:return this.creatingConnections.add(n),o=new WebSocket(n),this.connections.set(n,o),this.connectionCounts.set(n,1),o.addEventListener("open",function(t){i.creatingConnections.delete(n),i.emit("open",t,n)}),o.addEventListener("close",function(t){i.creatingConnections.delete(n),i.connections.delete(n),i.connectionCounts.delete(n),i.emit("close",t,n)}),o.addEventListener("error",function(t){i.creatingConnections.delete(n),i.emit("error",t,n)}),o.addEventListener("message",function(t){i.emit("message",t,n)}),t.a(2,o)}},t,this)}),r=function(){var t=this,n=arguments;return new Promise(function(e,o){var r=i.apply(t,n);function a(t){h(r,e,o,a,c,"next",t)}function c(t){h(r,e,o,a,c,"throw",t)}a(void 0)})},function(t){return r.apply(this,arguments)})},{key:"releaseConnection",value:function(t){if(this.connections.has(t)){var n=this.connectionCounts.get(t)||0,e=Math.max(0,n-1);if(this.connectionCounts.set(t,e),0===e){var o=this.connections.get(t);o&&o.readyState===WebSocket.OPEN&&o.close(1e3,"No more subscribers"),this.connections.delete(t),this.connectionCounts.delete(t)}}}},{key:"forceClose",value:function(t){if(this.connections.has(t)){var n=this.connections.get(t);n&&n.readyState===WebSocket.OPEN&&n.close(1e3,"Force close"),this.connections.delete(t),this.connectionCounts.delete(t)}}},{key:"getConnectionStatus",value:function(t){return this.connections.has(t)?{exists:!0,readyState:this.connections.get(t).readyState,subscribers:this.connectionCounts.get(t)||0}:{exists:!1,readyState:null,subscribers:0}}},{key:"getAllConnections",value:function(){var t,n={},e=u(this.connections.entries());try{for(e.s();!(t=e.n()).done;){var o=l(t.value,2),i=o[0],r=o[1];n[i]={readyState:r.readyState,subscribers:this.connectionCounts.get(i)||0}}}catch(t){e.e(t)}finally{e.f()}return n}},{key:"clearAll",value:function(){var t,n=u(this.connections.entries());try{for(n.s();!(t=n.n()).done;){var e=l(t.value,2),o=(e[0],e[1]);o&&o.readyState===WebSocket.OPEN&&o.close(1e3,"Clear all")}}catch(t){n.e(t)}finally{n.f()}this.connections.clear(),this.connectionCounts.clear(),this.creatingConnections.clear()}}],o&&g(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,i,r}(c));function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function k(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return C(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(C(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,C(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,C(d,"constructor",l),C(l,"constructor",s),s.displayName="GeneratorFunction",C(l,i,"GeneratorFunction"),C(d),C(d,i,"Generator"),C(d,o,function(){return this}),C(d,"toString",function(){return"[object Generator]"}),(k=function(){return{w:r,m:f}})()}function C(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}C=function(t,n,e,o){function r(n,e){C(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},C(t,n,e,o)}function O(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function I(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,j(o.key),o)}}function j(t){var n=function(t){if("object"!=S(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=S(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(n)?n:n+""}function P(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(P=function(){return!!t})()}function B(t){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B(t)}function E(t,n){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},E(t,n)}var T=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=function(t,n,e){return n=B(n),function(t,n){if(n&&("object"==S(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,P()?Reflect.construct(n,e||[],B(t).constructor):n.apply(t,e))}(this,n)).config=t,e.ws=null,e.isConnected=!1,e.connectionId=null,e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&E(t,n)}(n,t),e=n,o=[{key:"connect",value:(r=k().m(function t(){var n=this;return k().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t,e){try{n.connectionId=Date.now()+"_"+Math.random().toString(36).substr(2,9),n.connectResolve=t,n.connectReject=e,w.getConnection(n.config.websocketUrl,n.config).then(function(e){n.ws=e,n.setupEventListeners(),e.readyState===WebSocket.OPEN&&(n.isConnected=!0,n.emit("connected"),t(),n.connectResolve=null,n.connectReject=null)}).catch(function(t){console.error("ðŸ”Œ WebSocketManager: Connection failed ".concat(n.connectionId),t),e(t),n.connectResolve=null,n.connectReject=null})}catch(t){console.error("ðŸ”Œ WebSocketManager: Connection error ".concat(n.connectionId),t),e(t),n.connectResolve=null,n.connectReject=null}}))},t)}),a=function(){var t=this,n=arguments;return new Promise(function(e,o){var i=r.apply(t,n);function a(t){O(i,e,o,a,c,"next",t)}function c(t){O(i,e,o,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var t=this;if(this.ws){var n=function(n,e){e===t.config.websocketUrl&&(t.isConnected=!0,t.emit("connected"),t.connectResolve&&(t.connectResolve(),t.connectResolve=null,t.connectReject=null))},e=function(n,e){e===t.config.websocketUrl&&(t.isConnected=!1,t.emit("disconnected",n))},o=function(n,e){e===t.config.websocketUrl&&(t.emit("error",n),t.connectReject&&(t.connectReject(n),t.connectResolve=null,t.connectReject=null))},i=function(n,e){e===t.config.websocketUrl&&t.handleMessage(n)};w.on("open",n),w.on("close",e),w.on("error",o),w.on("message",i),this.eventHandlers={open:n,close:e,error:o,message:i}}}},{key:"disconnect",value:function(){this.eventHandlers&&(w.off("open",this.eventHandlers.open),w.off("close",this.eventHandlers.close),w.off("error",this.eventHandlers.error),w.off("message",this.eventHandlers.message)),this.config.websocketUrl&&w.releaseConnection(this.config.websocketUrl),this.ws=null,this.isConnected=!1}},{key:"sendMessage",value:function(t){if(this.isConnected&&this.ws)try{this.ws.send(JSON.stringify(t))}catch(t){console.warn("ðŸ”Œ WebSocketManager: Failed to send message:",t.message)}}},{key:"sendBinary",value:function(t){if(this.isConnected&&this.ws)try{this.ws.send(t)}catch(t){console.warn("ðŸ”Œ WebSocketManager: Failed to send binary data:",t.message)}}},{key:"handleMessage",value:function(t){var n=this;if(t.data instanceof ArrayBuffer)this.emit("binaryAudio",t.data);else if(t.data instanceof Blob)t.data.arrayBuffer().then(function(t){n.emit("binaryAudio",t)}).catch(function(t){console.error("ðŸ”Œ WebSocketManager: Error converting Blob to ArrayBuffer:",t)});else try{var e=JSON.parse(t.data);"barge_in_ack"!==e.t&&"stop_sending"!==e.t||this.emit("bargeIn",e),"stop_playing"===e.t&&this.emit("stopPlaying",e),this.emit("message",e)}catch(t){this.emit("error",t)}}},{key:"getStatus",value:function(){return{isConnected:this.isConnected,readyState:this.ws?this.ws.readyState:null,connectionId:this.connectionId}}}],i=[{key:"getSingletonStatus",value:function(){return w.getAllConnections()}},{key:"clearAllConnections",value:function(){w.clearAll()}}],o&&I(e.prototype,o),i&&I(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,i,r,a}(c);function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function A(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return D(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(D(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,D(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,D(d,"constructor",l),D(l,"constructor",s),s.displayName="GeneratorFunction",D(l,i,"GeneratorFunction"),D(d),D(d,i,"Generator"),D(d,o,function(){return this}),D(d,"toString",function(){return"[object Generator]"}),(A=function(){return{w:r,m:f}})()}function D(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}D=function(t,n,e,o){function r(n,e){D(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},D(t,n,e,o)}function _(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function R(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){_(r,o,i,a,c,"next",t)}function c(t){_(r,o,i,a,c,"throw",t)}a(void 0)})}}function M(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,z(o.key),o)}}function z(t){var n=function(t){if("object"!=F(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=F(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(n)?n:n+""}function L(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(L=function(){return!!t})()}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}function U(t,n){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},U(t,n)}var K=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=function(t,n,e){return n=H(n),function(t,n){if(n&&("object"==F(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,L()?Reflect.construct(n,e||[],H(t).constructor):n.apply(t,e))}(this,n)).config=t,e.audioContext=null,e.audioWorkletNode=null,e.mediaStream=null,e.isRecording=!1,e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&U(t,n)}(n,t),e=n,o=[{key:"start",value:(r=R(A().m(function t(){var n,e=this;return A().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,navigator.mediaDevices.getUserMedia({audio:{sampleRate:this.config.sampleRate,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});case 1:if(this.mediaStream=t.v,this.audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:this.config.sampleRate}),"suspended"!==this.audioContext.state){t.n=2;break}return t.n=2,this.audioContext.resume();case 2:return t.n=3,this.audioContext.audioWorklet.addModule("/audio-processor.js");case 3:this.audioWorkletNode=new AudioWorkletNode(this.audioContext,"audio-processor"),this.audioContext.createMediaStreamSource(this.mediaStream).connect(this.audioWorkletNode),this.audioWorkletNode.port.onmessage=function(t){var n=t.data,o=n.type,i=n.data;"pcm_audio_data"===o&&e.emit("audioData",i)},this.audioWorkletNode.port.postMessage({type:"setForceContinuous",data:{enabled:!0}}),this.isRecording=!0,this.emit("recordingStarted"),t.n=5;break;case 4:throw t.p=4,n=t.v,this.emit("error",n),n;case 5:return t.a(2)}},t,this,[[0,4]])})),function(){return r.apply(this,arguments)})},{key:"stop",value:(i=R(A().m(function t(){var n;return A().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.isRecording){t.n=1;break}return t.a(2);case 1:if(t.p=1,!this.audioWorkletNode){t.n=2;break}return this.audioWorkletNode.port.postMessage({type:"flush"}),t.n=2,new Promise(function(t){return setTimeout(t,100)});case 2:if(this.mediaStream&&(this.mediaStream.getTracks().forEach(function(t){return t.stop()}),this.mediaStream=null),!this.audioContext||"closed"===this.audioContext.state){t.n=4;break}return t.n=3,this.audioContext.close();case 3:this.audioContext=null;case 4:this.audioWorkletNode=null,this.isRecording=!1,this.emit("recordingStopped"),t.n=6;break;case 5:throw t.p=5,n=t.v,this.emit("error",n),n;case 6:return t.a(2)}},t,this,[[1,5]])})),function(){return i.apply(this,arguments)})},{key:"getStatus",value:function(){return{isRecording:this.isRecording,audioContextState:this.audioContext?this.audioContext.state:"closed"}}},{key:"destroy",value:function(){this.stop()}}],o&&M(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,i,r}(c);function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function W(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return N(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(N(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,N(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,N(d,"constructor",l),N(l,"constructor",s),s.displayName="GeneratorFunction",N(l,i,"GeneratorFunction"),N(d),N(d,i,"Generator"),N(d,o,function(){return this}),N(d,"toString",function(){return"[object Generator]"}),(W=function(){return{w:r,m:f}})()}function N(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}N=function(t,n,e,o){function r(n,e){N(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},N(t,n,e,o)}function V(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function Q(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,q(o.key),o)}}function q(t){var n=function(t){if("object"!=G(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=G(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(n)?n:n+""}function Y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Y=function(){return!!t})()}function J(t){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},J(t)}function $(t,n){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},$(t,n)}var X=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=function(t,n,e){return n=J(n),function(t,n){if(n&&("object"==G(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Y()?Reflect.construct(n,e||[],J(t).constructor):n.apply(t,e))}(this,n)).config=t,e.audioContext=null,e.audioQueue=[],e.isPlaying=!1,e.isProcessingQueue=!1,e.currentSource=null,e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&$(t,n)}(n,t),e=n,o=[{key:"playAudio",value:function(t){var n=this;try{var e=this.createAudioBlob(t);this.audioQueue.push(e),this.isPlaying||this.isProcessingQueue||this.currentSource||setTimeout(function(){return n.processQueue()},50)}catch(t){this.emit("playbackError",t)}}},{key:"createAudioBlob",value:function(t){var n=new Uint8Array(t);if(n.length>=4){if(82===n[0]&&73===n[1]&&70===n[2]&&70===n[3])return new Blob([t],{type:"audio/wav"});if(255===n[0]&&!(224&~n[1]))return new Blob([t],{type:"audio/mpeg"});if(79===n[0]&&103===n[1]&&103===n[2]&&83===n[3])return new Blob([t],{type:"audio/ogg"})}return new Blob([t],{type:"audio/wav"})}},{key:"processQueue",value:(i=W().m(function t(){var n,e,o,i,r,a,c,s,l=this;return W().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.isProcessingQueue&&0!==this.audioQueue.length){t.n=1;break}return t.a(2);case 1:if(this.isProcessingQueue=!0,n=this.audioQueue.shift()){t.n=2;break}return this.isProcessingQueue=!1,t.a(2);case 2:if(t.p=2,e=!this.isPlaying&&null===this.currentSource,this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),"suspended"!==(o=this.audioContext).state){t.n=3;break}return t.n=3,o.resume();case 3:return t.n=4,n.arrayBuffer();case 4:return i=t.v,t.n=5,o.decodeAudioData(i);case 5:r=t.v,a=e&&!this.isPlaying&&null===this.currentSource,(c=o.createBufferSource()).buffer=r,c.connect(o.destination),this.currentSource=c,this.isPlaying=!0,a&&this.emit("playbackStarted"),c.onended=function(){l.currentSource=null,l.isProcessingQueue=!1,l.audioQueue.length>0?setTimeout(function(){return l.processQueue()},50):setTimeout(function(){0!==l.audioQueue.length||l.currentSource||(l.isPlaying=!1,l.emit("playbackStopped"))},100)},c.start(),t.n=7;break;case 6:t.p=6,s=t.v,this.currentSource=null,this.emit("playbackError",s),this.audioQueue.length>0?(this.isProcessingQueue=!1,setTimeout(function(){return l.processQueue()},100)):(this.isPlaying=!1,this.isProcessingQueue=!1,this.emit("playbackStopped"));case 7:return t.a(2)}},t,this,[[2,6]])}),r=function(){var t=this,n=arguments;return new Promise(function(e,o){var r=i.apply(t,n);function a(t){V(r,e,o,a,c,"next",t)}function c(t){V(r,e,o,a,c,"throw",t)}a(void 0)})},function(){return r.apply(this,arguments)})},{key:"stop",value:function(){this.stopImmediate()}},{key:"stopImmediate",value:function(){var t=this.isPlaying||null!==this.currentSource;if(this.currentSource){try{this.currentSource.stop()}catch(t){}this.currentSource=null}this.isPlaying=!1,this.isProcessingQueue=!1,this.audioQueue=[],t&&this.emit("playbackStopped")}},{key:"getStatus",value:function(){return{isPlaying:this.isPlaying,isProcessingQueue:this.isProcessingQueue,queueLength:this.audioQueue.length,audioContextState:this.audioContext?this.audioContext.state:"closed"}}},{key:"destroy",value:function(){this.stop(),this.audioContext&&"closed"!==this.audioContext.state&&(this.audioContext.close(),this.audioContext=null)}}],o&&Q(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,i,r}(c);function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function tt(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return nt(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(nt(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,nt(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,nt(d,"constructor",l),nt(l,"constructor",s),s.displayName="GeneratorFunction",nt(l,i,"GeneratorFunction"),nt(d),nt(d,i,"Generator"),nt(d,o,function(){return this}),nt(d,"toString",function(){return"[object Generator]"}),(tt=function(){return{w:r,m:f}})()}function nt(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}nt=function(t,n,e,o){function r(n,e){nt(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},nt(t,n,e,o)}function et(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function ot(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){et(r,o,i,a,c,"next",t)}function c(t){et(r,o,i,a,c,"throw",t)}a(void 0)})}}function it(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function rt(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?it(Object(e),!0).forEach(function(n){at(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):it(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function at(t,n,e){return(n=st(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function ct(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,st(o.key),o)}}function st(t){var n=function(t){if("object"!=Z(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=Z(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(n)?n:n+""}function lt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(lt=function(){return!!t})()}function ut(t){return ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ut(t)}function dt(t,n){return dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},dt(t,n)}var ft=function(t){function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=function(t,n,e){return n=ut(n),function(t,n){if(n&&("object"==Z(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,lt()?Reflect.construct(n,e||[],ut(t).constructor):n.apply(t,e))}(this,n)).config=rt({websocketUrl:e.websocketUrl||"wss://speech.talktopc.com/ws/conv",agentId:e.agentId,appId:e.appId,ttpId:e.ttpId,voice:e.voice||"default",language:e.language||"en",sampleRate:e.sampleRate||16e3},e),t.isConnected=!1,t.isRecording=!1,t.isPlaying=!1,t.isDestroyed=!1,t.webSocketManager=new T(rt(rt({},t.config),{},{autoReconnect:!1!==t.config.autoReconnect})),t.audioRecorder=new K(t.config),t.audioPlayer=new X(t.config),t.setupEventHandlers(),t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&dt(t,n)}(n,t),e=n,o=[{key:"setupEventHandlers",value:function(){var t=this;this.webSocketManager.on("connected",function(){t.isConnected=!0,t.sendHelloMessage(),t.emit("connected")}),this.webSocketManager.on("disconnected",function(n){t.isConnected=!1,t.isRecording&&t.stopRecording().catch(function(t){console.error("VoiceSDK: Error stopping recording on disconnect:",t)}),t.emit("disconnected",n)}),this.webSocketManager.on("error",function(n){t.emit("error",n)}),this.webSocketManager.on("message",function(n){if("greeting_audio"===n.t&&n.data)try{for(var e=atob(n.data),o=new Uint8Array(e.length),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);t.audioPlayer.playAudio(o),t.emit("greetingStarted")}catch(t){console.error("VoiceSDK: Error playing greeting audio:",t)}else t.emit("message",n)}),this.webSocketManager.on("binaryAudio",function(n){t.audioPlayer.playAudio(n)}),this.webSocketManager.on("bargeIn",function(n){t.emit("bargeIn",n)}),this.webSocketManager.on("stopPlaying",function(n){t.emit("stopPlaying",n),t.audioPlayer.stopImmediate()}),this.audioRecorder.on("recordingStarted",function(){t.isRecording=!0,t.isPlaying&&(t.audioPlayer.stopImmediate(),t.isConnected&&t.webSocketManager.sendMessage({t:"barge_in"})),t.emit("recordingStarted")}),this.audioRecorder.on("recordingStopped",function(){t.isRecording=!1,t.emit("recordingStopped")}),this.audioRecorder.on("audioData",function(n){t.isConnected&&t.webSocketManager.sendBinary(n)}),this.audioPlayer.on("playbackStarted",function(){t.isPlaying=!0,t.emit("playbackStarted"),t.isConnected&&t.webSocketManager.sendMessage({t:"audio_started_playing"})}),this.audioPlayer.on("playbackStopped",function(){t.isPlaying=!1,t.emit("playbackStopped"),t.isConnected&&t.webSocketManager.sendMessage({t:"audio_stopped_playing"})}),this.audioPlayer.on("playbackError",function(n){t.emit("playbackError",n)})}},{key:"connect",value:(l=ot(tt().m(function t(){var n,e;return tt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.isDestroyed){t.n=1;break}return console.warn("VoiceSDK: Cannot connect - SDK is destroyed"),t.a(2,!1);case 1:return t.p=1,n=this.buildWebSocketUrl(),this.webSocketManager.config.websocketUrl=n,t.n=2,this.webSocketManager.connect();case 2:return t.a(2,!0);case 3:return t.p=3,e=t.v,console.error("ðŸ”Œ VoiceSDK: Connection failed with error:",e),this.emit("error",e),t.a(2,!1)}},t,this,[[1,3]])})),function(){return l.apply(this,arguments)})},{key:"buildWebSocketUrl",value:function(){var t=this.config.websocketUrl,n=new URLSearchParams;if(this.config.agentId&&n.append("agentId",this.config.agentId),this.config.appId&&n.append("appId",this.config.appId),this.config.voice&&"default"!==this.config.voice&&n.append("voice",this.config.voice),this.config.language&&"en"!==this.config.language&&n.append("language",this.config.language),n.toString()){var e=t.includes("?")?"&":"?";t+=e+n.toString()}return t}},{key:"disconnect",value:function(){this.isDestroyed||(this.stopRecording(),this.webSocketManager.disconnect())}},{key:"resetReconnectionAttempts",value:function(){this.isDestroyed||this.webSocketManager.resetReconnectionAttempts()}},{key:"reconnect",value:(s=ot(tt().m(function t(){return tt().w(function(t){for(;;)switch(t.n){case 0:if(!this.isDestroyed){t.n=1;break}return t.a(2,!1);case 1:return this.disconnect(),this.resetReconnectionAttempts(),t.n=2,this.connect();case 2:return t.a(2,t.v)}},t,this)})),function(){return s.apply(this,arguments)})},{key:"startRecording",value:(c=ot(tt().m(function t(){var n;return tt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.isConnected){t.n=1;break}throw new Error("Not connected to voice server");case 1:return t.p=1,this.webSocketManager.sendMessage({t:"start_continuous_mode",ttpId:this.generateTtpId(),voice:this.config.voice,language:this.config.language}),t.n=2,this.audioRecorder.start();case 2:return t.a(2,!0);case 3:return t.p=3,n=t.v,console.error("âŒ VoiceSDK: Failed to start recording:",n),this.emit("error",n),t.a(2,!1)}},t,this,[[1,3]])})),function(){return c.apply(this,arguments)})},{key:"stopRecording",value:(a=ot(tt().m(function t(){var n;return tt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.isRecording){t.n=1;break}return t.a(2);case 1:return t.p=1,this.webSocketManager.sendMessage({t:"stop_continuous_mode",ttpId:this.generateTtpId()}),t.n=2,this.audioRecorder.stop();case 2:return this.audioPlayer.stopImmediate(),t.a(2,!0);case 3:return t.p=3,n=t.v,this.emit("error",n),t.a(2,!1)}},t,this,[[1,3]])})),function(){return a.apply(this,arguments)})},{key:"toggleRecording",value:(r=ot(tt().m(function t(){return tt().w(function(t){for(;;)switch(t.n){case 0:if(!this.isRecording){t.n=2;break}return t.n=1,this.stopRecording();case 1:case 3:return t.a(2,t.v);case 2:return t.n=3,this.startRecording();case 4:return t.a(2)}},t,this)})),function(){return r.apply(this,arguments)})},{key:"stopAudioPlayback",value:function(){this.audioPlayer.stopImmediate()}},{key:"handleBargeIn",value:(i=ot(tt().m(function t(){return tt().w(function(t){for(;;)switch(t.n){case 0:if(this.stopAudioPlayback(),this.isRecording){t.n=1;break}return t.n=1,this.startRecording();case 1:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})},{key:"getStatus",value:function(){return{isConnected:this.isConnected,isRecording:this.isRecording,isPlaying:this.isPlaying}}},{key:"updateConfig",value:function(t){this.config=rt(rt({},this.config),t)}},{key:"generateTtpId",value:function(){return"sdk_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()}},{key:"sendHelloMessage",value:function(){if(this.isConnected){var t={t:"hello"};this.config.appId?t.appId=this.config.appId:this.config.ttpId?t.ttpId=this.config.ttpId:t.ttpId=this.generateTtpId();try{this.webSocketManager.sendMessage(t)}catch(t){console.error("VoiceSDK: Failed to send hello message:",t),this.emit("error",t)}}else console.warn("VoiceSDK: Cannot send hello message - not connected")}},{key:"destroy",value:function(){this.isDestroyed||(this.disconnect(),this.isDestroyed=!0,this.audioRecorder.destroy(),this.audioPlayer.destroy(),this.removeAllListeners())}}],o&&ct(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,i,r,a,c,s,l}(c);function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function vt(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return ht(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(ht(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,ht(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,ht(d,"constructor",l),ht(l,"constructor",s),s.displayName="GeneratorFunction",ht(l,i,"GeneratorFunction"),ht(d),ht(d,i,"Generator"),ht(d,o,function(){return this}),ht(d,"toString",function(){return"[object Generator]"}),(vt=function(){return{w:r,m:f}})()}function ht(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}ht=function(t,n,e,o){function r(n,e){ht(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},ht(t,n,e,o)}function gt(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function yt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function mt(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?yt(Object(e),!0).forEach(function(n){bt(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):yt(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function bt(t,n,e){return(n=wt(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function xt(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,wt(o.key),o)}}function wt(t){var n=function(t){if("object"!=pt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=pt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(n)?n:n+""}function St(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(St=function(){return!!t})()}function kt(t){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kt(t)}function Ct(t,n){return Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Ct(t,n)}var Ot=function(t){function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var o=(t=function(t,n,e){return n=kt(n),function(t,n){if(n&&("object"==pt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,St()?Reflect.construct(n,e||[],kt(t).constructor):n.apply(t,e))}(this,n)).readScriptTagConfig();return t.config=mt({baseWsUrl:"wss://backend.talktopc.com/chat/websocket",appId:e.appId||o.appId,agentId:e.agentId||o.agentId,conversationId:void 0!==e.conversationId?e.conversationId:t.getPersistedConversationId(),forceConversationId:e.forceConversationId,queue:[],inFlight:!1},e),t.fullResponseBuffer="",t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&Ct(t,n)}(n,t),e=n,o=[{key:"readScriptTagConfig",value:function(){try{var t=Array.from(document.getElementsByTagName("script")).reverse().find(function(t){return t.dataset&&(t.dataset.appId||t.dataset.agentId)||t.src&&t.src.includes("agent-widget")});return t?{appId:t.dataset.appId,agentId:t.dataset.agentId}:{}}catch(t){return{}}}},{key:"buildWebSocketUrl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.baseWsUrl,n=new URLSearchParams;return this.config.appId&&n.append("appId",this.config.appId),this.config.agentId&&n.append("agentId",this.config.agentId),this.config.conversationId&&n.append("conversationId",this.config.conversationId),"".concat(t,"?").concat(n.toString())}},{key:"sendMessage",value:(i=vt().m(function t(n){var e=this;return vt().w(function(t){for(;;)if(0===t.n)return t.a(2,new Promise(function(t,o){if(n&&n.trim())if(e.config.appId&&e.config.agentId){var i={text:n,resolve:t,reject:o};e.config.inFlight?e.config.queue.push(i):e.executeTask(i)}else o(new Error("Missing appId or agentId"));else o(new Error("Message is empty"))}))},t)}),r=function(){var t=this,n=arguments;return new Promise(function(e,o){var r=i.apply(t,n);function a(t){gt(r,e,o,a,c,"next",t)}function c(t){gt(r,e,o,a,c,"throw",t)}a(void 0)})},function(t){return r.apply(this,arguments)})},{key:"executeTask",value:function(t){var n=this;if(this.config.inFlight=!0,this.fullResponseBuffer="",!this.config.conversationId){var e=this.getPersistedConversationId();e&&(this.config.conversationId=e,console.log("ðŸ” TextChatSDK hydrated conversationId from storage:",e))}var o,i=this.buildWebSocketUrl(this.config.baseWsUrl),r=this.config.baseWsUrl.endsWith("/websocket")?this.config.baseWsUrl.replace(/\/websocket$/,""):"".concat(this.config.baseWsUrl,"/websocket"),a=this.buildWebSocketUrl(r),c=!1,s=!1,l=null,u=function(e){if(!s)try{var o={message:t.text},i=n.config.forceConversationId||n.config.conversationId;i&&(o.conversationId=i,n.config.forceConversationId&&!n.config.conversationId&&(n.config.conversationId=i,n.persistConversationId(i))),console.log("ðŸ” TextChatSDK sending payload:",o,"conversationId in config:",n.config.conversationId),e.send(JSON.stringify(o)),s=!0}catch(o){t.reject(o),n.emit("error",o);try{e.close()}catch(t){}}},d=function(t){return function(){n.config.conversationId?u(t):l=setTimeout(function(){return u(t)},200)}},f=function(e){return function(o){try{try{console.log("ðŸ”Ž [TextChatSDK] WS <= raw:",o.data)}catch(t){}var i=JSON.parse(o.data);try{console.log("ðŸ”Ž [TextChatSDK] WS <= parsed:",i)}catch(t){}if("hello"===i.type&&i.conversationId){if(console.log("ðŸ” TextChatSDK received conversationId:",i.conversationId),n.config.conversationId=i.conversationId,n.persistConversationId(i.conversationId),n.emit&&n.emit("conversationIdChanged",i.conversationId),!s&&e&&1===e.readyState){if(l)try{clearTimeout(l)}catch(t){}u(e)}return}if(!n.config.conversationId&&i.conversationId&&(console.log("ðŸ” TextChatSDK captured conversationId from message:",i.conversationId),n.config.conversationId=i.conversationId,n.persistConversationId(i.conversationId)),"chunk"===i.type&&"string"==typeof i.content)n.fullResponseBuffer+=i.content,n.emit("chunk",i.content);else if("done"===i.type){try{var r=i.text||i.content||i.answer||i.message||"";r&&!n.fullResponseBuffer&&(n.fullResponseBuffer=r)}catch(t){}!n.config.conversationId&&i.conversationId&&(console.log("ðŸ” TextChatSDK captured conversationId from done:",i.conversationId),n.config.conversationId=i.conversationId),n.persistConversationId(n.config.conversationId),n.emit("done",{text:n.fullResponseBuffer}),t.resolve({conversationId:n.config.conversationId,fullText:n.fullResponseBuffer});try{e.close()}catch(t){}}else if("error"===i.type){var a=new Error(i.message||"Server error");n.emit("error",a),t.reject(a);try{e.close()}catch(t){}}}catch(t){}}},p=function(){n.config.inFlight=!1,n.drainQueue()},v=new WebSocket(i);v.onopen=d(v),v.onmessage=f(v),v.onerror=(o=v,function(e){if(!c){c=!0;try{o.close()}catch(t){}var i=new WebSocket(a);return i.onopen=d(i),i.onmessage=f(i),i.onerror=function(e){n.emit("error",e),t.reject(e)},void(i.onclose=p)}n.emit("error",e),t.reject(e)}),v.onclose=p}},{key:"drainQueue",value:function(){if(0!==this.config.queue.length&&!this.config.inFlight){var t=this.config.queue.shift();this.executeTask(t)}}},{key:"persistConversationId",value:function(t){try{t&&localStorage.setItem("ttp_text_chat_conversation_id",t)}catch(t){}}},{key:"getPersistedConversationId",value:function(){try{return localStorage.getItem("ttp_text_chat_conversation_id")||null}catch(t){return null}}},{key:"updateConfig",value:function(t){this.config=mt(mt({},this.config),t)}},{key:"destroy",value:function(){this.config.queue=[],this.config.inFlight=!1,this.removeAllListeners()}}],o&&xt(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,i,r}(c),It=e(540),jt=e(848);function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function Bt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function Et(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?Bt(Object(e),!0).forEach(function(n){Tt(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Bt(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function Tt(t,n,e){return(n=function(t){var n=function(t){if("object"!=Pt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=Pt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pt(n)?n:n+""}(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function Ft(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return At(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(At(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,At(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,At(d,"constructor",l),At(l,"constructor",s),s.displayName="GeneratorFunction",At(l,i,"GeneratorFunction"),At(d),At(d,i,"Generator"),At(d,o,function(){return this}),At(d,"toString",function(){return"[object Generator]"}),(Ft=function(){return{w:r,m:f}})()}function At(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}At=function(t,n,e,o){function r(n,e){At(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},At(t,n,e,o)}function Dt(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function _t(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var o,i,r,a,c=[],s=!0,l=!1;try{if(r=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;s=!1}else for(;!(s=(o=r.call(e)).done)&&(c.push(o.value),c.length!==n);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=e.return&&(a=e.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,n)||function(t,n){if(t){if("string"==typeof t)return Rt(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Rt(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=Array(n);e<n;e++)o[e]=t[e];return o}const Mt=function(t){var n=t.websocketUrl,e=t.agentId,o=t.voice,i=void 0===o?"default":o,r=t.language,a=void 0===r?"en":r,c=t.autoReconnect,s=void 0===c||c,l=t.onConnected,u=t.onDisconnected,d=t.onRecordingStarted,f=t.onRecordingStopped,p=t.onPlaybackStarted,v=t.onPlaybackStopped,h=t.onError,g=t.onMessage,y=t.onBargeIn,m=t.onStopPlaying,b=t.className,x=void 0===b?"":b,w=t.style,S=void 0===w?{}:w,k=t.children,C=_t((0,It.useState)(!1),2),O=C[0],I=C[1],j=_t((0,It.useState)(!1),2),P=j[0],B=j[1],E=_t((0,It.useState)(!1),2),T=(E[0],E[1]),F=_t((0,It.useState)("Disconnected"),2),A=(F[0],F[1]),D=(0,It.useRef)(null);(0,It.useEffect)(function(){console.log("ðŸŽ™ï¸ VoiceButton: Creating VoiceSDK instance for ".concat(n)),D.current&&(console.log("ðŸŽ™ï¸ VoiceButton: Destroying existing VoiceSDK instance"),D.current.destroy(),D.current=null);var t=new ft({websocketUrl:n,agentId:e,voice:i,language:a,autoReconnect:s});return t.on("connected",function(){I(!0),A("Connected"),null==l||l()}),t.on("disconnected",function(){I(!1),A("Disconnected"),null==u||u()}),t.on("recordingStarted",function(){B(!0),null==d||d()}),t.on("recordingStopped",function(){B(!1),null==f||f()}),t.on("playbackStarted",function(){T(!0),null==p||p()}),t.on("playbackStopped",function(){T(!1),null==v||v()}),t.on("error",function(t){null==h||h(t)}),t.on("message",function(t){null==g||g(t)}),t.on("bargeIn",function(t){null==y||y(t)}),t.on("stopPlaying",function(t){null==m||m(t)}),D.current=t,t.connect(),function(){console.log("ðŸŽ™ï¸ VoiceButton: Cleaning up VoiceSDK instance for ".concat(n)),D.current&&(D.current.destroy(),D.current=null)}},[n,e,i,a]);var _=function(){var t,n=(t=Ft().m(function t(){var n;return Ft().w(function(t){for(;;)switch(t.p=t.n){case 0:if(D.current){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,D.current.toggleRecording();case 2:t.n=4;break;case 3:t.p=3,n=t.v,console.error("Error toggling recording:",n);case 4:return t.a(2)}},t,null,[[1,3]])}),function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){Dt(r,o,i,a,c,"next",t)}function c(t){Dt(r,o,i,a,c,"throw",t)}a(void 0)})});return function(){return n.apply(this,arguments)}}(),R=(0,jt.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,jt.jsx)("div",{style:{fontSize:"20px"},children:P?"ðŸ”´":"ðŸŽ¤"}),(0,jt.jsx)("div",{children:P?"Stop Listening":"Start Listening"})]});return(0,jt.jsx)("button",{className:"voice-button ".concat(P?"recording":""," ").concat(x),style:Et({padding:"12px 24px",border:"none",borderRadius:"8px",backgroundColor:P?"#dc3545":"#007bff",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"500",transition:"all 0.2s ease"},S),onClick:_,disabled:!O,children:k||R})};function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Lt(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return Ht(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(Ht(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Ht(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,Ht(d,"constructor",l),Ht(l,"constructor",s),s.displayName="GeneratorFunction",Ht(l,i,"GeneratorFunction"),Ht(d),Ht(d,i,"Generator"),Ht(d,o,function(){return this}),Ht(d,"toString",function(){return"[object Generator]"}),(Lt=function(){return{w:r,m:f}})()}function Ht(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Ht=function(t,n,e,o){function r(n,e){Ht(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},Ht(t,n,e,o)}function Ut(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function Kt(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){Ut(r,o,i,a,c,"next",t)}function c(t){Ut(r,o,i,a,c,"throw",t)}a(void 0)})}}function Gt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function Wt(t,n,e){return(n=Vt(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function Nt(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Vt(o.key),o)}}function Vt(t){var n=function(t){if("object"!=zt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=zt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(n)?n:n+""}var Qt=function(){return t=function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=function(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?Gt(Object(e),!0).forEach(function(n){Wt(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Gt(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}({websocketUrl:n.websocketUrl||"wss://speech.talktopc.com/ws/conv",agentId:n.agentId,voice:n.voice||"default",language:n.language||"en",container:n.container||document.body,buttonText:n.buttonText||"Start Listening",buttonClass:n.buttonClass||"voice-button"},n),this.isConnected=!1,this.isRecording=!1,this.isPlaying=!1,this.voiceSDK=new ft({websocketUrl:this.options.websocketUrl,agentId:this.options.agentId,voice:this.options.voice,language:this.options.language}),this.setupEventListeners(),this.createButton(),this.connect()},n=[{key:"setupEventListeners",value:function(){var t=this;this.voiceSDK.on("connected",function(){var n,e;t.isConnected=!0,t.updateButton(),null===(n=(e=t.options).onConnected)||void 0===n||n.call(e)}),this.voiceSDK.on("disconnected",function(){var n,e;t.isConnected=!1,t.updateButton(),null===(n=(e=t.options).onDisconnected)||void 0===n||n.call(e)}),this.voiceSDK.on("recordingStarted",function(){var n,e;t.isRecording=!0,t.updateButton(),null===(n=(e=t.options).onRecordingStarted)||void 0===n||n.call(e)}),this.voiceSDK.on("recordingStopped",function(){var n,e;t.isRecording=!1,t.updateButton(),null===(n=(e=t.options).onRecordingStopped)||void 0===n||n.call(e)}),this.voiceSDK.on("playbackStarted",function(){var n,e;t.isPlaying=!0,null===(n=(e=t.options).onPlaybackStarted)||void 0===n||n.call(e)}),this.voiceSDK.on("playbackStopped",function(){var n,e;t.isPlaying=!1,null===(n=(e=t.options).onPlaybackStopped)||void 0===n||n.call(e)}),this.voiceSDK.on("error",function(n){var e,o;null===(e=(o=t.options).onError)||void 0===e||e.call(o,n)}),this.voiceSDK.on("message",function(n){var e,o;null===(e=(o=t.options).onMessage)||void 0===e||e.call(o,n)}),this.voiceSDK.on("bargeIn",function(n){var e,o;null===(e=(o=t.options).onBargeIn)||void 0===e||e.call(o,n)}),this.voiceSDK.on("stopPlaying",function(n){var e,o;null===(e=(o=t.options).onStopPlaying)||void 0===e||e.call(o,n)})}},{key:"createButton",value:function(){var t=this;this.button=document.createElement("button"),this.button.className=this.options.buttonClass,this.button.style.cssText="\n      padding: 12px 24px;\n      border: none;\n      border-radius: 8px;\n      background-color: #6c757d;\n      color: white;\n      cursor: pointer;\n      font-size: 16px;\n      font-weight: 500;\n      transition: all 0.2s ease;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    ",this.button.addEventListener("click",function(){return t.toggleRecording()}),this.options.container.appendChild(this.button),this.updateButton()}},{key:"updateButton",value:function(){if(this.button){var t=this.isRecording?"ðŸ”´":"ðŸŽ¤",n=this.isRecording?"Stop Listening":"Start Listening";this.button.innerHTML='\n      <span style="font-size: 20px;">'.concat(t,"</span>\n      <span>").concat(n,"</span>\n    "),this.button.disabled=!this.isConnected,this.button.style.backgroundColor=this.isRecording?"#dc3545":this.isConnected?"#007bff":"#6c757d"}}},{key:"connect",value:(o=Kt(Lt().m(function t(){var n;return Lt().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.voiceSDK.connect();case 1:t.n=3;break;case 2:t.p=2,n=t.v,console.error("Failed to connect:",n);case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return o.apply(this,arguments)})},{key:"toggleRecording",value:(e=Kt(Lt().m(function t(){var n;return Lt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(this.voiceSDK){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,this.voiceSDK.toggleRecording();case 2:t.n=4;break;case 3:t.p=3,n=t.v,console.error("Error toggling recording:",n);case 4:return t.a(2)}},t,this,[[1,3]])})),function(){return e.apply(this,arguments)})},{key:"getStatus",value:function(){return{isConnected:this.isConnected,isRecording:this.isRecording,isPlaying:this.isPlaying}}},{key:"updateConfig",value:function(t){this.voiceSDK.updateConfig(t)}},{key:"destroy",value:function(){this.button&&this.button.parentNode&&this.button.parentNode.removeChild(this.button),this.voiceSDK&&this.voiceSDK.destroy()}}],n&&Nt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o}();function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Yt(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return Jt(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(Jt(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Jt(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,Jt(d,"constructor",l),Jt(l,"constructor",s),s.displayName="GeneratorFunction",Jt(l,i,"GeneratorFunction"),Jt(d),Jt(d,i,"Generator"),Jt(d,o,function(){return this}),Jt(d,"toString",function(){return"[object Generator]"}),(Yt=function(){return{w:r,m:f}})()}function Jt(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Jt=function(t,n,e,o){function r(n,e){Jt(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},Jt(t,n,e,o)}function $t(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function Xt(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){$t(r,o,i,a,c,"next",t)}function c(t){$t(r,o,i,a,c,"throw",t)}a(void 0)})}}function Zt(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,tn(o.key),o)}}function tn(t){var n=function(t){if("object"!=qt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=qt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qt(n)?n:n+""}var nn=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),console.log("ðŸš€ AgentSDK v2.1.8 initialized with config:",n),this.config=n,this.voiceSDK=null,this.isConnected=!1,this.isListening=!1,this.onConnected=function(){},this.onDisconnected=function(){},this.onError=function(t){return console.error("SDK Error:",t)},this.onTranscript=function(t){},this.onAgentSpeaking=function(t){}},n=[{key:"connect",value:(o=Xt(Yt().m(function t(n){var e,o=this;return Yt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,n){t.n=1;break}throw new Error("signedUrl is required");case 1:return this.voiceSDK&&(console.log("ðŸ”Œ AgentSDK: Cleaning up existing connection"),this.voiceSDK.destroy(),this.voiceSDK=null),this.voiceSDK=new ft({websocketUrl:n,autoReconnect:!1,agentId:this.config.agentId,appId:this.config.appId,language:this.config.language||"en"}),this.voiceSDK.on("connected",function(){o.isConnected=!0,o.onConnected()}),this.voiceSDK.on("disconnected",function(){o.isConnected=!1,o.onDisconnected()}),this.voiceSDK.on("error",function(t){o.onError(t)}),this.voiceSDK.on("message",function(t){o.handleWebSocketMessage(t)}),this.voiceSDK.on("recordingStarted",function(){o.isListening=!0}),this.voiceSDK.on("recordingStopped",function(){o.isListening=!1}),this.voiceSDK.on("playbackStarted",function(){o.onAgentSpeaking(!0)}),this.voiceSDK.on("playbackStopped",function(){o.onAgentSpeaking(!1)}),t.n=2,this.voiceSDK.connect();case 2:t.n=4;break;case 3:throw t.p=3,e=t.v,this.onError(e),e;case 4:return t.a(2)}},t,this,[[0,3]])})),function(t){return o.apply(this,arguments)})},{key:"handleWebSocketMessage",value:function(t){switch(t.type){case"connected":console.log("Session started successfully");break;case"user_transcript":this.onTranscript(t.user_transcription||t.text);break;case"agent_response":case"barge_in":case"stop_playing":break;case"error":this.onError(new Error(t.message))}}},{key:"startListening",value:(e=Xt(Yt().m(function t(){var n;return Yt().w(function(t){for(;;)switch(t.p=t.n){case 0:if(console.log("ðŸŽ¤ AgentSDK: startListening() called"),!this.voiceSDK){t.n=5;break}return t.p=1,console.log("ðŸŽ¤ AgentSDK: Starting recording..."),t.n=2,this.voiceSDK.startRecording();case 2:console.log("âœ… AgentSDK: Recording started successfully"),t.n=4;break;case 3:throw t.p=3,n=t.v,console.error("âŒ AgentSDK: Failed to start recording:",n),n;case 4:t.n=6;break;case 5:throw console.error("âŒ AgentSDK: No voiceSDK instance available"),new Error("No voiceSDK instance available");case 6:return t.a(2)}},t,this,[[1,3]])})),function(){return e.apply(this,arguments)})},{key:"stopListening",value:function(){this.voiceSDK&&this.voiceSDK.stopRecording()}},{key:"updateVariables",value:function(t){this.voiceSDK&&this.isConnected&&this.voiceSDK.webSocketManager.sendMessage({t:"update_variables",variables:t})}},{key:"disconnect",value:function(){this.voiceSDK&&(this.voiceSDK.destroy(),this.voiceSDK=null),this.isConnected=!1,this.isListening=!1}}],n&&Zt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o}();function en(t){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},en(t)}function on(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return rn(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(rn(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,rn(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,rn(d,"constructor",l),rn(l,"constructor",s),s.displayName="GeneratorFunction",rn(l,i,"GeneratorFunction"),rn(d),rn(d,i,"Generator"),rn(d,o,function(){return this}),rn(d,"toString",function(){return"[object Generator]"}),(on=function(){return{w:r,m:f}})()}function rn(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}rn=function(t,n,e,o){function r(n,e){rn(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},rn(t,n,e,o)}function an(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function cn(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){an(r,o,i,a,c,"next",t)}function c(t){an(r,o,i,a,c,"throw",t)}a(void 0)})}}function sn(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ln(o.key),o)}}function ln(t){var n=function(t){if("object"!=en(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=en(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==en(n)?n:n+""}var un=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=n,this.audioStream=null,this.callStartTime=null,this.callTimerInterval=null,this.sdk=null,this.isActive=!1,this.sdk=new nn({agentId:n.agentId,appId:n.appId,getSessionUrl:n.getSessionUrl,websocketUrl:n.websocketUrl,variables:n.variables||{},language:n.language||"en"}),this.setupSDKEventHandlers()},n=[{key:"setupSDKEventHandlers",value:function(){var t=this;this.sdk.onTranscript=function(n){t.updateTranscript(n)},this.sdk.onAgentSpeaking=function(t){var n=document.getElementById("voiceAvatarActive");n&&(t?n.classList.add("speaking"):n.classList.remove("speaking"))},this.sdk.onError=function(n){console.error("âŒ Voice SDK Error:",n),t.showError(n.message||n)}}},{key:"t",value:function(t){var n,e,o=this.config.language||"en";return((null===(n=this.config.translations)||void 0===n?void 0:n[o])||(null===(e=this.config.translations)||void 0===e?void 0:e.en)||{})[t]||t}},{key:"getTooltip",value:function(t){var n,e=null===(n=this.config.tooltips)||void 0===n?void 0:n[t];return null!=e?e:{mute:this.t("mute"),speaker:this.t("speaker"),endCall:this.t("endCall")}[t]||""}},{key:"generateHTML",value:function(){return'<div class="voice-interface" id="voiceInterface">\n      \x3c!-- Before Call State --\x3e\n      <div id="voiceIdleState" style="display: flex; flex-direction: column; align-items: center; width: 100%;">\n        <div class="voice-avatar" id="voiceAvatar">\n          ðŸ¤–\n        </div>\n        <div class="voice-status">\n          <div class="voice-status-title">'.concat(this.t("clickToStartCall"),'</div>\n          <div class="voice-status-subtitle">').concat(this.t("realTimeVoice"),'</div>\n        </div>\n        \x3c!-- BIG START CALL BUTTON --\x3e\n        <button class="start-call-btn" id="startCallBtn">\n          <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">\n            <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/>\n          </svg>\n          <span>').concat(this.t("startCall"),'</span>\n        </button>\n      </div>\n      \x3c!-- During Call State --\x3e\n      <div id="voiceActiveState" style="display: none; flex-direction: column; align-items: center; width: 100%; height: 100%; justify-content: flex-start; overflow: hidden; padding-top: 10px;">\n        <div class="voice-avatar-active" id="voiceAvatarActive">\n          <div class="voice-rings">\n            <div class="voice-ring"></div>\n            <div class="voice-ring"></div>\n            <div class="voice-ring"></div>\n          </div>\n          ðŸ¤–\n        </div>\n        <div class="voice-status">\n          <div class="voice-status-title" id="voiceStatusTitleActive">').concat(this.t("listening"),'</div>\n          <div class="voice-status-subtitle" id="voiceStatusSubtitleActive">').concat(this.t("speakFreely"),'</div>\n        </div>\n        <div class="voice-transcript">\n          <div class="transcript-label">').concat(this.t("liveTranscript"),'</div>\n          <div class="transcript-text empty" id="transcriptText">\n            ').concat(this.t("transcriptWillAppear"),'\n          </div>\n        </div>\n        <div class="voice-controls">\n          <button class="voice-control-btn secondary" id="muteBtn" title="').concat(this.getTooltip("mute"),'">\n            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="mute-icon">\n              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>\n              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>\n              <line x1="12" y1="19" x2="12" y2="23"/>\n              <line x1="8" y1="23" x2="16" y2="23"/>\n              <line x1="2" y1="2" x2="22" y2="22" class="mute-cross" style="display: none; stroke: #ef4444; stroke-width: 3.5;"/>\n            </svg>\n          </button>\n          <button class="voice-control-btn primary active" id="endCallBtn" title="').concat(this.getTooltip("endCall"),'">\n            <svg width="56" height="56" viewBox="0 0 24 24" fill="#ef4444">\n              <rect x="6" y="6" width="12" height="12" rx="2"/>\n            </svg>\n            <div class="voice-timer" id="voiceTimer">00:00</div>\n          </button>\n          <button class="voice-control-btn secondary" id="speakerBtn" title="').concat(this.getTooltip("speaker"),'">\n            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">\n              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>\n              <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>\n              <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>')}},{key:"generateCSS",value:function(){var t=this.config.avatarBackgroundColor||"#667eea",n=this.config.avatarActiveBackgroundColor||this.config.avatarBackgroundColor||"#667eea",e=this.config.statusTitleColor||"#1e293b",o=this.config.statusSubtitleColor||"#64748b",i=this.config.startCallButtonColor||"#667eea",r=this.config.startCallButtonTextColor||"#FFFFFF",a=this.config.transcriptBackgroundColor||"#FFFFFF",c=this.config.transcriptTextColor||"#1e293b",s=this.config.transcriptLabelColor||"#94a3b8",l=this.config.controlButtonColor||"#FFFFFF",u=this.config.controlButtonSecondaryColor||"#64748b",d=this.config.endCallButtonColor||"#ef4444";return"\n      /* Voice Interface Styles */\n      .voice-interface { \n        display: none; \n        flex: 1; \n        flex-direction: column;\n        align-items: center; \n        justify-content: flex-start; \n        padding: 10px 20px 20px 20px; \n        background: linear-gradient(180deg, #f8fafc 0%, #e0e7ff 100%);\n        overflow: hidden;\n        min-height: 0;\n      }\n      .voice-interface.active { display: flex; }\n      \n      /* Voice Avatar (idle state) */\n      .voice-avatar {\n        width: 120px;\n        height: 120px;\n        border-radius: 50%;\n        background: linear-gradient(135deg, ".concat(t," 0%, ").concat(n," 100%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 56px;\n        margin-top: 10px;\n        margin-bottom: 16px;\n        box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);\n        transition: all 0.3s ease;\n        flex-shrink: 0;\n      }\n      \n      /* Voice Avatar (active state with animations) */\n      .voice-avatar-active {\n        width: 120px;\n        height: 120px;\n        border-radius: 50%;\n        background: linear-gradient(135deg, ").concat(t," 0%, ").concat(n," 100%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 56px;\n        margin-top: 10px;\n        margin-bottom: 16px;\n        position: relative;\n        box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);\n        animation: avatarPulse 2s ease-in-out infinite;\n        flex-shrink: 0;\n      }\n      \n      @keyframes avatarPulse {\n        0%, 100% { \n          transform: scale(1);\n          box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);\n        }\n        50% { \n          transform: scale(1.05);\n          box-shadow: 0 15px 50px rgba(102, 126, 234, 0.5);\n        }\n      }\n      \n      .voice-avatar-active.speaking {\n        animation: avatarSpeak 0.5s ease-in-out infinite;\n      }\n      \n      @keyframes avatarSpeak {\n        0%, 100% { transform: scale(1); }\n        50% { transform: scale(1.08); }\n      }\n      \n      /* Voice Rings Animation */\n      .voice-rings {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n      }\n      \n      .voice-ring {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        border: 2px solid rgba(102, 126, 234, 0.3);\n        border-radius: 50%;\n        opacity: 0;\n        animation: ringExpand 2s ease-out infinite;\n      }\n      \n      .voice-ring:nth-child(2) { animation-delay: 0.5s; }\n      .voice-ring:nth-child(3) { animation-delay: 1s; }\n      \n      @keyframes ringExpand {\n        0% {\n          width: 100%;\n          height: 100%;\n          opacity: 0.6;\n        }\n        100% {\n          width: 160%;\n          height: 160%;\n          opacity: 0;\n        }\n      }\n      \n      /* Voice Status */\n      .voice-status {\n        text-align: center;\n        margin-bottom: 10px;\n        flex-shrink: 0;\n      }\n      \n      .voice-status-title {\n        font-size: 18px;\n        font-weight: 600;\n        color: ").concat(e,";\n        margin-bottom: 4px;\n      }\n      \n      .voice-status-subtitle {\n        font-size: 12px;\n        color: ").concat(o,";\n      }\n      \n      /* Start Call Button */\n      .start-call-btn {\n        margin-top: 20px;\n        width: 200px;\n        height: 56px;\n        border-radius: 28px;\n        border: none;\n        background: ").concat(i,";\n        color: ").concat(r,";\n        font-size: 18px;\n        font-weight: 600;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 12px;\n        box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);\n        transition: all 0.3s ease;\n        flex-shrink: 0;\n      }\n      \n      .start-call-btn:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 16px 40px rgba(102, 126, 234, 0.5);\n      }\n      \n      .start-call-btn:active {\n        transform: translateY(-2px);\n      }\n      \n      /* Voice Transcript */\n      .voice-transcript {\n        background: ").concat(a,";\n        padding: 12px;\n        border-radius: 12px;\n        max-width: 300px;\n        width: 100%;\n        margin-bottom: 12px;\n        min-height: 50px;\n        max-height: 90px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n        flex-shrink: 1;\n        overflow-y: auto;\n      }\n      \n      .transcript-label {\n        font-size: 10px;\n        color: ").concat(s,";\n        font-weight: 600;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n        margin-bottom: 6px;\n      }\n      \n      .transcript-text {\n        font-size: 14px;\n        color: ").concat(c,";\n        line-height: 1.5;\n        min-height: 30px;\n      }\n      \n      .transcript-text.empty {\n        color: #cbd5e1;\n        font-style: italic;\n      }\n      \n      /* Voice Controls */\n      .voice-controls {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n        flex-shrink: 0;\n      }\n      \n      .voice-control-btn {\n        width: 72px;\n        height: 72px;\n        border-radius: 50%;\n        border: none;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s;\n        position: relative;\n        flex-shrink: 0;\n      }\n      \n      .voice-control-btn.primary {\n        width: 80px;\n        height: 80px;\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);\n      }\n      \n      .voice-control-btn.primary:hover {\n        transform: scale(1.05);\n        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.5);\n      }\n      \n      .voice-control-btn.primary.active {\n        background: ").concat("#ef4444"===d?"white":l,";\n        animation: recordingPulse 1.5s ease-in-out infinite;\n        box-shadow: 0 8px 20px ").concat("#ef4444"===d?"rgba(239, 68, 68, 0.4)":"rgba(0, 0, 0, 0.2)",";\n      }\n      \n      @keyframes recordingPulse {\n        0%, 100% { \n          box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);\n        }\n        50% { \n          box-shadow: 0 8px 30px rgba(239, 68, 68, 0.7);\n        }\n      }\n      \n      .voice-control-btn.secondary {\n        background: ").concat(l,";\n        color: ").concat(u,";\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      }\n      \n      .voice-control-btn.secondary:hover {\n        background: #f8fafc;\n        transform: scale(1.05);\n      }\n      \n      .voice-control-btn.secondary.muted {\n        background: #f3f4f6;\n      }\n      \n      .voice-control-btn.secondary.muted .mute-icon {\n        stroke: #9ca3af !important;\n      }\n      \n      .voice-timer {\n        position: absolute;\n        bottom: -24px;\n        font-size: 12px;\n        color: #64748b;\n        font-weight: 500;\n      }\n      \n      @media (max-width: 768px) {\n        .voice-interface {\n          padding: 8px 12px 16px 12px;\n        }\n        \n        .voice-avatar,\n        .voice-avatar-active {\n          width: 100px;\n          height: 100px;\n          font-size: 48px;\n          margin-top: 8px;\n          margin-bottom: 12px;\n        }\n        \n        .voice-status-title {\n          font-size: 16px;\n        }\n        \n        .voice-status-subtitle {\n          font-size: 13px;\n        }\n        \n        .voice-start-call-btn {\n          padding: 12px 24px;\n          font-size: 15px;\n          min-height: 44px;\n        }\n        \n        .voice-transcript-container {\n          padding: 12px;\n          max-height: 180px;\n        }\n        \n        .voice-transcript-text {\n          font-size: 14px;\n          line-height: 1.5;\n        }\n        \n        .voice-controls {\n          gap: 12px;\n          padding: 12px;\n        }\n        \n        .voice-control-btn {\n          width: 48px;\n          height: 48px;\n          min-width: 48px;\n          min-height: 48px;\n        }\n        \n        .voice-control-btn.end-call {\n          width: 52px;\n          height: 52px;\n          min-width: 52px;\n          min-height: 52px;\n        }\n      }\n      \n      @media (max-width: 480px) {\n        .voice-interface {\n          padding: 6px 10px 12px 10px;\n        }\n        \n        .voice-avatar,\n        .voice-avatar-active {\n          width: 90px;\n          height: 90px;\n          font-size: 42px;\n        }\n        \n        .voice-status-title {\n          font-size: 15px;\n        }\n        \n        .voice-status-subtitle {\n          font-size: 12px;\n        }\n        \n        .voice-start-call-btn {\n          padding: 10px 20px;\n          font-size: 14px;\n        }\n        \n        .voice-transcript-container {\n          padding: 10px;\n          max-height: 150px;\n        }\n        \n        .voice-transcript-text {\n          font-size: 13px;\n        }\n        \n        .voice-controls {\n          gap: 10px;\n          padding: 10px;\n        }\n        \n        .voice-control-btn {\n          width: 44px;\n          height: 44px;\n          min-width: 44px;\n          min-height: 44px;\n        }\n        \n        .voice-control-btn.end-call {\n          width: 48px;\n          height: 48px;\n          min-width: 48px;\n          min-height: 48px;\n        }\n      }\n    ")}},{key:"setupEventHandlers",value:function(t){var n=this,e=document.getElementById("startCallBtn"),o=document.getElementById("endCallBtn"),i=document.getElementById("muteBtn"),r=document.getElementById("speakerBtn");e&&(e.onclick=function(){return n.startVoiceCall()}),o&&(o.onclick=function(){return n.endVoiceCall()}),i&&(i.onclick=function(){return n.toggleMute()}),r&&(r.onclick=function(){return n.toggleSpeaker()})}},{key:"getSignedUrl",value:(o=cn(on().m(function t(){var n,e,o,i,r,a,c;return on().w(function(t){for(;;)switch(t.n){case 0:if(this.config.getSessionUrl){t.n=2;break}if(this.config.agentId){t.n=1;break}throw new Error("agentId is required");case 1:return n=this.config.websocketUrl||"wss://speech.talktopc.com/ws/conv",(e=new URLSearchParams).append("agentId",this.config.agentId),this.config.appId&&e.append("appId",this.config.appId),!1!==this.config.demo&&e.append("demo","true"),t.a(2,"".concat(n,"?").concat(e.toString()));case 2:if("string"!=typeof this.config.getSessionUrl){t.n=6;break}return o={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(o.appId=this.config.appId),t.n=3,fetch(this.config.getSessionUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:if((i=t.v).ok){t.n=4;break}throw new Error("Failed to get session URL: ".concat(i.statusText));case 4:return t.n=5,i.json();case 5:return r=t.v,t.a(2,r.signedUrl||r.wsUrl||r.url);case 6:if("function"!=typeof this.config.getSessionUrl){t.n=8;break}return a={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(a.appId=this.config.appId),t.n=7,this.config.getSessionUrl(a);case 7:return c=t.v,t.a(2,"string"==typeof c?c:c.signedUrl||c.wsUrl||c.url);case 8:throw new Error("getSessionUrl must be a string (backend URL), a function, or omitted (for direct connection with agentId/appId)");case 9:return t.a(2)}},t,this)})),function(){return o.apply(this,arguments)})},{key:"startVoiceCall",value:(e=cn(on().m(function t(){var n,e,o,i,r,a,c,s,l,u=this;return on().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.isActive){t.n=1;break}return console.log("âš ï¸ Voice call already active"),t.a(2);case 1:return console.log("ðŸŽ¤ Starting voice call..."),t.p=2,n=document.getElementById("voiceIdleState"),e=document.getElementById("voiceActiveState"),o=document.getElementById("voiceInterface"),n&&(n.style.display="none"),e&&(e.style.display="flex"),o&&(o.scrollTop=0),t.n=3,this.getSignedUrl();case 3:return i=t.v,console.log("ðŸ”— Got signed URL:",i),t.n=4,this.sdk.connect(i);case 4:r=t.v,console.log("âœ… Connected to WebSocket, connected:",r),a=0;case 5:if(this.sdk.isConnected||!(a<50)){t.n=7;break}return t.n=6,new Promise(function(t){return setTimeout(t,100)});case 6:a++,t.n=5;break;case 7:if(!this.sdk.isConnected){t.n=9;break}return console.log("âœ… WebSocket ready, starting listening..."),t.n=8,this.sdk.startListening();case 8:console.log("ðŸŽ¤ Started listening"),this.isActive=!0,this.callStartTime=Date.now(),this.callTimerInterval=setInterval(function(){var t=Date.now()-u.callStartTime,n=Math.floor(t/6e4),e=Math.floor(t%6e4/1e3),o=document.getElementById("voiceTimer");o&&(o.textContent="".concat(n.toString().padStart(2,"0"),":").concat(e.toString().padStart(2,"0")))},1e3),t.n=11;break;case 9:return console.warn("âš ï¸ Connection not fully ready, but trying to start listening anyway..."),t.n=10,this.sdk.startListening();case 10:console.log("ðŸŽ¤ Started listening"),this.isActive=!0,this.callStartTime=Date.now(),this.callTimerInterval=setInterval(function(){var t=Date.now()-u.callStartTime,n=Math.floor(t/6e4),e=Math.floor(t%6e4/1e3),o=document.getElementById("voiceTimer");o&&(o.textContent="".concat(n.toString().padStart(2,"0"),":").concat(e.toString().padStart(2,"0")))},1e3);case 11:console.log("âœ… Voice call started successfully"),t.n=13;break;case 12:t.p=12,l=t.v,console.error("âŒ Error starting voice call:",l),this.showError(l.message||l),c=document.getElementById("voiceIdleState"),s=document.getElementById("voiceActiveState"),c&&(c.style.display="flex"),s&&(s.style.display="none");case 13:return t.a(2)}},t,this,[[2,12]])})),function(){return e.apply(this,arguments)})},{key:"endVoiceCall",value:function(){console.log("ðŸ”´ Ending voice call..."),this.sdk&&this.isActive&&(this.sdk.stopListening(),this.sdk.disconnect(),this.isActive=!1),this.audioStream&&(this.audioStream.getTracks().forEach(function(t){return t.stop()}),this.audioStream=null),this.callTimerInterval&&(clearInterval(this.callTimerInterval),this.callTimerInterval=null);var t=document.getElementById("voiceIdleState"),n=document.getElementById("voiceActiveState");t&&(t.style.display="flex"),n&&(n.style.display="none");var e=document.getElementById("transcriptText");e&&(e.textContent=this.t("transcriptWillAppear"),e.classList.add("empty"));var o=document.getElementById("voiceAvatarActive");o&&o.classList.remove("speaking"),console.log("âœ… Voice call ended")}},{key:"updateTranscript",value:function(t){var n=document.getElementById("transcriptText");n&&(n.textContent=t,n.classList.remove("empty"))}},{key:"showError",value:function(t){var n=document.getElementById("transcriptText");n&&(n.textContent="".concat(this.t("error"),": ").concat(t),n.classList.remove("empty"))}},{key:"toggleMute",value:function(){if(this.sdk&&this.isActive){var t=null;if(this.sdk.voiceSDK&&this.sdk.voiceSDK.audioRecorder&&this.sdk.voiceSDK.audioRecorder.mediaStream&&(t=this.sdk.voiceSDK.audioRecorder.mediaStream.getAudioTracks()[0]),!t&&this.audioStream&&(t=this.audioStream.getAudioTracks()[0]),t){t.enabled=!t.enabled;var n=document.getElementById("muteBtn"),e=null==n?void 0:n.querySelector(".mute-icon"),o=null==n?void 0:n.querySelector(".mute-cross");n&&e&&o&&(t.enabled?(e.style.stroke="",o.style.display="none",n.classList.remove("muted")):(e.style.stroke="#9ca3af",o.style.display="block",n.classList.add("muted"))),console.log(t.enabled?"ðŸ”Š Unmuted":"ðŸ”‡ Muted")}else console.warn("âš ï¸ No audio track available for mute toggle")}}},{key:"toggleSpeaker",value:function(){console.log("ðŸ”Š Speaker toggle")}},{key:"destroy",value:function(){this.isActive&&this.endVoiceCall(),this.audioStream&&(this.audioStream.getTracks().forEach(function(t){return t.stop()}),this.audioStream=null),this.callTimerInterval&&(clearInterval(this.callTimerInterval),this.callTimerInterval=null),this.sdk&&(this.sdk.disconnect(),this.sdk=null)}}],n&&sn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o}();function dn(t){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dn(t)}function fn(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return pn(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(pn(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,pn(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,pn(d,"constructor",l),pn(l,"constructor",s),s.displayName="GeneratorFunction",pn(l,i,"GeneratorFunction"),pn(d),pn(d,i,"Generator"),pn(d,o,function(){return this}),pn(d,"toString",function(){return"[object Generator]"}),(fn=function(){return{w:r,m:f}})()}function pn(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}pn=function(t,n,e,o){function r(n,e){pn(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},pn(t,n,e,o)}function vn(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function hn(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){vn(r,o,i,a,c,"next",t)}function c(t){vn(r,o,i,a,c,"throw",t)}a(void 0)})}}function gn(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,yn(o.key),o)}}function yn(t){var n=function(t){if("object"!=dn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=dn(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dn(n)?n:n+""}var mn=function(){return t=function t(n,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=n,this.sdk=e,this.streamingEl=null,this.hasStartedStreaming=!1,this.isActive=!1},n=[{key:"t",value:function(t){var n,e,o=this.config.language||"en";return((null===(n=this.config.translations)||void 0===n?void 0:n[o])||(null===(e=this.config.translations)||void 0===e?void 0:e.en)||{})[t]||t}},{key:"generateHTML",value:function(){var t,n,e,o,i,r,a,c,s,l=this.config.inputPlaceholder||(null===(t=this.config.panel)||void 0===t?void 0:t.inputPlaceholder)||this.t("typeMessage")||"Type your message...";return'<div class="text-interface" id="textInterface">\n      <div class="messages-container" id="messagesContainer">\n        <div class="empty-state">\n          <div class="empty-state-icon">ðŸ’¬</div>\n          <div class="empty-state-title">'.concat(this.t("hello"),'</div>\n          <div class="empty-state-text">').concat(this.t("sendMessage"),'</div>\n        </div>\n      </div>\n      <div class="input-container">\n        <div class="input-wrapper" style="flex:1;">\n          <textarea class="message-input" id="messageInput" placeholder="').concat(l,'" rows="1" dir="').concat(this.config.direction||"ltr",'"></textarea>\n        </div>\n        <button class="send-button" id="sendButton" aria-label="').concat(this.t("sendMessageAria"),'">').concat(this.config.sendButtonText||"âž¤","</button>\n        ").concat(null!==(n=this.config.sendButtonHint)&&void 0!==n&&n.text||null!==(e=this.config.panel)&&void 0!==e&&null!==(e=e.sendButtonHint)&&void 0!==e&&e.text?'\n          <div class="send-button-hint" style="color: '.concat((null===(o=this.config.sendButtonHint)||void 0===o?void 0:o.color)||(null===(i=this.config.panel)||void 0===i||null===(i=i.sendButtonHint)||void 0===i?void 0:i.color)||"#6B7280","; font-size: ").concat((null===(r=this.config.sendButtonHint)||void 0===r?void 0:r.fontSize)||(null===(a=this.config.panel)||void 0===a||null===(a=a.sendButtonHint)||void 0===a?void 0:a.fontSize)||"12px",'; text-align: center; margin-top: 4px;">\n            ').concat((null===(c=this.config.sendButtonHint)||void 0===c?void 0:c.text)||(null===(s=this.config.panel)||void 0===s||null===(s=s.sendButtonHint)||void 0===s?void 0:s.text),"\n          </div>\n        "):"","\n      </div>\n    </div>")}},{key:"generateCSS",value:function(){var t,n,e,o,i,r,a,c,s,l,u,d,f,p=this.config.messages,v=(this.config.panel,this.config.animation,this.config.sendButtonColor||(null===(t=this.config.panel)||void 0===t?void 0:t.sendButtonColor)||"#7C3AED"),h=this.config.sendButtonHoverColor||(null===(n=this.config.panel)||void 0===n?void 0:n.sendButtonHoverColor)||"#6D28D9",g=this.config.sendButtonTextColor||(null===(e=this.config.panel)||void 0===e?void 0:e.sendButtonTextColor)||"#FFFFFF",y=(this.config.inputPlaceholder||null===(o=this.config.panel)||void 0===o||o.inputPlaceholder,this.config.inputBorderColor||(null===(i=this.config.panel)||void 0===i?void 0:i.inputBorderColor)||"#E5E7EB"),m=this.config.inputFocusColor||(null===(r=this.config.panel)||void 0===r?void 0:r.inputFocusColor)||"#7C3AED",b=this.config.inputBackgroundColor||(null===(a=this.config.panel)||void 0===a?void 0:a.inputBackgroundColor)||"#FFFFFF",x=this.config.inputTextColor||(null===(c=this.config.panel)||void 0===c?void 0:c.inputTextColor)||"#1F2937",w=this.config.inputFontSize||(null===(s=this.config.panel)||void 0===s?void 0:s.inputFontSize)||"14px",S=this.config.inputBorderRadius||(null===(l=this.config.panel)||void 0===l?void 0:l.inputBorderRadius)||20,k=this.config.inputPadding||(null===(u=this.config.panel)||void 0===u?void 0:u.inputPadding)||"6px 14px";return"\n      /* Messages container using new classes */\n      #messagesContainer { \n        flex: 1; \n        overflow-y: auto; \n        overflow-x: hidden; \n        padding: 20px; \n        background: #f8fafc; \n        display: flex; \n        flex-direction: column; \n        gap: 16px; \n        min-height: 0; \n      }\n      .empty-state { \n        flex: 1; \n        display: flex; \n        flex-direction: column; \n        align-items: center; \n        justify-content: center; \n        gap: 12px; \n        color: #64748b; \n        text-align: center; \n        padding: 20px; \n      }\n      .empty-state-icon { font-size: 48px; opacity: 0.3; }\n      .empty-state-title { font-size: 20px; font-weight: 700; color: #334155; }\n      .empty-state-text { font-size: 13px; max-width: 280px; }\n\n      .text-interface { \n        display: none; \n        flex: 1; \n        flex-direction: column; \n        min-height: 0; \n        overflow: hidden; \n      }\n      .text-interface.active { display: flex; }\n      \n      .message { \n        display: flex; \n        gap: 8px; \n        padding: 4px 0; \n        max-width: 100%; \n        align-items: center; \n      }\n      .message.edge-left { flex-direction: row; }\n      .message.edge-right { flex-direction: row-reverse; }\n      .message-bubble { \n        padding: 12px; \n        border-radius: ".concat(p.borderRadius,"px; \n        max-width: 80%; \n        font-size: ").concat(p.fontSize,"; \n        color: ").concat(p.textColor,"; \n        word-wrap: break-word; \n        text-align: ").concat("rtl"===this.config.direction?"right":"left","; \n        direction: ").concat(this.config.direction||"ltr",";\n      }\n      .message.user { \n        background: ").concat(p.userBackgroundColor,"; \n        align-self: ").concat("rtl"===this.config.direction?"flex-start":"flex-end","; \n      }\n      .message.agent { \n        background: ").concat(p.agentBackgroundColor,"; \n        align-self: ").concat("rtl"===this.config.direction?"flex-end":"flex-start","; \n      }\n      .message .message-bubble { \n        text-align: ").concat("rtl"===this.config.direction?"right":"left","; \n      }\n      .message-avatar { \n        width: 20px; \n        height: 20px; \n        display: flex; \n        align-items: center; \n        justify-content: center; \n        flex-shrink: 0; \n        color: inherit; \n        font-size: 18px; \n        line-height: 1; \n        background: transparent; \n        border: none; \n      }\n      .message-avatar.user { background: transparent; }\n      .message-avatar.agent { background: transparent; }\n      \n      .message.system {\n        background: ").concat(p.systemBackgroundColor,";\n        align-self: flex-start;\n      }\n      .message.error {\n        background: ").concat(p.errorBackgroundColor,";\n        align-self: flex-start;\n      }\n      \n      .input-container {\n        display: flex;\n        gap: 8px;\n        padding: 12px 16px;\n        background: #FFFFFF;\n        border-top: 1px solid #E5E7EB;\n        align-items: center;\n        flex-shrink: 0;\n        flex-direction: ").concat("rtl"===this.config.direction?"row-reverse":"row",";\n      }\n      \n      .input-wrapper {\n        position: relative;\n        display: flex;\n        align-items: center;\n      }\n      \n      .message-input {\n        width: 100%;\n        min-height: 32px;\n        max-height: 120px;\n        padding: ").concat(k,";\n        border: 1px solid ").concat(y,";\n        border-radius: ").concat(S,"px;\n        font-size: ").concat(w,";\n        font-family: inherit;\n        line-height: 1.3;\n        resize: none;\n        overflow-y: auto;\n        background: ").concat(b,";\n        color: ").concat(x,";\n        vertical-align: top;\n        margin: 0;\n        display: block;\n        white-space: pre-wrap;\n        word-wrap: break-word;\n        text-align: ").concat("rtl"===this.config.direction?"right":"left",";\n        direction: ").concat(this.config.direction||"ltr",";\n        -webkit-appearance: none;\n        appearance: none;\n        box-sizing: border-box;\n      }\n      \n      .message-input:focus {\n        outline: none;\n        border-color: ").concat(m,";\n        background: ").concat("#FFFFFF"===b?"#FFFFFF":b,";\n        box-shadow: 0 0 0 3px ").concat(m,"33;\n      }\n      \n      .message-input::placeholder {\n        color: #9CA3AF;\n        text-align: ").concat("rtl"===this.config.direction?"right":"left",";\n      }\n      \n      .send-button {\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        border: none;\n        background: ").concat(v,";\n        color: ").concat(g,";\n        font-size: ").concat(this.config.sendButtonFontSize||(null===(d=this.config.panel)||void 0===d?void 0:d.sendButtonFontSize)||"18px",";\n        font-weight: ").concat(this.config.sendButtonFontWeight||(null===(f=this.config.panel)||void 0===f?void 0:f.sendButtonFontWeight)||"500",";\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        transition: all 0.2s ease;\n        box-shadow: 0 4px 12px rgba(124, 60, 237, 0.3);\n      }\n      \n      .send-button:hover:not(:disabled) {\n        background: ").concat(h,";\n        transform: scale(1.05);\n        box-shadow: 0 6px 16px rgba(124, 60, 237, 0.4);\n      }\n      \n      .send-button-hint {\n        width: 100%;\n        text-align: center;\n        margin-top: 4px;\n      }\n      \n      .send-button:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n      \n      .typing-indicator {\n        display: inline-flex;\n        gap: 4px;\n        align-items: center;\n      }\n      \n      .typing-dot {\n        width: 6px;\n        height: 6px;\n        border-radius: 50%;\n        background: #64748b;\n        animation: typingDot 1.4s ease-in-out infinite;\n      }\n      \n      .typing-dot:nth-child(2) { animation-delay: 0.2s; }\n      .typing-dot:nth-child(3) { animation-delay: 0.4s; }\n      \n      @keyframes typingDot {\n        0%, 60%, 100% { transform: translateY(0); opacity: 0.7; }\n        30% { transform: translateY(-8px); opacity: 1; }\n      }\n      \n      .error-message {\n        padding: 12px;\n        background: ").concat(p.errorBackgroundColor,";\n        border-radius: ").concat(p.borderRadius,"px;\n        color: #991B1B;\n        font-size: ").concat(p.fontSize,";\n        margin: 8px 0;\n      }\n      \n      @media (max-width: 768px) {\n        #messagesContainer {\n          padding: 12px;\n          gap: 12px;\n        }\n        \n        .message-bubble {\n          max-width: 85%;\n          font-size: 14px;\n          padding: 10px;\n        }\n        \n        .text-input-container {\n          padding: 10px;\n          gap: 8px;\n        }\n        \n        #text-chat-input {\n          font-size: 16px !important; /* Prevents iOS zoom on focus */\n          padding: 10px 14px;\n          min-height: 44px;\n        }\n        \n        #text-chat-send {\n          min-width: 56px;\n          min-height: 44px;\n          width: 56px;\n          height: 44px;\n        }\n        \n        .empty-state-icon {\n          font-size: 40px;\n        }\n        \n        .empty-state-title {\n          font-size: 18px;\n        }\n        \n        .empty-state-text {\n          font-size: 12px;\n        }\n      }\n      \n      @media (max-width: 480px) {\n        #messagesContainer {\n          padding: 10px;\n          gap: 10px;\n        }\n        \n        .message-bubble {\n          max-width: 90%;\n          font-size: 13px;\n          padding: 8px;\n        }\n        \n        .text-input-container {\n          padding: 8px;\n        }\n        \n        #text-chat-input {\n          font-size: 16px !important;\n          padding: 8px 12px;\n        }\n      }\n    ")}},{key:"setupEventHandlers",value:function(){var t=this,n=document.getElementById("sendButton"),e=document.getElementById("messageInput"),o=document.getElementById("newChatBtn");if(n&&(n.onclick=function(){return t.sendMessage()}),o&&(o.onclick=function(){return t.startNewChat()}),this.updateInputAttributes(),e){e.style.height="32px",e.style.overflow="hidden";var i=function(){e.style.height="auto";var t=Math.min(e.scrollHeight,120);e.style.height=t+"px",e.style.overflowY=t>=120?"auto":"hidden",t>=120&&setTimeout(function(){e.scrollTop=e.scrollHeight},0)};e.addEventListener("input",i),e.addEventListener("keydown",function(n){"Enter"!==n.key||n.shiftKey?"Enter"===n.key&&n.shiftKey&&setTimeout(i,0):(n.preventDefault(),t.sendMessage())})}}},{key:"startNewChat",value:function(){try{localStorage.removeItem("ttp_text_chat_conversation_id")}catch(t){}this.sdk&&(this.sdk.config.conversationId=null);var t=document.getElementById("messagesContainer");t&&(t.innerHTML='\n        <div class="empty-state">\n          <div class="empty-state-icon">ðŸ’¬</div>\n          <div class="empty-state-title">'.concat(this.t("hello"),'</div>\n          <div class="empty-state-text">').concat(this.t("sendMessage"),"</div>\n        </div>"));var n=document.getElementById("messageInput");n&&n.focus()}},{key:"updateInputAttributes",value:function(){var t=document.getElementById("messageInput");if(t){var n,e=this.config.inputPlaceholder||(null===(n=this.config.panel)||void 0===n?void 0:n.inputPlaceholder)||this.t("typeMessage")||"Type your message...";t.placeholder=e,t.dir=this.config.direction||"ltr",t.style.textAlign="rtl"===this.config.direction?"right":"left"}}},{key:"show",value:function(){var t=document.getElementById("textInterface");t&&t.classList.add("active"),setTimeout(function(){var t=document.getElementById("messageInput");t&&t.focus()},50)}},{key:"hide",value:function(){var t=document.getElementById("textInterface");t&&t.classList.remove("active")}},{key:"startChat",value:(o=hn(fn().m(function t(){return fn().w(function(t){for(;;)switch(t.n){case 0:this.isActive=!0,this.updateSendButtonState();case 1:return t.a(2)}},t,this)})),function(){return o.apply(this,arguments)})},{key:"sendMessage",value:(e=hn(fn().m(function t(){var n,e,o;return fn().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n=document.getElementById("messageInput"),e=n.value.trim()){t.n=1;break}return t.a(2);case 1:if(this.isActive){t.n=2;break}return t.n=2,this.startChat();case 2:return this.addMessage("user",e),n.value="",n.style.height="32px",n.style.overflow="hidden",t.p=3,this.beginStreaming(),t.n=4,this.sdk.sendMessage(e);case 4:t.n=6;break;case 5:t.p=5,o=t.v,console.error("âŒ Failed to send message:",o),this.showError(o.message),this.stopStreamingState();case 6:return t.a(2)}},t,this,[[3,5]])})),function(){return e.apply(this,arguments)})},{key:"updateSendButtonState",value:function(){var t=document.getElementById("sendButton");t&&(t.disabled=!this.isActive)}},{key:"addMessage",value:function(t,n){var e=document.getElementById("messagesContainer");if(e){var o=e.querySelector(".empty-state");o&&o.remove();var i=document.createElement("div"),r="rtl"===this.config.direction?"user"===t?"edge-left":"edge-right":"user"===t?"edge-right":"edge-left";i.className="message ".concat(t," ").concat(r);var a=document.createElement("div");a.className="message-avatar ".concat(t),a.textContent="user"===t?"ðŸ‘¤":"ðŸ¤–";var c=document.createElement("div");c.className="message-bubble",c.textContent=n,i.appendChild(a),i.appendChild(c),e.appendChild(i),e.scrollTop=e.scrollHeight}}},{key:"beginStreaming",value:function(){var t=document.getElementById("messagesContainer");if(t){this.stopStreamingState();var n=document.createElement("div"),e="rtl"===this.config.direction?"edge-right":"edge-left";n.className="message agent ".concat(e),n.id="agent-streaming";var o=document.createElement("div");o.className="message-avatar agent",o.textContent="ðŸ¤–";var i=document.createElement("div");i.className="message-bubble",i.innerHTML='<span class="typing-indicator"><span class="typing-dot"></span><span class="typing-dot"></span><span class="typing-dot"></span></span>',n.appendChild(o),n.appendChild(i),t.appendChild(n),this.streamingEl=i,this.hasStartedStreaming=!1,t.scrollTop=t.scrollHeight}}},{key:"appendStreamingChunk",value:function(t){if(this.streamingEl){this.hasStartedStreaming||(this.streamingEl.textContent="",this.hasStartedStreaming=!0),this.streamingEl.textContent+=t;var n=document.getElementById("messagesContainer");n&&(n.scrollTop=n.scrollHeight)}}},{key:"finalizeStreaming",value:function(t){if(this.streamingEl){this.streamingEl.textContent=t||this.streamingEl.textContent;var n=document.getElementById("agent-streaming");n&&(n.id=""),this.streamingEl=null}this.updateSendButtonState()}},{key:"stopStreamingState",value:function(){var t=document.getElementById("agent-streaming");t&&t.remove(),this.streamingEl=null,this.hasStartedStreaming=!1}},{key:"showError",value:function(t){var n=document.getElementById("messagesContainer");if(n){var e=document.createElement("div");e.className="error-message",e.textContent=t,n.appendChild(e),n.scrollTop=n.scrollHeight}}},{key:"setActive",value:function(t){this.isActive=t,this.updateSendButtonState()}}],n&&gn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o}();const bn={en:{landingTitle:"How would you like to communicate?",voiceCall:"Voice Call",textChat:"Text Chat",clickToStartCall:"Click to Start Call",realTimeVoice:"Real-time voice conversation",startCall:"Start Call",listening:"Listening...",speakFreely:"Speak freely",liveTranscript:"Live Transcript",transcriptWillAppear:"Transcript will appear here during the call...",mute:"Mute",speaker:"Speaker",endCall:"End Call",hello:"Hello! How can I help?",sendMessage:"Send a message to get started",online:"Online",newChat:"New Chat",back:"Back",close:"Close",error:"Error",typeMessage:"Type your message...",sendMessageAria:"Send message"},he:{landingTitle:"××™×š ×ª×¨×¦×” ×œ×ª×§×©×¨?",voiceCall:"×©×™×—×” ×§×•×œ×™×ª",textChat:"×¦'××˜ ×˜×§×¡×˜",clickToStartCall:"×œ×—×¥ ×œ×”×ª×—×œ×ª ×©×™×—×”",realTimeVoice:"×©×™×—×” ×§×•×œ×™×ª ×‘×–×ž×Ÿ ××ž×ª",startCall:"×”×ª×—×œ ×©×™×—×”",listening:"×ž×§×©×™×‘...",speakFreely:"×“×‘×¨ ×‘×—×•×¤×©×™×•×ª",liveTranscript:"×ª×ž×œ×•×œ ×‘×–×ž×Ÿ ××ž×ª",transcriptWillAppear:"×”×ª×ž×œ×•×œ ×™×•×¤×™×¢ ×›××Ÿ ×‘×ž×”×œ×š ×”×©×™×—×”...",mute:"×”×©×ª×§",speaker:"×¨×ž×§×•×œ",endCall:"×¡×™×™× ×©×™×—×”",hello:"×©×œ×•×! ××™×š ××¤×©×¨ ×œ×¢×–×•×¨?",sendMessage:"×©×œ×— ×”×•×“×¢×” ××• ×¢×‘×•×¨ ×œ×ž×¦×‘ ×§×•×œ×™ ×œ×©×™×—×” ×‘×–×ž×Ÿ ××ž×ª",online:"×ž×§×•×•×Ÿ",newChat:"×¦'××˜ ×—×“×©",back:"×—×–×•×¨",close:"×¡×’×•×¨",error:"×©×’×™××”",typeMessage:"×”×§×œ×“ ×”×•×“×¢×”...",sendMessageAria:"×©×œ×— ×”×•×“×¢×”"},ar:{landingTitle:"ÙƒÙŠÙ ØªØ±ÙŠØ¯ Ø§Ù„ØªÙˆØ§ØµÙ„ØŸ",voiceCall:"Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ©",textChat:"Ø¯Ø±Ø¯Ø´Ø© Ù†ØµÙŠØ©",clickToStartCall:"Ø§Ù†Ù‚Ø± Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©",realTimeVoice:"Ù…Ø­Ø§Ø¯Ø«Ø© ØµÙˆØªÙŠØ© ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„ÙØ¹Ù„ÙŠ",startCall:"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©",listening:"Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹...",speakFreely:"ØªÙƒÙ„Ù… Ø¨Ø­Ø±ÙŠØ©",liveTranscript:"Ù†Øµ Ù…Ø¨Ø§Ø´Ø±",transcriptWillAppear:"Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„Ù†Øµ Ù‡Ù†Ø§ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©...",mute:"ÙƒØªÙ… Ø§Ù„ØµÙˆØª",speaker:"Ù…ÙƒØ¨Ø± Ø§Ù„ØµÙˆØª",endCall:"Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©",hello:"Ù…Ø±Ø­Ø¨Ø§! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©ØŸ",sendMessage:"Ø£Ø±Ø³Ù„ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø¨Ø¯Ø¡",online:"Ù…ØªØµÙ„",newChat:"Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©",back:"Ø±Ø¬ÙˆØ¹",close:"Ø¥ØºÙ„Ø§Ù‚",error:"Ø®Ø·Ø£",typeMessage:"Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©...",sendMessageAria:"Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©"},ru:{landingTitle:"ÐšÐ°Ðº Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¾Ð±Ñ‰Ð°Ñ‚ÑŒÑÑ?",voiceCall:"Ð“Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ð·Ð²Ð¾Ð½Ð¾Ðº",textChat:"Ð¢ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ‡Ð°Ñ‚",clickToStartCall:"ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð²Ð¾Ð½Ð¾Ðº",realTimeVoice:"Ð“Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð¹ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸",startCall:"ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð²Ð¾Ð½Ð¾Ðº",listening:"Ð¡Ð»ÑƒÑˆÐ°ÑŽ...",speakFreely:"Ð“Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾",liveTranscript:"Ð–Ð¸Ð²Ð°Ñ Ñ‚Ñ€Ð°Ð½ÑÐºÑ€Ð¸Ð¿Ñ†Ð¸Ñ",transcriptWillAppear:"Ð¢Ñ€Ð°Ð½ÑÐºÑ€Ð¸Ð¿Ñ†Ð¸Ñ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑÑ Ð·Ð´ÐµÑÑŒ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð·Ð²Ð¾Ð½ÐºÐ°...",mute:"ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð·Ð²ÑƒÐº",speaker:"Ð”Ð¸Ð½Ð°Ð¼Ð¸Ðº",endCall:"Ð—Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ Ð·Ð²Ð¾Ð½Ð¾Ðº",hello:"ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐšÐ°Ðº Ñ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?",sendMessage:"ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð½Ð°Ñ‡Ð°Ð»Ð°",online:"Ð’ ÑÐµÑ‚Ð¸",newChat:"ÐÐ¾Ð²Ñ‹Ð¹ Ñ‡Ð°Ñ‚",back:"ÐÐ°Ð·Ð°Ð´",close:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",error:"ÐžÑˆÐ¸Ð±ÐºÐ°",typeMessage:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ...",sendMessageAria:"ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ"},es:{landingTitle:"Â¿CÃ³mo te gustarÃ­a comunicarte?",voiceCall:"Llamada de voz",textChat:"Chat de texto",clickToStartCall:"Haz clic para iniciar la llamada",realTimeVoice:"ConversaciÃ³n de voz en tiempo real",startCall:"Iniciar llamada",listening:"Escuchando...",speakFreely:"Habla libremente",liveTranscript:"TranscripciÃ³n en vivo",transcriptWillAppear:"La transcripciÃ³n aparecerÃ¡ aquÃ­ durante la llamada...",mute:"Silenciar",speaker:"Altavoz",endCall:"Terminar llamada",hello:"Â¡Hola! Â¿CÃ³mo puedo ayudarte?",sendMessage:"EnvÃ­a un mensaje para comenzar",online:"En lÃ­nea",newChat:"Nuevo chat",back:"AtrÃ¡s",close:"Cerrar",error:"Error",typeMessage:"Escribe un mensaje...",sendMessageAria:"Enviar mensaje"},fr:{landingTitle:"Comment souhaitez-vous communiquer?",voiceCall:"Appel vocal",textChat:"Chat texte",clickToStartCall:"Cliquez pour dÃ©marrer l'appel",realTimeVoice:"Conversation vocale en temps rÃ©el",startCall:"DÃ©marrer l'appel",listening:"Ã‰coute...",speakFreely:"Parlez librement",liveTranscript:"TranscripciÃ³n en direct",transcriptWillAppear:"La transcription apparaÃ®tra ici pendant l'appel...",mute:"Muet",speaker:"Haut-parleur",endCall:"Terminer l'appel",hello:"Bonjour! Comment puis-je vous aider?",sendMessage:"Envoyez un message pour commencer",online:"En ligne",newChat:"Nouveau chat",back:"Retour",close:"Fermer",error:"Erreur",typeMessage:"Tapez votre message...",sendMessageAria:"Envoyer un message"},de:{landingTitle:"Wie mÃ¶chten Sie kommunizieren?",voiceCall:"Sprachanruf",textChat:"Text-Chat",clickToStartCall:"Klicken Sie, um den Anruf zu starten",realTimeVoice:"Sprachanruf in Echtzeit",startCall:"Anruf starten",listening:"HÃ¶ren...",speakFreely:"Sprechen Sie frei",liveTranscript:"Live-Transkription",transcriptWillAppear:"Die Transkription erscheint hier wÃ¤hrend des Anrufs...",mute:"Stumm",speaker:"Lautsprecher",endCall:"Anruf beenden",hello:"Hallo! Wie kann ich helfen?",sendMessage:"Senden Sie eine Nachricht zum Starten",online:"Online",newChat:"Neuer Chat",back:"ZurÃ¼ck",close:"SchlieÃŸen",error:"Fehler",typeMessage:"Geben Sie eine Nachricht ein...",sendMessageAria:"Nachricht senden"}};function xn(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return wn(l,"_invoke",function(e,o,i){var r,c,s,l=0,u=i||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return r=n,c=0,s=t,f.n=e,a}};function p(e,o){for(c=e,s=o,n=0;!d&&l&&!i&&n<u.length;n++){var i,r=u[n],p=f.p,v=r[2];e>3?(i=v===o)&&(s=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=p&&((i=e<2&&p<r[1])?(c=0,f.v=o,f.n=r[1]):p<v&&(i=e<3||r[0]>o||o>v)&&(r[4]=e,r[5]=o,f.n=v,c=0))}if(i||e>1)return a;throw d=!0,o}return function(i,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),c=u,s=v;(n=c<2?t:s)||!d;){r||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(d=f.n<0)?s:e.call(o,f))!==a)break}catch(n){r=t,c=1,s=n}finally{l=1}}return{value:n,done:d}}}(e,i,r),!0),l}var a={};function c(){}function s(){}function l(){}n=Object.getPrototypeOf;var u=[][o]?n(n([][o]())):(wn(n={},o,function(){return this}),n),d=l.prototype=c.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,wn(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,wn(d,"constructor",l),wn(l,"constructor",s),s.displayName="GeneratorFunction",wn(l,i,"GeneratorFunction"),wn(d),wn(d,i,"Generator"),wn(d,o,function(){return this}),wn(d,"toString",function(){return"[object Generator]"}),(xn=function(){return{w:r,m:f}})()}function wn(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}wn=function(t,n,e,o){function r(n,e){wn(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},wn(t,n,e,o)}function Sn(t,n,e,o,i,r,a){try{var c=t[r](a),s=c.value}catch(t){return void e(t)}c.done?n(s):Promise.resolve(s).then(o,i)}function kn(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){Sn(r,o,i,a,c,"next",t)}function c(t){Sn(r,o,i,a,c,"throw",t)}a(void 0)})}}function Cn(t){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cn(t)}function On(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function In(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?On(Object(e),!0).forEach(function(n){jn(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):On(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function jn(t,n,e){return(n=Bn(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function Pn(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Bn(o.key),o)}}function Bn(t){var n=function(t){if("object"!=Cn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=Cn(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Cn(n)?n:n+""}var En=function(){return t=function t(){var n,e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=this.mergeWithDefaults(o),this.sdk=new Ot(this.config),this.isOpen=!1,this.isActive=!1,this.translations=bn;var i=In(In(In({},this.config),this.config.voice),{},{language:(null===(n=this.config.voice)||void 0===n?void 0:n.language)||this.config.language||"en",websocketUrl:(null===(e=this.config.voice)||void 0===e?void 0:e.websocketUrl)||this.config.websocketUrl||"wss://speech.talktopc.com/ws/conv",translations:this.translations});this.voiceInterface=new un(i);var r=In(In(In({},this.config),this.config.text),{},{translations:this.translations});if(this.textInterface=new mn(r,this.sdk),this.setupEventHandlers(),this.createWidget(),this.config.behavior.startOpen||this.config.behavior.autoOpen){var a=document.getElementById("text-chat-panel");a&&(this.isOpen=!0,a.classList.add("open"))}},n=[{key:"mergeWithDefaults",value:function(t){var n,e,o,i,r,a,c,s,l,u,d,f,p,v,h,g,y,m,b,x,w,S,k,C,O,I,j,P,B,E,T,F,A,D,_,R,M,z,L,H,U,K,G,W,N,V,Q,q,Y,J,$,X,Z,tt,nt,et,ot,it,rt,at,ct,st,lt,ut,dt,ft,pt,vt,ht,gt,yt,mt,bt,xt,wt,St,kt,Ct,Ot,It,jt,Pt,Bt,Et,Tt,Ft,At,Dt,_t,Rt,Mt,zt,Lt,Ht,Ut,Kt,Gt,Wt,Nt,Vt,Qt,qt,Yt,Jt,$t,Xt,Zt,tn,nn,en,on,rn,an,cn,sn,ln,un,dn,fn,pn,vn,hn,gn,yn,mn,bn,xn,wn,Sn,kn,On,jn,Pn,Bn,En=t.position||"bottom-right";if("string"==typeof En){var Tn=En.split("-");En={vertical:Tn[0]||"bottom",horizontal:Tn[1]||"right",offset:t.positionOffset||{x:20,y:20}}}var Fn=t.primaryColor||(null===(n=t.button)||void 0===n?void 0:n.primaryColor)||(null===(e=t.button)||void 0===e?void 0:e.backgroundColor)||"#7C3AED",An=(null===(o=t.header)||void 0===o?void 0:o.backgroundColor)||(null===(i=t.button)||void 0===i?void 0:i.backgroundColor)||Fn;return In({agentId:t.agentId,appId:t.appId,getSessionUrl:t.getSessionUrl,websocketUrl:t.websocketUrl,demo:!1!==t.demo,direction:t.direction||"ltr",language:t.language||"en",icon:In({type:(null===(r=t.icon)||void 0===r?void 0:r.type)||"custom",customImage:(null===(a=t.icon)||void 0===a?void 0:a.customImage)||"https://talktopc.com/logo192.png",emoji:(null===(c=t.icon)||void 0===c?void 0:c.emoji)||"ðŸŽ¤",text:(null===(s=t.icon)||void 0===s?void 0:s.text)||"AI",size:(null===(l=t.icon)||void 0===l?void 0:l.size)||"medium",backgroundColor:(null===(u=t.icon)||void 0===u?void 0:u.backgroundColor)||"#FFFFFF"},t.icon),position:In({vertical:En.vertical||"bottom",horizontal:En.horizontal||"right",offset:En.offset||{x:20,y:20}},"object"===Cn(t.position)?t.position:{}),button:In({size:(null===(d=t.button)||void 0===d?void 0:d.size)||"medium",shape:(null===(f=t.button)||void 0===f?void 0:f.shape)||"circle",backgroundColor:(null===(p=t.button)||void 0===p?void 0:p.backgroundColor)||(null===(v=t.icon)||void 0===v?void 0:v.backgroundColor)||Fn,hoverColor:(null===(h=t.button)||void 0===h?void 0:h.hoverColor)||"#7C3AED",shadow:!1!==(null===(g=t.button)||void 0===g?void 0:g.shadow),shadowColor:(null===(y=t.button)||void 0===y?void 0:y.shadowColor)||"rgba(0,0,0,0.15)",primaryColor:(null===(m=t.button)||void 0===m?void 0:m.backgroundColor)||(null===(b=t.icon)||void 0===b?void 0:b.backgroundColor)||Fn},t.button),panel:In({width:(null===(x=t.panel)||void 0===x?void 0:x.width)||350,height:(null===(w=t.panel)||void 0===w?void 0:w.height)||500,borderRadius:(null===(S=t.panel)||void 0===S?void 0:S.borderRadius)||12,backgroundColor:(null===(k=t.panel)||void 0===k?void 0:k.backgroundColor)||"#FFFFFF",backdropFilter:(null===(C=t.panel)||void 0===C?void 0:C.backdropFilter)||null,border:(null===(O=t.panel)||void 0===O?void 0:O.border)||"1px solid rgba(0,0,0,0.1)"},t.panel),voice:In({micButtonColor:(null===(I=t.voice)||void 0===I?void 0:I.micButtonColor)||(null===(j=t.panel)||void 0===j?void 0:j.micButtonColor)||Fn,micButtonActiveColor:(null===(P=t.voice)||void 0===P?void 0:P.micButtonActiveColor)||(null===(B=t.panel)||void 0===B?void 0:B.micButtonActiveColor)||"#EF4444",micButtonHint:In(In({text:(null===(E=t.voice)||void 0===E||null===(E=E.micButtonHint)||void 0===E?void 0:E.text)||(null===(T=t.panel)||void 0===T||null===(T=T.micButtonHint)||void 0===T?void 0:T.text)||"Click the button to start voice conversation",color:(null===(F=t.voice)||void 0===F||null===(F=F.micButtonHint)||void 0===F?void 0:F.color)||(null===(A=t.panel)||void 0===A||null===(A=A.micButtonHint)||void 0===A?void 0:A.color)||"#6B7280",fontSize:(null===(D=t.voice)||void 0===D||null===(D=D.micButtonHint)||void 0===D?void 0:D.fontSize)||(null===(_=t.panel)||void 0===_||null===(_=_.micButtonHint)||void 0===_?void 0:_.fontSize)||"12px"},null===(R=t.voice)||void 0===R?void 0:R.micButtonHint),null===(M=t.panel)||void 0===M?void 0:M.micButtonHint),avatarBackgroundColor:(null===(z=t.voice)||void 0===z?void 0:z.avatarBackgroundColor)||"#667eea",avatarActiveBackgroundColor:(null===(L=t.voice)||void 0===L?void 0:L.avatarActiveBackgroundColor)||"#667eea",statusTitleColor:(null===(H=t.voice)||void 0===H?void 0:H.statusTitleColor)||"#1e293b",statusSubtitleColor:(null===(U=t.voice)||void 0===U?void 0:U.statusSubtitleColor)||"#64748b",startCallButtonColor:(null===(K=t.voice)||void 0===K?void 0:K.startCallButtonColor)||"#667eea",startCallButtonTextColor:(null===(G=t.voice)||void 0===G?void 0:G.startCallButtonTextColor)||"#FFFFFF",transcriptBackgroundColor:(null===(W=t.voice)||void 0===W?void 0:W.transcriptBackgroundColor)||"#FFFFFF",transcriptTextColor:(null===(N=t.voice)||void 0===N?void 0:N.transcriptTextColor)||"#1e293b",transcriptLabelColor:(null===(V=t.voice)||void 0===V?void 0:V.transcriptLabelColor)||"#94a3b8",controlButtonColor:(null===(Q=t.voice)||void 0===Q?void 0:Q.controlButtonColor)||"#FFFFFF",controlButtonSecondaryColor:(null===(q=t.voice)||void 0===q?void 0:q.controlButtonSecondaryColor)||"#64748b",endCallButtonColor:(null===(Y=t.voice)||void 0===Y?void 0:Y.endCallButtonColor)||"#ef4444",language:(null===(J=t.voice)||void 0===J?void 0:J.language)||t.language||"en",websocketUrl:(null===($=t.voice)||void 0===$?void 0:$.websocketUrl)||t.websocketUrl},t.voice),text:In({sendButtonColor:(null===(X=t.text)||void 0===X?void 0:X.sendButtonColor)||(null===(Z=t.panel)||void 0===Z?void 0:Z.sendButtonColor)||"#7C3AED",sendButtonHoverColor:(null===(tt=t.text)||void 0===tt?void 0:tt.sendButtonHoverColor)||(null===(nt=t.panel)||void 0===nt?void 0:nt.sendButtonHoverColor)||"#6D28D9",sendButtonActiveColor:(null===(et=t.text)||void 0===et?void 0:et.sendButtonActiveColor)||(null===(ot=t.panel)||void 0===ot?void 0:ot.sendButtonActiveColor)||"#6D28D9",sendButtonText:(null===(it=t.text)||void 0===it?void 0:it.sendButtonText)||(null===(rt=t.panel)||void 0===rt?void 0:rt.sendButtonText)||"âž¤",sendButtonTextColor:(null===(at=t.text)||void 0===at?void 0:at.sendButtonTextColor)||(null===(ct=t.panel)||void 0===ct?void 0:ct.sendButtonTextColor)||"#FFFFFF",sendButtonFontSize:(null===(st=t.text)||void 0===st?void 0:st.sendButtonFontSize)||(null===(lt=t.panel)||void 0===lt?void 0:lt.sendButtonFontSize)||"18px",sendButtonFontWeight:(null===(ut=t.text)||void 0===ut?void 0:ut.sendButtonFontWeight)||(null===(dt=t.panel)||void 0===dt?void 0:dt.sendButtonFontWeight)||"500",sendButtonHint:In(In({text:(null===(ft=t.text)||void 0===ft||null===(ft=ft.sendButtonHint)||void 0===ft?void 0:ft.text)||(null===(pt=t.panel)||void 0===pt||null===(pt=pt.sendButtonHint)||void 0===pt?void 0:pt.text)||"",color:(null===(vt=t.text)||void 0===vt||null===(vt=vt.sendButtonHint)||void 0===vt?void 0:vt.color)||(null===(ht=t.panel)||void 0===ht||null===(ht=ht.sendButtonHint)||void 0===ht?void 0:ht.color)||"#6B7280",fontSize:(null===(gt=t.text)||void 0===gt||null===(gt=gt.sendButtonHint)||void 0===gt?void 0:gt.fontSize)||(null===(yt=t.panel)||void 0===yt||null===(yt=yt.sendButtonHint)||void 0===yt?void 0:yt.fontSize)||"12px"},null===(mt=t.text)||void 0===mt?void 0:mt.sendButtonHint),null===(bt=t.panel)||void 0===bt?void 0:bt.sendButtonHint),inputPlaceholder:(null===(xt=t.text)||void 0===xt?void 0:xt.inputPlaceholder)||(null===(wt=t.panel)||void 0===wt?void 0:wt.inputPlaceholder)||"Type your message...",inputBorderColor:(null===(St=t.text)||void 0===St?void 0:St.inputBorderColor)||(null===(kt=t.panel)||void 0===kt?void 0:kt.inputBorderColor)||"#E5E7EB",inputFocusColor:(null===(Ct=t.text)||void 0===Ct?void 0:Ct.inputFocusColor)||(null===(Ot=t.panel)||void 0===Ot?void 0:Ot.inputFocusColor)||"#7C3AED",inputBackgroundColor:(null===(It=t.text)||void 0===It?void 0:It.inputBackgroundColor)||(null===(jt=t.panel)||void 0===jt?void 0:jt.inputBackgroundColor)||"#FFFFFF",inputTextColor:(null===(Pt=t.text)||void 0===Pt?void 0:Pt.inputTextColor)||(null===(Bt=t.panel)||void 0===Bt?void 0:Bt.inputTextColor)||"#1F2937",inputFontSize:(null===(Et=t.text)||void 0===Et?void 0:Et.inputFontSize)||(null===(Tt=t.panel)||void 0===Tt?void 0:Tt.inputFontSize)||"14px",inputBorderRadius:(null===(Ft=t.text)||void 0===Ft?void 0:Ft.inputBorderRadius)||(null===(At=t.panel)||void 0===At?void 0:At.inputBorderRadius)||20,inputPadding:(null===(Dt=t.text)||void 0===Dt?void 0:Dt.inputPadding)||(null===(_t=t.panel)||void 0===_t?void 0:_t.inputPadding)||"6px 14px"},t.text),landing:In({backgroundColor:(null===(Rt=t.landing)||void 0===Rt?void 0:Rt.backgroundColor)||"linear-gradient(180deg, #f8fafc 0%, #e0e7ff 100%)",logo:(null===(Mt=t.landing)||void 0===Mt?void 0:Mt.logo)||"ðŸ¤–",title:(null===(zt=t.landing)||void 0===zt?void 0:zt.title)||null,titleColor:(null===(Lt=t.landing)||void 0===Lt?void 0:Lt.titleColor)||"#1e293b",modeCardBackgroundColor:(null===(Ht=t.landing)||void 0===Ht?void 0:Ht.modeCardBackgroundColor)||"#FFFFFF",modeCardBorderColor:(null===(Ut=t.landing)||void 0===Ut?void 0:Ut.modeCardBorderColor)||"#E2E8F0",modeCardHoverBorderColor:(null===(Kt=t.landing)||void 0===Kt?void 0:Kt.modeCardHoverBorderColor)||An,modeCardIconBackgroundColor:(null===(Gt=t.landing)||void 0===Gt?void 0:Gt.modeCardIconBackgroundColor)||An,modeCardTitleColor:(null===(Wt=t.landing)||void 0===Wt?void 0:Wt.modeCardTitleColor)||"#111827",voiceCardIcon:(null===(Nt=t.landing)||void 0===Nt?void 0:Nt.voiceCardIcon)||"ðŸŽ¤",textCardIcon:(null===(Vt=t.landing)||void 0===Vt?void 0:Vt.textCardIcon)||"ðŸ’¬"},t.landing),header:In({title:(null===(Qt=t.header)||void 0===Qt?void 0:Qt.title)||"Chat Assistant",showTitle:!1!==(null===(qt=t.header)||void 0===qt?void 0:qt.showTitle),backgroundColor:(null===(Yt=t.header)||void 0===Yt?void 0:Yt.backgroundColor)||(null===(Jt=t.button)||void 0===Jt?void 0:Jt.backgroundColor)||"#7C3AED",textColor:(null===($t=t.header)||void 0===$t?void 0:$t.textColor)||"#FFFFFF",showCloseButton:!1!==(null===(Xt=t.header)||void 0===Xt?void 0:Xt.showCloseButton)},t.header),tooltips:In({newChat:(null===(Zt=t.tooltips)||void 0===Zt?void 0:Zt.newChat)||null,back:(null===(tn=t.tooltips)||void 0===tn?void 0:tn.back)||null,close:(null===(nn=t.tooltips)||void 0===nn?void 0:nn.close)||null,mute:(null===(en=t.tooltips)||void 0===en?void 0:en.mute)||null,speaker:(null===(on=t.tooltips)||void 0===on?void 0:on.speaker)||null,endCall:(null===(rn=t.tooltips)||void 0===rn?void 0:rn.endCall)||null},t.tooltips),messages:In({userBackgroundColor:(null===(an=t.messages)||void 0===an?void 0:an.userBackgroundColor)||"#E5E7EB",agentBackgroundColor:(null===(cn=t.messages)||void 0===cn?void 0:cn.agentBackgroundColor)||"#F3F4F6",systemBackgroundColor:(null===(sn=t.messages)||void 0===sn?void 0:sn.systemBackgroundColor)||"#DCFCE7",errorBackgroundColor:(null===(ln=t.messages)||void 0===ln?void 0:ln.errorBackgroundColor)||"#FEE2E2",textColor:(null===(un=t.messages)||void 0===un?void 0:un.textColor)||"#1F2937",fontSize:(null===(dn=t.messages)||void 0===dn?void 0:dn.fontSize)||"14px",borderRadius:(null===(fn=t.messages)||void 0===fn?void 0:fn.borderRadius)||8},t.messages),animation:In({enableHover:!1!==(null===(pn=t.animation)||void 0===pn?void 0:pn.enableHover),enablePulse:!1!==(null===(vn=t.animation)||void 0===vn?void 0:vn.enablePulse),enableSlide:!1!==(null===(hn=t.animation)||void 0===hn?void 0:hn.enableSlide),duration:(null===(gn=t.animation)||void 0===gn?void 0:gn.duration)||.3},t.animation),behavior:In({autoOpen:(null===(yn=t.behavior)||void 0===yn?void 0:yn.autoOpen)||!1,startOpen:(null===(mn=t.behavior)||void 0===mn?void 0:mn.startOpen)||!1,hidden:(null===(bn=t.behavior)||void 0===bn?void 0:bn.hidden)||!1,autoConnect:(null===(xn=t.behavior)||void 0===xn?void 0:xn.autoConnect)||!1,showWelcomeMessage:!1!==(null===(wn=t.behavior)||void 0===wn?void 0:wn.showWelcomeMessage),welcomeMessage:(null===(Sn=t.behavior)||void 0===Sn?void 0:Sn.welcomeMessage)||"Hello! How can I help you today?",enableVoiceMode:void 0===(null===(kn=t.behavior)||void 0===kn?void 0:kn.enableVoiceMode)||t.behavior.enableVoiceMode,mode:(null===(On=t.behavior)||void 0===On?void 0:On.mode)||"unified"},t.behavior),accessibility:In({ariaLabel:(null===(jn=t.accessibility)||void 0===jn?void 0:jn.ariaLabel)||"Chat Assistant",ariaDescription:(null===(Pn=t.accessibility)||void 0===Pn?void 0:Pn.ariaDescription)||"Click to open chat assistant",keyboardNavigation:!1!==(null===(Bn=t.accessibility)||void 0===Bn?void 0:Bn.keyboardNavigation)},t.accessibility),customStyles:t.customStyles||"",variables:t.variables||{},forceConversationId:t.forceConversationId,primaryColor:Fn},"string"==typeof t.position?{positionString:t.position}:{})}},{key:"setupEventHandlers",value:function(){var t=this;this.sdk.on("error",function(n){t.textInterface.showError(n.message||n),t.textInterface.stopStreamingState()}),this.sdk.on("chunk",function(n){t.textInterface.appendStreamingChunk(n)}),this.sdk.on("done",function(n){var e=n.text;t.textInterface.finalizeStreaming(e)})}},{key:"createWidget",value:function(){var t=document.createElement("div");if(t.id="text-chat-widget",t.innerHTML=this.generateWidgetHTML(),document.body.appendChild(t),this.setupWidgetEvents(),this.config.behavior.startOpen||this.config.behavior.autoOpen){var n=document.getElementById("text-chat-panel");n&&(this.isOpen=!0,n.classList.add("open"))}}},{key:"generateWidgetHTML",value:function(){var t=this,n=(this.config.position,this.config.button),e=this.config.icon,o=(this.config.panel,this.config.header),i=(this.config.animation,{small:50,medium:60,large:70,xl:80}[n.size]||60),r={small:20,medium:28,large:36,xl:44}[e.size]||28,a=this.generatePositionStyles(),c=this.generateIconHTML(r),s=this.config.behavior.mode||"unified",l="unified"===s,u="unified"===s||"voice-only"===s,d="unified"===s||"text-only"===s,f=function(n){var e=t.config.language||"en";return(t.translations[e]||t.translations.en)[n]||n},p=function(n){var e,o=null===(e=t.config.tooltips)||void 0===e?void 0:e[n];return null!=o?o:{newChat:f("newChat"),back:f("back"),close:f("close"),mute:f("mute"),speaker:f("speaker"),endCall:f("endCall")}[n]||""};return"\n      <style>\n        ".concat(this.generateCSS(a,i,r),"\n        ").concat(this.config.customStyles,"\n      </style>\n      \n      ").concat(this.config.behavior.hidden?"":'\n      <button id="text-chat-button" \n              aria-label="'.concat(this.config.accessibility.ariaLabel,'"\n              aria-description="').concat(this.config.accessibility.ariaDescription,'">\n        ').concat(c,"\n      </button>\n      "),'\n      \n      <div id="text-chat-panel">\n        <div class="widget-shell">\n          <div class="panel-inner widget-container" style="direction: ').concat(this.config.direction,';">\n          <div class="widget-header" style="background: ').concat(o.backgroundColor,"; color: ").concat(o.textColor,';">\n            <div>\n              ').concat(o.showTitle?'<div class="header-title">'.concat(o.title,"</div>"):"",'\n              <div class="header-status">\n                <span class="status-dot"></span>\n                <span>').concat(f("online"),'</span>\n              </div>\n            </div>\n            \n            <div style="display: flex; gap: 12px; align-items: center;">\n              \x3c!-- New Chat Button (hide on landing screen, show otherwise) --\x3e\n              <button class="header-icon new-chat-btn" id="newChatBtn" title="').concat(p("newChat"),'" style="').concat(l?"display: none;":"",'">\n                <span style="font-size: 18px; font-weight: bold;">+</span>\n              </button>\n              \n              \x3c!-- Back Button (only show in unified mode) --\x3e\n              ').concat("unified"===s?'<button class="header-icon back-btn" id="backBtn" title="'.concat(p("back"),'" style="display: none;">\n                <span style="font-size: 16px;">â€¹</span>\n              </button>'):"","\n              \n              \x3c!-- Close Button --\x3e\n              ").concat(o.showCloseButton?'<button class="header-icon close-btn" id="closeBtn" title="'+p("close")+'"><span style="font-size: 18px; font-weight: bold;">Ã—</span></button>':"","\n            </div>\n          </div>\n\n          ").concat(l?'\n          <div class="landing-screen" id="landingScreen">\n            <div class="landing-logo">ðŸ¤–</div>\n            <div class="landing-title">'.concat(f("landingTitle"),'</div>\n            <div class="mode-selection">\n              ').concat(u?'<div class="mode-card voice" id="mode-card-voice">\n                <div class="mode-card-icon">ðŸŽ¤</div>\n                <div class="mode-card-title">'.concat(f("voiceCall"),"</div>\n              </div>"):"","\n              ").concat(d?'<div class="mode-card text" id="mode-card-text">\n                <div class="mode-card-icon">ðŸ’¬</div>\n                <div class="mode-card-title">'.concat(f("textChat"),"</div>\n              </div>"):"","\n            </div>\n          </div>"):"","\n\n          ").concat(u?this.voiceInterface.generateHTML():"","\n          ").concat(d?this.textInterface.generateHTML():"","\n          </div>\n        </div>\n      </div>\n    ")}},{key:"generatePositionStyles",value:function(){var t=this.config.position,n=t.offset||{x:20,y:20},e="";return"top"===t.vertical?e+="top: ".concat(n.y,"px;"):"bottom"===t.vertical?e+="bottom: ".concat(n.y,"px;"):"center"===t.vertical&&(e+="top: 50%; transform: translateY(-50%);"),"left"===t.horizontal?e+="left: ".concat(n.x,"px;"):"right"===t.horizontal?e+="right: ".concat(n.x,"px;"):"center"===t.horizontal&&(e+="left: 50%; transform: translateX(-50%);"),e}},{key:"generateIconHTML",value:function(t){var n=this.config.icon;switch(n.type){case"custom":return'<img src="'.concat(n.customImage,'" alt="Chat Assistant" style="width: ').concat(t,"px; height: ").concat(t,'px; object-fit: contain;" />');case"emoji":return'<span style="font-size: '.concat(t,'px; line-height: 1;">').concat(n.emoji,"</span>");case"text":return'<span style="font-size: '.concat(Math.floor(.6*t),'px; font-weight: bold; color: white;">').concat(n.text,"</span>");case"microphone":default:return'<svg viewBox="0 0 24 24" style="width: '.concat(t,"px; height: ").concat(t,'px; fill: white;">\n          <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>\n          <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>\n        </svg>');case"chat":return'<svg viewBox="0 0 24 24" style="width: '.concat(t,"px; height: ").concat(t,'px; fill: white;">\n          <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>\n        </svg>')}}},{key:"generateCSS",value:function(t,n,e){var o,i,r,a,c,s,l,u=this.config.button,d=this.config.icon,f=this.config.panel,p=this.config.header,v=(this.config.messages,this.config.animation),h=this.config.behavior.mode||"unified",g="unified"===h||"voice-only"===h,y="unified"===h||"text-only"===h,m=p.backgroundColor;return'\n      /* MOBILE FIRST - Default styles for all devices */\n      #text-chat-widget {\n        position: fixed !important;\n        z-index: 10000;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n        /* Mobile defaults */\n        right: 10px;\n        bottom: 10px;\n        left: auto;\n        top: auto;\n      }\n      \n      /* Desktop positioning (only on larger screens) */\n      @media (min-width: 769px) {\n        #text-chat-widget {\n          '.concat(t,"\n          right: ").concat("right"===this.config.position.horizontal?"20px":"auto",";\n          left: ").concat("left"===this.config.position.horizontal?"20px":"auto",";\n          bottom: ").concat("bottom"===this.config.position.vertical?"20px":"auto",";\n          top: ").concat("top"===this.config.position.vertical?"20px":"auto",";\n        }\n      }\n      \n      /* Mobile override (force mobile positioning) */\n      @media (max-width: 768px) {\n        #text-chat-widget {\n          right: 10px !important;\n          bottom: 10px !important;\n          left: auto !important;\n          top: auto !important;\n          transform: none !important;\n        }\n      }\n      \n      @media (max-width: 480px) {\n        #text-chat-widget {\n          right: 8px !important;\n          bottom: 8px !important;\n          left: auto !important;\n          top: auto !important;\n        }\n      }\n      \n      #text-chat-button {\n        width: ").concat(n,"px;\n        height: ").concat(n,"px;\n        border-radius: ").concat("circle"===u.shape?"50%":"square"===u.shape?"0":"12px",";\n        background: ").concat(u.backgroundColor||d.backgroundColor||"#7C3AED",";\n        border: none;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all ").concat(v.duration,"s ease;\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n        touch-action: manipulation;\n        -webkit-tap-highlight-color: transparent;\n        -webkit-touch-callout: none;\n        user-select: none;\n        min-width: 44px;\n        min-height: 44px;\n      }\n      \n      @media (max-width: 768px) {\n        #text-chat-widget {\n          right: 10px !important;\n          bottom: 10px !important;\n          left: auto !important;\n          top: auto !important;\n          transform: none !important;\n        }\n        \n        #text-chat-button {\n          width: 56px !important;\n          height: 56px !important;\n          min-width: 56px !important;\n          min-height: 56px !important;\n          max-width: 56px !important;\n          max-height: 56px !important;\n        }\n        \n        #text-chat-panel {\n          position: fixed !important;\n          left: 10px !important;\n          right: 10px !important;\n          bottom: 76px !important; /* 56px button + 20px gap */\n          top: 60px !important; /* Add top spacing */\n          width: auto !important;\n          max-width: none !important;\n          height: auto !important; /* Change from max-height to auto */\n          max-height: none !important; /* Remove max-height */\n          transform: none !important;\n          margin: 0 !important;\n        }\n        \n        #text-chat-panel .widget-header {\n          padding: 10px 14px;\n          min-height: 56px;\n        }\n        \n        #text-chat-panel .header-title {\n          font-size: 15px;\n        }\n        \n        #text-chat-panel .header-icon {\n          width: 40px;\n          height: 40px;\n          min-width: 40px;\n          min-height: 40px;\n        }\n        \n        #text-chat-input {\n          font-size: 16px !important; /* Prevents iOS zoom on focus */\n          padding: 12px 16px !important;\n          min-height: 48px !important;\n        }\n        \n        #text-chat-send {\n          min-width: 48px !important;\n          min-height: 48px !important;\n          width: 48px !important;\n          height: 48px !important;\n        }\n        \n        .landing-screen {\n          padding: 16px;\n        }\n        \n        .landing-logo {\n          font-size: 40px;\n        }\n        \n        .landing-title {\n          font-size: 18px;\n          margin-bottom: 16px;\n        }\n        \n        .mode-selection {\n          flex-direction: column;\n          gap: 12px;\n          align-items: center;\n        }\n        \n        .mode-card {\n          max-width: 100%;\n          width: 100%;\n          padding: 16px;\n        }\n        \n        .mode-card-icon {\n          width: 50px;\n          height: 50px;\n          font-size: 28px;\n        }\n        \n        .mode-card-title {\n          font-size: 14px;\n        }\n      }\n      \n      @media (max-width: 480px) {\n        #text-chat-widget {\n          right: 8px !important;\n          bottom: 8px !important;\n          left: auto !important;\n          top: auto !important;\n        }\n        \n        #text-chat-button {\n          width: 54px !important;\n          height: 54px !important;\n          min-width: 54px !important;\n          min-height: 54px !important;\n        }\n        \n        #text-chat-panel {\n          left: 8px !important;\n          right: 8px !important;\n          bottom: 70px !important;\n          top: 50px !important; /* Add top spacing for very small screens */\n          height: auto !important;\n          max-height: none !important;\n        }\n        \n        #text-chat-panel .widget-header {\n          padding: 8px 12px;\n          min-height: 52px;\n        }\n        \n        #text-chat-panel .header-title {\n          font-size: 14px;\n        }\n        \n        .landing-logo {\n          font-size: 36px;\n        }\n        \n        .landing-title {\n          font-size: 16px;\n        }\n      }\n      \n      ").concat(v.enableHover?"\n        #text-chat-button:hover {\n          background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);\n          transform: scale(1.05);\n          box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);\n        }\n      ":"","\n      \n      #text-chat-panel {\n        display: none;\n        position: fixed;\n        bottom: calc(").concat(n,"px + 20px);\n        ").concat("right"===this.config.position.horizontal?"right: 20px;":"left: 20px;","\n        width: ").concat(f.width,"px;\n        max-width: calc(100vw - 40px);\n        height: ").concat(f.height,"px;\n        max-height: calc(100vh - ").concat(n,"px - 40px);\n        background: transparent;\n        border-radius: ").concat(f.borderRadius,"px;\n        border: none;\n        flex-direction: column;\n        overflow: hidden;\n        ").concat(f.backdropFilter?"backdrop-filter: ".concat(f.backdropFilter,";"):"","\n        ").concat(v.enableSlide?"transition: all ".concat(v.duration,"s ease;"):"","\n        box-sizing: border-box;\n      }\n      \n      #text-chat-panel.open {\n        display: flex;\n        ").concat(v.enableSlide?"transform: translateY(0); opacity: 1;":"","\n      }\n\n      /* Shell for gradient border/background */\n      .widget-shell { width: 100%; height: 100%; padding: 0; border-radius: ").concat(f.borderRadius,"px; background: transparent; box-shadow: 0 20px 60px rgba(0,0,0,0.15); overflow: hidden; display: flex; flex-direction: column; box-sizing: border-box; }\n      .panel-inner { width: 100%; height: 100%; background: #ffffff; border-radius: ").concat(f.borderRadius,"px; overflow: hidden; display:flex; flex-direction: column; padding: 0; box-sizing: border-box; max-width: 100%; }\n\n      /* New structure styles matching provided design */\n      #text-chat-panel .widget-container {\n        width: 100%; height: 100%; min-height: 0; background: #FFFFFF; overflow: hidden; display: flex; flex-direction: column; border-radius: ").concat(f.borderRadius,"px;\n      }\n      #text-chat-panel .widget-header {\n        padding: 12px 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        border-top-left-radius: ").concat(f.borderRadius,"px;\n        border-top-right-radius: ").concat(f.borderRadius,"px;\n        flex-shrink: 0;\n        min-height: 60px;\n        box-sizing: border-box;\n      }\n      #text-chat-panel .header-title { font-size: 16px; font-weight: 600; }\n      #text-chat-panel .header-status { display: flex; align-items: center; gap: 8px; font-size: 12px; opacity: 0.9; }\n      #text-chat-panel .status-dot { width: 8px; height: 8px; background: #4ade80; border-radius: 50%; animation: pulse 2s ease-in-out infinite; }\n      @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }\n      /* Header icon buttons */\n      .header-icon {\n        background: rgba(255, 255, 255, 0.2);\n        border: none;\n        color: white;\n        width: 36px;\n        height: 36px;\n        min-width: 36px;\n        min-height: 36px;\n        border-radius: 50%;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: background 0.2s;\n        flex-shrink: 0;\n        font-size: 16px;\n        padding: 0;\n        box-sizing: border-box;\n      }\n      \n      .header-icon:hover {\n        background: rgba(255, 255, 255, 0.3);\n      }\n      \n      .header-icon svg {\n        pointer-events: none;\n        stroke: white;\n        fill: none;\n      }\n      \n      .back-btn.visible {\n        display: flex !important;\n      }\n\n      /* Landing and mode selection (shown only if voice enabled) */\n      .landing-screen { \n        display: none; \n        flex: 1; \n        padding: 20px; \n        background: ").concat((null===(o=this.config.landing)||void 0===o?void 0:o.backgroundColor)||"linear-gradient(180deg, #f8fafc 0%, #e0e7ff 100%)","; \n        align-items: center; \n        justify-content: flex-start; \n        flex-direction: column; \n        gap: 16px; \n        overflow-y: auto; \n        min-height: 0; \n      }\n      .landing-screen.active { display: flex; }\n      .landing-logo { font-size: 48px; }\n      .landing-title { \n        font-size: 20px; \n        color: ").concat((null===(i=this.config.landing)||void 0===i?void 0:i.titleColor)||"#1e293b","; \n        font-weight: 700; \n        margin-bottom: 20px; \n        text-align: center;\n        width: 100%;\n      }\n      .mode-selection { display: flex; gap: 16px; width: 100%; justify-content: center; }\n      .mode-card { \n        flex: 1; \n        max-width: 180px; \n        background: ").concat((null===(r=this.config.landing)||void 0===r?void 0:r.modeCardBackgroundColor)||"#FFFFFF","; \n        border: 2px solid ").concat((null===(a=this.config.landing)||void 0===a?void 0:a.modeCardBorderColor)||"#E2E8F0","; \n        border-radius: 20px; \n        padding: 20px 12px; \n        cursor: pointer; \n        display: flex; \n        flex-direction: column; \n        align-items: center; \n        gap: 8px; \n        transition: transform ").concat(v.duration,"s ease, box-shadow ").concat(v.duration,"s ease, border-color ").concat(v.duration,"s ease; \n        box-shadow: 0 4px 12px rgba(0,0,0,0.05); \n      }\n      .mode-card:hover { \n        transform: translateY(-6px); \n        box-shadow: 0 12px 24px rgba(102, 126, 234, 0.2); \n        border-color: ").concat((null===(c=this.config.landing)||void 0===c?void 0:c.modeCardHoverBorderColor)||m,"; \n      }\n      .mode-card-icon { \n        width: 60px; \n        height: 60px; \n        display: flex; \n        align-items: center; \n        justify-content: center; \n        border-radius: 50%; \n        background: ").concat((null===(s=this.config.landing)||void 0===s?void 0:s.modeCardIconBackgroundColor)||m,"; \n        color: #fff; \n        font-size: 32px; \n      }\n      .mode-card-title { \n        color: ").concat((null===(l=this.config.landing)||void 0===l?void 0:l.modeCardTitleColor)||"#111827","; \n        font-weight: 600; \n        text-align: center;\n        width: 100%;\n      }\n\n      ").concat(g?this.voiceInterface.generateCSS():"","\n      ").concat(y?this.textInterface.generateCSS():"","\n      \n      #text-chat-send-hint {\n        text-align: center;\n        line-height: 1.4;\n      }\n      \n      .agent-thinking {\n        font-style: italic;\n        color: #6B7280;\n      }\n    ")}},{key:"setupWidgetEvents",value:function(){var t=this,n=document.getElementById("text-chat-button");n&&(n.onclick=function(){return t.togglePanel()});var e=document.getElementById("closeBtn");e&&(e.onclick=function(){return t.togglePanel()});var o=this.config.behavior.mode||"unified",i="unified"===o,r="unified"===o||"voice-only"===o,a="unified"===o||"text-only"===o,c=document.getElementById("backBtn"),s=document.getElementById("landingScreen"),l=document.getElementById("mode-card-voice"),u=document.getElementById("mode-card-text"),d=document.getElementById("textInterface"),f=document.getElementById("voiceInterface");c&&(c.onclick=function(){return t.showLanding()}),i?(l&&(l.onclick=function(){return t.showVoice()}),u&&(u.onclick=function(){return t.showText()}),s&&s.classList.add("active"),d&&d.classList.remove("active"),f&&f.classList.remove("active"),c&&"unified"===o&&c.classList.remove("visible")):"voice-only"===o?(f&&f.classList.add("active"),d&&d.classList.remove("active"),s&&s.classList.remove("active")):"text-only"===o&&(d&&d.classList.add("active"),f&&f.classList.remove("active"),s&&s.classList.remove("active")),r&&this.voiceInterface.setupEventHandlers(),a&&this.textInterface.setupEventHandlers();var p=document.getElementById("newChatBtn");p&&(p.onclick=function(){return t.textInterface.startNewChat()},i&&(p.style.display="none")),this.config.accessibility.keyboardNavigation&&this.setupKeyboardNavigation()}},{key:"startNewChat",value:function(){this.textInterface.startNewChat()}},{key:"showLanding",value:function(){if("unified"===(this.config.behavior.mode||"unified")){var t=document.getElementById("landingScreen"),n=document.getElementById("textInterface"),e=document.getElementById("voiceInterface"),o=document.getElementById("backBtn"),i=document.getElementById("newChatBtn");t&&t.classList.add("active"),n&&n.classList.remove("active"),e&&e.classList.remove("active"),o&&o.classList.remove("visible"),i&&(i.style.display="none")}}},{key:"showText",value:function(){var t=document.getElementById("landingScreen"),n=document.getElementById("voiceInterface"),e=document.getElementById("backBtn"),o=document.getElementById("newChatBtn");t&&t.classList.remove("active"),n&&n.classList.remove("active"),this.textInterface.show();var i=this.config.behavior.mode||"unified";e&&"unified"===i&&e.classList.add("visible"),o&&(o.style.display="")}},{key:"showVoice",value:function(){var t=document.getElementById("landingScreen"),n=document.getElementById("textInterface"),e=document.getElementById("voiceInterface"),o=document.getElementById("backBtn"),i=document.getElementById("newChatBtn");t&&t.classList.remove("active"),n&&n.classList.remove("active"),e&&e.classList.add("active");var r=this.config.behavior.mode||"unified";o&&"unified"===r&&o.classList.add("visible"),i&&(i.style.display="")}},{key:"setupKeyboardNavigation",value:function(){var t=this;document.addEventListener("keydown",function(n){"Escape"===n.key&&t.isOpen&&t.togglePanel()})}},{key:"togglePanel",value:function(){this.isOpen=!this.isOpen,document.getElementById("text-chat-panel").classList.toggle("open"),this.isOpen&&setTimeout(function(){var t=document.getElementById("messageInput");t&&t.focus()},100),this.isOpen&&!this.isActive&&this.config.behavior.autoConnect&&this.startChat()}},{key:"startChat",value:(r=kn(xn().m(function t(){return xn().w(function(t){for(;;)switch(t.n){case 0:this.isActive=!0,this.textInterface.setActive(!0);case 1:return t.a(2)}},t,this)})),function(){return r.apply(this,arguments)})},{key:"sendMessage",value:(i=kn(xn().m(function t(){return xn().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.textInterface.sendMessage();case 1:return t.a(2)}},t,this)})),function(){return i.apply(this,arguments)})},{key:"updateSendButtonState",value:function(){this.textInterface.updateSendButtonState()}},{key:"getSignedUrl",value:(o=kn(xn().m(function t(){var n,e,o,i,r,a,c;return xn().w(function(t){for(;;)switch(t.n){case 0:if(this.config.getSessionUrl){t.n=2;break}if(this.config.agentId){t.n=1;break}throw new Error("agentId is required");case 1:return n=this.config.websocketUrl||"wss://backend.talktopc.com/ws/conv",(e=new URLSearchParams).append("agentId",this.config.agentId),this.config.appId&&e.append("appId",this.config.appId),!1!==this.config.demo&&e.append("demo","true"),t.a(2,"".concat(n,"?").concat(e.toString()));case 2:if("string"!=typeof this.config.getSessionUrl){t.n=6;break}return o={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(o.appId=this.config.appId),t.n=3,fetch(this.config.getSessionUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:if((i=t.v).ok){t.n=4;break}throw new Error("Failed to get session URL: ".concat(i.statusText));case 4:return t.n=5,i.json();case 5:return r=t.v,t.a(2,r.signedUrl||r.wsUrl||r.url);case 6:if("function"!=typeof this.config.getSessionUrl){t.n=8;break}return a={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(a.appId=this.config.appId),t.n=7,this.config.getSessionUrl(a);case 7:return c=t.v,t.a(2,"string"==typeof c?c:c.signedUrl||c.wsUrl||c.url);case 8:throw new Error("getSessionUrl must be a string (backend URL), a function, or omitted (for direct connection with agentId/appId)");case 9:return t.a(2)}},t,this)})),function(){return o.apply(this,arguments)})},{key:"addMessage",value:function(t,n){this.textInterface.addMessage(t,n)}},{key:"beginStreaming",value:function(){this.textInterface.beginStreaming()}},{key:"appendStreamingChunk",value:function(t){this.textInterface.appendStreamingChunk(t)}},{key:"finalizeStreaming",value:function(t){this.textInterface.finalizeStreaming(t)}},{key:"stopStreamingState",value:function(){this.textInterface.stopStreamingState()}},{key:"showError",value:function(t){this.textInterface.showError(t)}},{key:"updateStatus",value:function(t){}},{key:"updateConfig",value:function(t){var n,e,o,i,r=In({},this.config);t.panel&&(r.panel=In(In({},this.config.panel),t.panel)),t.voice&&(r.voice=In(In({},this.config.voice),t.voice),t.voice.micButtonHint&&(r.voice.micButtonHint=In(In({},null===(o=this.config.voice)||void 0===o?void 0:o.micButtonHint),t.voice.micButtonHint))),t.text&&(r.text=In(In({},this.config.text),t.text),t.text.sendButtonHint&&(r.text.sendButtonHint=In(In({},null===(i=this.config.text)||void 0===i?void 0:i.sendButtonHint),t.text.sendButtonHint))),void 0!==t.language&&(r.language=t.language),void 0!==t.language&&(["he","ar"].includes(t.language)?r.direction="rtl":void 0===t.direction&&(r.direction="ltr")),t.translations&&(r.translations=t.translations,this.translations=t.translations),t.button&&(r.button=In(In({},this.config.button),t.button)),t.header&&(r.header=In(In({},this.config.header),t.header)),t.icon&&(r.icon=In(In({},this.config.icon),t.icon)),t.messages&&(r.messages=In(In({},this.config.messages),t.messages)),t.animation&&(r.animation=In(In({},this.config.animation),t.animation)),t.behavior&&(r.behavior=In(In({},this.config.behavior),t.behavior)),t.accessibility&&(r.accessibility=In(In({},this.config.accessibility),t.accessibility)),t.tooltips&&(r.tooltips=In(In({},this.config.tooltips),t.tooltips)),t.landing&&(r.landing=In(In({},this.config.landing),t.landing)),void 0!==t.direction&&void 0===r.direction&&(r.direction=t.direction),void 0!==t.primaryColor&&(r.primaryColor=t.primaryColor),Object.keys(t).forEach(function(n){["panel","button","header","icon","messages","direction","voice","text","animation","behavior","accessibility","language","tooltips","landing","primaryColor"].includes(n)||(r[n]=t[n])}),null===(n=this.config)||void 0===n||n.language,this.config=this.mergeWithDefaults(r);var a=this.config.language||"en",c=In(In(In({},this.config),this.config.voice),{},{language:a,websocketUrl:(null===(e=this.config.voice)||void 0===e?void 0:e.websocketUrl)||this.config.websocketUrl||"wss://speech.talktopc.com/ws/conv",translations:this.translations});this.voiceInterface=new un(c);var s=In(In(In({},this.config),this.config.text),{},{language:a,translations:this.translations});this.textInterface=new mn(s,this.sdk);var l=document.getElementById("text-chat-widget");l&&l.remove(),this.createWidget(),this.textInterface&&this.textInterface.updateInputAttributes&&this.textInterface.updateInputAttributes()}},{key:"destroy",value:function(){var t=document.getElementById("text-chat-widget");t&&t.remove(),this.sdk&&this.sdk.destroy(),this.voiceInterface&&this.voiceInterface.destroy()}},{key:"startVoiceCall",value:(e=kn(xn().m(function t(){return xn().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.voiceInterface.startVoiceCall();case 1:return t.a(2)}},t,this)})),function(){return e.apply(this,arguments)})},{key:"endVoiceCall",value:function(){this.voiceInterface.endVoiceCall()}},{key:"toggleMute",value:function(){this.voiceInterface.toggleMute()}},{key:"toggleSpeaker",value:function(){this.voiceInterface.toggleSpeaker()}}],n&&Pn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o,i,r}(),Tn="2.0.0";const Fn={VoiceSDK:ft,TextChatSDK:Ot,WebSocketManager:T,AudioRecorder:K,AudioPlayer:X,EventEmitter:c,VoiceButton:Mt,VanillaVoiceButton:Qt,AgentSDK:nn,TTPChatWidget:En,VERSION:Tn};return o})());
//# sourceMappingURL=agent-widget.js.map