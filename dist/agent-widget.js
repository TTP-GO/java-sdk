/*! For license information please see agent-widget.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TTPAgentSDK=t():e.TTPAgentSDK=t()}(window,()=>(()=>{"use strict";var e={"./node_modules/react/cjs/react-jsx-runtime.development.js":(e,t,n)=>{!function(){function e(t){if(null==t)return null;if("function"==typeof t)return t.$$typeof===O?null:t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case v:return"Fragment";case y:return"Profiler";case h:return"StrictMode";case k:return"Suspense";case x:return"SuspenseList";case j:return"Activity"}if("object"==typeof t)switch("number"==typeof t.tag&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),t.$$typeof){case g:return"Portal";case m:return t.displayName||"Context";case b:return(t._context.displayName||"Context")+".Consumer";case w:var n=t.render;return(t=t.displayName)||(t=""!==(t=n.displayName||n.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case S:return null!==(n=t.displayName||null)?n:e(t.type)||"Memo";case C:n=t._payload,t=t._init;try{return e(t(n))}catch(e){}}return null}function o(e){return""+e}function r(e){try{o(e);var t=!1}catch(e){t=!0}if(t){var n=(t=console).error,r="function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n.call(t,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",r),o(e)}}function i(t){if(t===v)return"<>";if("object"==typeof t&&null!==t&&t.$$typeof===C)return"<...>";try{var n=e(t);return n?"<"+n+">":"<...>"}catch(e){return"<...>"}}function a(){return Error("react-stack-top-frame")}function c(){var t=e(this.type);return _[t]||(_[t]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),void 0!==(t=this.props.ref)?t:null}function s(t,n,o,i,a,s){var u,f=n.children;if(void 0!==f)if(i)if(P(f)){for(i=0;i<f.length;i++)l(f[i]);Object.freeze&&Object.freeze(f)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else l(f);if(I.call(n,"key")){f=e(t);var g=Object.keys(n).filter(function(e){return"key"!==e});i=0<g.length?"{key: someKey, "+g.join(": ..., ")+": ...}":"{key: someKey}",R[f+i]||(g=0<g.length?"{"+g.join(": ..., ")+": ...}":"{}",console.error('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',i,f,g,f),R[f+i]=!0)}if(f=null,void 0!==o&&(r(o),f=""+o),function(e){if(I.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(n)&&(r(n.key),f=""+n.key),"key"in n)for(var v in o={},n)"key"!==v&&(o[v]=n[v]);else o=n;return f&&function(e,t){function n(){d||(d=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",t))}n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}(o,"function"==typeof t?t.displayName||t.name||"Unknown":t),function(e,t,n,o,r,i){var a=n.ref;return e={$$typeof:p,type:e,key:t,props:n,_owner:o},null!==(void 0!==a?a:null)?Object.defineProperty(e,"ref",{enumerable:!1,get:c}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:r}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:i}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}(t,f,o,null===(u=E.A)?null:u.getOwner(),a,s)}function l(e){u(e)?e._store&&(e._store.validated=1):"object"==typeof e&&null!==e&&e.$$typeof===C&&("fulfilled"===e._payload.status?u(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function u(e){return"object"==typeof e&&null!==e&&e.$$typeof===p}var d,f=n("./node_modules/react/index.js"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),m=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),O=Symbol.for("react.client.reference"),E=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I=Object.prototype.hasOwnProperty,P=Array.isArray,B=console.createTask?console.createTask:function(){return null},_={},T=(f={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(f,a)(),F=B(i(a)),R={};t.Fragment=v,t.jsx=function(e,t,n){var o=1e4>E.recentlyCreatedOwnerStacks++;return s(e,t,n,!1,o?Error("react-stack-top-frame"):T,o?B(i(e)):F)},t.jsxs=function(e,t,n){var o=1e4>E.recentlyCreatedOwnerStacks++;return s(e,t,n,!0,o?Error("react-stack-top-frame"):T,o?B(i(e)):F)}}()},"./node_modules/react/cjs/react.development.js":(e,t,n)=>{e=n.nmd(e),function(){function n(e,t){Object.defineProperty(r.prototype,e,{get:function(){console.warn("%s(...) is deprecated in plain JavaScript React classes. %s",t[0],t[1])}})}function o(e,t){var n=(e=(e=e.constructor)&&(e.displayName||e.name)||"ReactClass")+"."+t;W[n]||(console.error("Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",t,e),W[n]=!0)}function r(e,t,n){this.props=e,this.context=t,this.refs=$,this.updater=n||V}function i(){}function a(e,t,n){this.props=e,this.context=t,this.refs=$,this.updater=n||V}function c(){}function s(e){return""+e}function l(e){try{s(e);var t=!1}catch(e){t=!0}if(t){var n=(t=console).error,o="function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n.call(t,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",o),s(e)}}function u(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===X?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case T:return"Fragment";case R:return"Profiler";case F:return"StrictMode";case L:return"Suspense";case H:return"SuspenseList";case K:return"Activity"}if("object"==typeof e)switch("number"==typeof e.tag&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case _:return"Portal";case D:return e.displayName||"Context";case A:return(e._context.displayName||"Context")+".Consumer";case M:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case U:return null!==(t=e.displayName||null)?t:u(e.type)||"Memo";case z:t=e._payload,e=e._init;try{return u(e(t))}catch(e){}}return null}function d(e){if(e===T)return"<>";if("object"==typeof e&&null!==e&&e.$$typeof===z)return"<...>";try{var t=u(e);return t?"<"+t+">":"<...>"}catch(e){return"<...>"}}function f(){var e=Z.A;return null===e?null:e.getOwner()}function p(){return Error("react-stack-top-frame")}function g(e){if(ee.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}function v(){var e=u(this.type);return ne[e]||(ne[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),void 0!==(e=this.props.ref)?e:null}function h(e,t,n,o,r,i){var a=n.ref;return e={$$typeof:B,type:e,key:t,props:n,_owner:o},null!==(void 0!==a?a:null)?Object.defineProperty(e,"ref",{enumerable:!1,get:v}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:r}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:i}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}function y(e){b(e)?e._store&&(e._store.validated=1):"object"==typeof e&&null!==e&&e.$$typeof===z&&("fulfilled"===e._payload.status?b(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function b(e){return"object"==typeof e&&null!==e&&e.$$typeof===B}function m(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(l(e.key),n=""+e.key,o={"=":"=0",":":"=2"},"$"+n.replace(/[=:]/g,function(e){return o[e]})):t.toString(36);var n,o}function w(e,t,n,o,r){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var a,s,u,d=!1;if(null===e)d=!0;else switch(i){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case B:case _:d=!0;break;case z:return w((d=e._init)(e._payload),t,n,o,r)}}if(d){r=r(d=e);var f=""===o?"."+m(d,0):o;return J(r)?(n="",null!=f&&(n=f.replace(ae,"$&/")+"/"),w(r,t,n,"",function(e){return e})):null!=r&&(b(r)&&(null!=r.key&&(d&&d.key===r.key||l(r.key)),a=r,s=n+(null==r.key||d&&d.key===r.key?"":(""+r.key).replace(ae,"$&/")+"/")+f,s=h(a.type,s,a.props,a._owner,a._debugStack,a._debugTask),a._store&&(s._store.validated=a._store.validated),n=s,""!==o&&null!=d&&b(d)&&null==d.key&&d._store&&!d._store.validated&&(n._store.validated=2),r=n),t.push(r)),1}if(d=0,f=""===o?".":o+":",J(e))for(var p=0;p<e.length;p++)d+=w(o=e[p],t,n,i=f+m(o,p),r);else if("function"==typeof(p=null===(u=e)||"object"!=typeof u?null:"function"==typeof(u=N&&u[N]||u["@@iterator"])?u:null))for(p===e.entries&&(ie||console.warn("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),ie=!0),e=p.call(e),p=0;!(o=e.next()).done;)d+=w(o=o.value,t,n,i=f+m(o,p++),r);else if("object"===i){if("function"==typeof e.then)return w(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(c,c):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,n,o,r);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function k(e,t,n){if(null==e)return e;var o=[],r=0;return w(e,o,"","",function(e){return t.call(n,e,r++)}),o}function x(e){if(-1===e._status){var t=e._ioInfo;null!=t&&(t.start=t.end=performance.now());var n=(t=e._result)();if(n.then(function(t){if(0===e._status||-1===e._status){e._status=1,e._result=t;var o=e._ioInfo;null!=o&&(o.end=performance.now()),void 0===n.status&&(n.status="fulfilled",n.value=t)}},function(t){if(0===e._status||-1===e._status){e._status=2,e._result=t;var o=e._ioInfo;null!=o&&(o.end=performance.now()),void 0===n.status&&(n.status="rejected",n.reason=t)}}),null!=(t=e._ioInfo)){t.value=n;var o=n.displayName;"string"==typeof o&&(t.name=o)}-1===e._status&&(e._status=0,e._result=n)}if(1===e._status)return void 0===(t=e._result)&&console.error("lazy: Expected the result of a dynamic import() call. Instead received: %s\n\nYour code should look like: \n  const MyComponent = lazy(() => import('./MyComponent'))\n\nDid you accidentally put curly braces around the import?",t),"default"in t||console.error("lazy: Expected the result of a dynamic import() call. Instead received: %s\n\nYour code should look like: \n  const MyComponent = lazy(() => import('./MyComponent'))",t),t.default;throw e._result}function S(){var e=Z.H;return null===e&&console.error("Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:\n1. You might have mismatching versions of React and the renderer (such as React DOM)\n2. You might be breaking the Rules of Hooks\n3. You might have more than one copy of React in the same app\nSee https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem."),e}function C(){Z.asyncTransitions--}function j(t){if(null===le)try{var n=("require"+Math.random()).slice(0,7);le=(e&&e[n]).call(e,"timers").setImmediate}catch(e){le=function(e){!1===se&&(se=!0,"undefined"==typeof MessageChannel&&console.error("This browser does not have a MessageChannel implementation, so enqueuing tasks via await act(async () => ...) will fail. Please file an issue at https://github.com/facebook/react/issues if you encounter this warning."));var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}return le(t)}function O(e){return 1<e.length&&"function"==typeof AggregateError?new AggregateError(e):e[0]}function E(e,t){t!==ue-1&&console.error("You seem to have overlapping act() calls, this is not supported. Be sure to await previous act() calls before making a new one. "),ue=t}function I(e,t,n){var o=Z.actQueue;if(null!==o)if(0!==o.length)try{return P(o),void j(function(){return I(e,t,n)})}catch(e){Z.thrownErrors.push(e)}else Z.actQueue=null;0<Z.thrownErrors.length?(o=O(Z.thrownErrors),Z.thrownErrors.length=0,n(o)):t(e)}function P(e){if(!fe){fe=!0;var t=0;try{for(;t<e.length;t++)for(var n=e[t];;){Z.didUsePromise=!1;var o=n(!1);if(null===o)break;if(Z.didUsePromise)return e[t]=n,void e.splice(0,t);n=o}e.length=0}catch(n){e.splice(0,t+1),Z.thrownErrors.push(n)}finally{fe=!1}}}"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var B=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),D=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),L=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),N=Symbol.iterator,W={},V={isMounted:function(){return!1},enqueueForceUpdate:function(e){o(e,"forceUpdate")},enqueueReplaceState:function(e){o(e,"replaceState")},enqueueSetState:function(e){o(e,"setState")}},G=Object.assign,$={};Object.freeze($),r.prototype.isReactComponent={},r.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};var q={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]};for(ge in q)q.hasOwnProperty(ge)&&n(ge,q[ge]);i.prototype=r.prototype,(q=a.prototype=new i).constructor=a,G(q,r.prototype),q.isPureReactComponent=!0;var Q,Y,J=Array.isArray,X=Symbol.for("react.client.reference"),Z={H:null,A:null,T:null,S:null,actQueue:null,asyncTransitions:0,isBatchingLegacy:!1,didScheduleLegacyUpdate:!1,didUsePromise:!1,thrownErrors:[],getCurrentStack:null,recentlyCreatedOwnerStacks:0},ee=Object.prototype.hasOwnProperty,te=console.createTask?console.createTask:function(){return null},ne={},oe=(q={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(q,p)(),re=te(d(p)),ie=!1,ae=/\/+/g,ce="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},se=!1,le=null,ue=0,de=!1,fe=!1,pe="function"==typeof queueMicrotask?function(e){queueMicrotask(function(){return queueMicrotask(e)})}:j;q=Object.freeze({__proto__:null,c:function(e){return S().useMemoCache(e)}});var ge={map:k,forEach:function(e,t,n){k(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return k(e,function(){t++}),t},toArray:function(e){return k(e,function(e){return e})||[]},only:function(e){if(!b(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=K,t.Children=ge,t.Component=r,t.Fragment=T,t.Profiler=R,t.PureComponent=a,t.StrictMode=F,t.Suspense=L,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,t.__COMPILER_RUNTIME=q,t.act=function(e){var t=Z.actQueue,n=ue;ue++;var o=Z.actQueue=null!==t?t:[],r=!1;try{var i=e()}catch(e){Z.thrownErrors.push(e)}if(0<Z.thrownErrors.length)throw E(0,n),e=O(Z.thrownErrors),Z.thrownErrors.length=0,e;if(null!==i&&"object"==typeof i&&"function"==typeof i.then){var a=i;return pe(function(){r||de||(de=!0,console.error("You called act(async () => ...) without await. This could lead to unexpected testing behaviour, interleaving multiple act calls and mixing their scopes. You should - await act(async () => ...);"))}),{then:function(e,t){r=!0,a.then(function(r){if(E(0,n),0===n){try{P(o),j(function(){return I(r,e,t)})}catch(e){Z.thrownErrors.push(e)}if(0<Z.thrownErrors.length){var i=O(Z.thrownErrors);Z.thrownErrors.length=0,t(i)}}else e(r)},function(e){E(0,n),0<Z.thrownErrors.length?(e=O(Z.thrownErrors),Z.thrownErrors.length=0,t(e)):t(e)})}}}var c=i;if(E(0,n),0===n&&(P(o),0!==o.length&&pe(function(){r||de||(de=!0,console.error("A component suspended inside an `act` scope, but the `act` call was not awaited. When testing React components that depend on asynchronous data, you must await the result:\n\nawait act(() => ...)"))}),Z.actQueue=null),0<Z.thrownErrors.length)throw e=O(Z.thrownErrors),Z.thrownErrors.length=0,e;return{then:function(e,t){r=!0,0===n?(Z.actQueue=o,j(function(){return I(c,e,t)})):e(c)}}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.captureOwnerStack=function(){var e=Z.getCurrentStack;return null===e?null:e()},t.cloneElement=function(e,t,n){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var o,r=G({},e.props),i=e.key,a=e._owner;if(null!=t)for(c in(o=!(ee.call(t,"ref")&&(o=Object.getOwnPropertyDescriptor(t,"ref").get)&&o.isReactWarning)&&void 0!==t.ref)&&(a=f()),g(t)&&(l(t.key),i=""+t.key),t)!ee.call(t,c)||"key"===c||"__self"===c||"__source"===c||"ref"===c&&void 0===t.ref||(r[c]=t[c]);var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){o=Array(c);for(var s=0;s<c;s++)o[s]=arguments[s+2];r.children=o}for(r=h(e.type,i,r,a,e._debugStack,e._debugTask),i=2;i<arguments.length;i++)y(arguments[i]);return r},t.createContext=function(e){return(e={$$typeof:D,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:A,_context:e},e._currentRenderer=null,e._currentRenderer2=null,e},t.createElement=function(e,t,n){for(var o=2;o<arguments.length;o++)y(arguments[o]);o={};var r=null;if(null!=t)for(s in Y||!("__self"in t)||"key"in t||(Y=!0,console.warn("Your app (or one of its dependencies) is using an outdated JSX transform. Update to the modern JSX transform for faster performance: https://react.dev/link/new-jsx-transform")),g(t)&&(l(t.key),r=""+t.key),t)ee.call(t,s)&&"key"!==s&&"__self"!==s&&"__source"!==s&&(o[s]=t[s]);var i=arguments.length-2;if(1===i)o.children=n;else if(1<i){for(var a=Array(i),c=0;c<i;c++)a[c]=arguments[c+2];Object.freeze&&Object.freeze(a),o.children=a}if(e&&e.defaultProps)for(s in i=e.defaultProps)void 0===o[s]&&(o[s]=i[s]);r&&function(e,t){function n(){Q||(Q=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",t))}n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}(o,"function"==typeof e?e.displayName||e.name||"Unknown":e);var s=1e4>Z.recentlyCreatedOwnerStacks++;return h(e,r,o,f(),s?Error("react-stack-top-frame"):oe,s?te(d(e)):re)},t.createRef=function(){var e={current:null};return Object.seal(e),e},t.forwardRef=function(e){null!=e&&e.$$typeof===U?console.error("forwardRef requires a render function but received a `memo` component. Instead of forwardRef(memo(...)), use memo(forwardRef(...))."):"function"!=typeof e?console.error("forwardRef requires a render function but was given %s.",null===e?"null":typeof e):0!==e.length&&2!==e.length&&console.error("forwardRef render functions accept exactly two parameters: props and ref. %s",1===e.length?"Did you forget to use the ref parameter?":"Any additional parameter will be undefined."),null!=e&&null!=e.defaultProps&&console.error("forwardRef render functions do not support defaultProps. Did you accidentally pass a React component?");var t,n={$$typeof:M,render:e};return Object.defineProperty(n,"displayName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n,e.name||e.displayName||(Object.defineProperty(e,"name",{value:n}),e.displayName=n)}}),n},t.isValidElement=b,t.lazy=function(e){var t={$$typeof:z,_payload:e={_status:-1,_result:e},_init:x},n={name:"lazy",start:-1,end:-1,value:null,owner:null,debugStack:Error("react-stack-top-frame"),debugTask:console.createTask?console.createTask("lazy()"):null};return e._ioInfo=n,t._debugInfo=[{awaited:n}],t},t.memo=function(e,t){var n;return null==e&&console.error("memo: The first argument must be a component. Instead received: %s",null===e?"null":typeof e),t={$$typeof:U,type:e,compare:void 0===t?null:t},Object.defineProperty(t,"displayName",{enumerable:!1,configurable:!0,get:function(){return n},set:function(t){n=t,e.name||e.displayName||(Object.defineProperty(e,"name",{value:t}),e.displayName=t)}}),t},t.startTransition=function(e){var t=Z.T,n={};n._updatedFibers=new Set,Z.T=n;try{var o=e(),r=Z.S;null!==r&&r(n,o),"object"==typeof o&&null!==o&&"function"==typeof o.then&&(Z.asyncTransitions++,o.then(C,C),o.then(c,ce))}catch(e){ce(e)}finally{null===t&&n._updatedFibers&&(e=n._updatedFibers.size,n._updatedFibers.clear(),10<e&&console.warn("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table.")),null!==t&&null!==n.types&&(null!==t.types&&t.types!==n.types&&console.error("We expected inner Transitions to have transferred the outer types set and that you cannot add to the outer Transition while inside the inner.This is a bug in React."),t.types=n.types),Z.T=t}},t.unstable_useCacheRefresh=function(){return S().useCacheRefresh()},t.use=function(e){return S().use(e)},t.useActionState=function(e,t,n){return S().useActionState(e,t,n)},t.useCallback=function(e,t){return S().useCallback(e,t)},t.useContext=function(e){var t=S();return e.$$typeof===A&&console.error("Calling useContext(Context.Consumer) is not supported and will cause bugs. Did you mean to call useContext(Context) instead?"),t.useContext(e)},t.useDebugValue=function(e,t){return S().useDebugValue(e,t)},t.useDeferredValue=function(e,t){return S().useDeferredValue(e,t)},t.useEffect=function(e,t){return null==e&&console.warn("React Hook useEffect requires an effect callback. Did you forget to pass a callback to the hook?"),S().useEffect(e,t)},t.useEffectEvent=function(e){return S().useEffectEvent(e)},t.useId=function(){return S().useId()},t.useImperativeHandle=function(e,t,n){return S().useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return null==e&&console.warn("React Hook useInsertionEffect requires an effect callback. Did you forget to pass a callback to the hook?"),S().useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return null==e&&console.warn("React Hook useLayoutEffect requires an effect callback. Did you forget to pass a callback to the hook?"),S().useLayoutEffect(e,t)},t.useMemo=function(e,t){return S().useMemo(e,t)},t.useOptimistic=function(e,t){return S().useOptimistic(e,t)},t.useReducer=function(e,t,n){return S().useReducer(e,t,n)},t.useRef=function(e){return S().useRef(e)},t.useState=function(e){return S().useState(e)},t.useSyncExternalStore=function(e,t,n){return S().useSyncExternalStore(e,t,n)},t.useTransition=function(){return S().useTransition()},t.version="19.2.0","undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()},"./node_modules/react/index.js":(e,t,n)=>{e.exports=n("./node_modules/react/cjs/react.development.js")},"./node_modules/react/jsx-runtime.js":(e,t,n)=>{e.exports=n("./node_modules/react/cjs/react-jsx-runtime.development.js")},"./src/core/AudioPlayer.js":(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,o,r,a){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return i(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,a),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(i(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,i(p,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,a,"GeneratorFunction"),i(p),i(p,a,"Generator"),i(p,o,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:g}})()}function i(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}i=function(e,t,n,o){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,o)}function a(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,s(o.key),o)}}function s(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}n.r(t),n.d(t,{default:()=>f});var f=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=u(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}(this,t)).config=e,n.audioContext=null,n.audioQueue=[],n.isPlaying=!1,n.isProcessingQueue=!1,n.currentSource=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(t,e),n=t,i=[{key:"playAudio",value:function(e){var t=this;try{var n=this.createAudioBlob(e);this.audioQueue.push(n),this.isPlaying||this.isProcessingQueue||this.currentSource||setTimeout(function(){return t.processQueue()},50)}catch(e){this.emit("playbackError",e)}}},{key:"createAudioBlob",value:function(e){var t=new Uint8Array(e);if(t.length>=4){if(82===t[0]&&73===t[1]&&70===t[2]&&70===t[3])return new Blob([e],{type:"audio/wav"});if(255===t[0]&&!(224&~t[1]))return new Blob([e],{type:"audio/mpeg"});if(79===t[0]&&103===t[1]&&103===t[2]&&83===t[3])return new Blob([e],{type:"audio/ogg"})}return new Blob([e],{type:"audio/wav"})}},{key:"processQueue",value:(s=r().m(function e(){var t,n,o,i,a,c,s,l,u=this;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isProcessingQueue&&0!==this.audioQueue.length){e.n=1;break}return e.a(2);case 1:if(this.isProcessingQueue=!0,t=this.audioQueue.shift()){e.n=2;break}return this.isProcessingQueue=!1,e.a(2);case 2:if(e.p=2,n=!this.isPlaying&&null===this.currentSource,this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),"suspended"!==(o=this.audioContext).state){e.n=3;break}return e.n=3,o.resume();case 3:return e.n=4,t.arrayBuffer();case 4:return i=e.v,e.n=5,o.decodeAudioData(i);case 5:a=e.v,c=n&&!this.isPlaying&&null===this.currentSource,(s=o.createBufferSource()).buffer=a,s.connect(o.destination),this.currentSource=s,this.isPlaying=!0,c&&this.emit("playbackStarted"),s.onended=function(){u.currentSource=null,u.isProcessingQueue=!1,u.audioQueue.length>0?setTimeout(function(){return u.processQueue()},50):setTimeout(function(){0!==u.audioQueue.length||u.currentSource||(u.isPlaying=!1,u.emit("playbackStopped"))},100)},s.start(),e.n=7;break;case 6:e.p=6,l=e.v,this.currentSource=null,this.emit("playbackError",l),this.audioQueue.length>0?(this.isProcessingQueue=!1,setTimeout(function(){return u.processQueue()},100)):(this.isPlaying=!1,this.isProcessingQueue=!1,this.emit("playbackStopped"));case 7:return e.a(2)}},e,this,[[2,6]])}),f=function(){var e=this,t=arguments;return new Promise(function(n,o){var r=s.apply(e,t);function i(e){a(r,n,o,i,c,"next",e)}function c(e){a(r,n,o,i,c,"throw",e)}i(void 0)})},function(){return f.apply(this,arguments)})},{key:"stop",value:function(){this.stopImmediate()}},{key:"stopImmediate",value:function(){var e=this.isPlaying||null!==this.currentSource;if(this.currentSource){try{this.currentSource.stop()}catch(e){}this.currentSource=null}this.isPlaying=!1,this.isProcessingQueue=!1,this.audioQueue=[],e&&this.emit("playbackStopped")}},{key:"getStatus",value:function(){return{isPlaying:this.isPlaying,isProcessingQueue:this.isProcessingQueue,queueLength:this.audioQueue.length,audioContextState:this.audioContext?this.audioContext.state:"closed"}}},{key:"destroy",value:function(){this.stop(),this.audioContext&&"closed"!==this.audioContext.state&&(this.audioContext.close(),this.audioContext=null)}}],i&&c(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,s,f}(n("./src/core/EventEmitter.js").default)},"./src/core/AudioRecorder.js":(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,o,r,a){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return i(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,a),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(i(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,i(p,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,a,"GeneratorFunction"),i(p),i(p,a,"Generator"),i(p,o,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:g}})()}function i(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}i=function(e,t,n,o){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,o)}function a(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function l(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(u=function(){return!!e})()}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}n.r(t),n.d(t,{default:()=>p});var p=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=d(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,u()?Reflect.construct(t,n||[],d(e).constructor):t.apply(e,n))}(this,t)).config=e,n.audioContext=null,n.audioWorkletNode=null,n.mediaStream=null,n.isRecording=!1,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(t,e),n=t,i=[{key:"start",value:(l=c(r().m(function e(){var t,n=this;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,navigator.mediaDevices.getUserMedia({audio:{sampleRate:this.config.sampleRate,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});case 1:if(this.mediaStream=e.v,this.audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:this.config.sampleRate}),"suspended"!==this.audioContext.state){e.n=2;break}return e.n=2,this.audioContext.resume();case 2:return e.n=3,this.audioContext.audioWorklet.addModule("/audio-processor.js");case 3:this.audioWorkletNode=new AudioWorkletNode(this.audioContext,"audio-processor"),this.audioContext.createMediaStreamSource(this.mediaStream).connect(this.audioWorkletNode),this.audioWorkletNode.port.onmessage=function(e){var t=e.data,o=t.type,r=t.data;"pcm_audio_data"===o&&n.emit("audioData",r)},this.audioWorkletNode.port.postMessage({type:"setForceContinuous",data:{enabled:!0}}),this.isRecording=!0,this.emit("recordingStarted"),e.n=5;break;case 4:throw e.p=4,t=e.v,this.emit("error",t),t;case 5:return e.a(2)}},e,this,[[0,4]])})),function(){return l.apply(this,arguments)})},{key:"stop",value:(a=c(r().m(function e(){var t;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isRecording){e.n=1;break}return e.a(2);case 1:if(e.p=1,!this.audioWorkletNode){e.n=2;break}return this.audioWorkletNode.port.postMessage({type:"flush"}),e.n=2,new Promise(function(e){return setTimeout(e,100)});case 2:if(this.mediaStream&&(this.mediaStream.getTracks().forEach(function(e){return e.stop()}),this.mediaStream=null),!this.audioContext||"closed"===this.audioContext.state){e.n=4;break}return e.n=3,this.audioContext.close();case 3:this.audioContext=null;case 4:this.audioWorkletNode=null,this.isRecording=!1,this.emit("recordingStopped"),e.n=6;break;case 5:throw e.p=5,t=e.v,this.emit("error",t),t;case 6:return e.a(2)}},e,this,[[1,5]])})),function(){return a.apply(this,arguments)})},{key:"getStatus",value:function(){return{isRecording:this.isRecording,audioContextState:this.audioContext?this.audioContext.state:"closed"}}},{key:"destroy",value:function(){this.stop()}}],i&&s(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,a,l}(n("./src/core/EventEmitter.js").default)},"./src/core/EventEmitter.js":(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,i(o.key),o)}}function i(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}n.r(t),n.d(t,{default:()=>a});var a=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events={}},t=[{key:"on",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}},{key:"off",value:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(function(e){return e!==t}))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.events[e]&&this.events[e].forEach(function(t){try{t.apply(void 0,n)}catch(t){console.error("Error in event listener for ".concat(e,":"),t)}})}},{key:"removeAllListeners",value:function(e){e?delete this.events[e]:this.events={}}}],t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},"./src/core/TextChatSDK.js":(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,o,r,a){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return i(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,a),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(i(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,i(p,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,a,"GeneratorFunction"),i(p),i(p,a,"Generator"),i(p,o,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:g}})()}function i(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}i=function(e,t,n,o){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,o)}function a(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,d(o.key),o)}}function d(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}function f(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(f=function(){return!!e})()}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}n.r(t),n.d(t,{default:()=>v});var v=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=(e=function(e,t,n){return t=p(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,f()?Reflect.construct(t,n||[],p(e).constructor):t.apply(e,n))}(this,t)).readScriptTagConfig();return e.config=s({baseWsUrl:"wss://backend.talktopc.com/chat/websocket",appId:n.appId||r.appId,agentId:n.agentId||r.agentId,conversationId:void 0!==n.conversationId?n.conversationId:e.getPersistedConversationId(),forceConversationId:n.forceConversationId,queue:[],inFlight:!1},n),e.fullResponseBuffer="",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,e),n=t,i=[{key:"readScriptTagConfig",value:function(){try{var e=Array.from(document.getElementsByTagName("script")).reverse().find(function(e){return e.dataset&&(e.dataset.appId||e.dataset.agentId)||e.src&&e.src.includes("agent-widget")});return e?{appId:e.dataset.appId,agentId:e.dataset.agentId}:{}}catch(e){return{}}}},{key:"buildWebSocketUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.baseWsUrl,t=new URLSearchParams;return this.config.appId&&t.append("appId",this.config.appId),this.config.agentId&&t.append("agentId",this.config.agentId),this.config.conversationId&&t.append("conversationId",this.config.conversationId),"".concat(e,"?").concat(t.toString())}},{key:"sendMessage",value:(c=r().m(function e(t){var n=this;return r().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,o){if(t&&t.trim())if(n.config.appId&&n.config.agentId){var r={text:t,resolve:e,reject:o};n.config.inFlight?n.config.queue.push(r):n.executeTask(r)}else o(new Error("Missing appId or agentId"));else o(new Error("Message is empty"))}))},e)}),l=function(){var e=this,t=arguments;return new Promise(function(n,o){var r=c.apply(e,t);function i(e){a(r,n,o,i,s,"next",e)}function s(e){a(r,n,o,i,s,"throw",e)}i(void 0)})},function(e){return l.apply(this,arguments)})},{key:"executeTask",value:function(e){var t=this;if(this.config.inFlight=!0,this.fullResponseBuffer="",!this.config.conversationId){var n=this.getPersistedConversationId();n&&(this.config.conversationId=n,console.log("üîç TextChatSDK hydrated conversationId from storage:",n))}var o,r=this.buildWebSocketUrl(this.config.baseWsUrl),i=this.config.baseWsUrl.endsWith("/websocket")?this.config.baseWsUrl.replace(/\/websocket$/,""):"".concat(this.config.baseWsUrl,"/websocket"),a=this.buildWebSocketUrl(i),c=!1,s=!1,l=null,u=function(n){if(!s)try{var o={message:e.text},r=t.config.forceConversationId||t.config.conversationId;r&&(o.conversationId=r,t.config.forceConversationId&&!t.config.conversationId&&(t.config.conversationId=r,t.persistConversationId(r))),console.log("üîç TextChatSDK sending payload:",o,"conversationId in config:",t.config.conversationId),n.send(JSON.stringify(o)),s=!0}catch(o){e.reject(o),t.emit("error",o);try{n.close()}catch(e){}}},d=function(e){return function(){t.config.conversationId?u(e):l=setTimeout(function(){return u(e)},200)}},f=function(n){return function(o){try{try{console.log("üîé [TextChatSDK] WS <= raw:",o.data)}catch(e){}var r=JSON.parse(o.data);try{console.log("üîé [TextChatSDK] WS <= parsed:",r)}catch(e){}if("hello"===r.type&&r.conversationId){if(console.log("üîç TextChatSDK received conversationId:",r.conversationId),t.config.conversationId=r.conversationId,t.persistConversationId(r.conversationId),t.emit&&t.emit("conversationIdChanged",r.conversationId),!s&&n&&1===n.readyState){if(l)try{clearTimeout(l)}catch(e){}u(n)}return}if(!t.config.conversationId&&r.conversationId&&(console.log("üîç TextChatSDK captured conversationId from message:",r.conversationId),t.config.conversationId=r.conversationId,t.persistConversationId(r.conversationId)),"chunk"===r.type&&"string"==typeof r.content)t.fullResponseBuffer+=r.content,t.emit("chunk",r.content);else if("done"===r.type){try{var i=r.text||r.content||r.answer||r.message||"";i&&!t.fullResponseBuffer&&(t.fullResponseBuffer=i)}catch(e){}!t.config.conversationId&&r.conversationId&&(console.log("üîç TextChatSDK captured conversationId from done:",r.conversationId),t.config.conversationId=r.conversationId),t.persistConversationId(t.config.conversationId),t.emit("done",{text:t.fullResponseBuffer}),e.resolve({conversationId:t.config.conversationId,fullText:t.fullResponseBuffer});try{n.close()}catch(e){}}else if("error"===r.type){var a=new Error(r.message||"Server error");t.emit("error",a),e.reject(a);try{n.close()}catch(e){}}}catch(e){}}},p=function(){t.config.inFlight=!1,t.drainQueue()},g=new WebSocket(r);g.onopen=d(g),g.onmessage=f(g),g.onerror=(o=g,function(n){if(!c){c=!0;try{o.close()}catch(e){}var r=new WebSocket(a);return r.onopen=d(r),r.onmessage=f(r),r.onerror=function(n){t.emit("error",n),e.reject(n)},void(r.onclose=p)}t.emit("error",n),e.reject(n)}),g.onclose=p}},{key:"drainQueue",value:function(){if(0!==this.config.queue.length&&!this.config.inFlight){var e=this.config.queue.shift();this.executeTask(e)}}},{key:"persistConversationId",value:function(e){try{e&&localStorage.setItem("ttp_text_chat_conversation_id",e)}catch(e){}}},{key:"getPersistedConversationId",value:function(){try{return localStorage.getItem("ttp_text_chat_conversation_id")||null}catch(e){return null}}},{key:"updateConfig",value:function(e){this.config=s(s({},this.config),e)}},{key:"destroy",value:function(){this.config.queue=[],this.config.inFlight=!1,this.removeAllListeners()}}],i&&u(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,i,c,l}(n("./src/core/EventEmitter.js").default)},"./src/core/VoiceSDK.js":(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var o=n("./src/core/EventEmitter.js"),r=n("./src/core/WebSocketManager.js"),i=n("./src/core/AudioRecorder.js"),a=n("./src/core/AudioPlayer.js");function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var s=o&&o.prototype instanceof c?o:c,u=Object.create(s.prototype);return l(u,"_invoke",function(n,o,r){var i,c,s,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,o){for(c=n,s=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(c=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,c=0))}if(r||n>1)return a;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),c=u,s=g;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(r="next"),t=i[r]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(o,f))!==a)break}catch(t){i=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var a={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(l(t={},o,function(){return this}),t),p=d.prototype=c.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,l(p,"constructor",d),l(d,"constructor",u),u.displayName="GeneratorFunction",l(d,r,"GeneratorFunction"),l(p),l(p,r,"Generator"),l(p,o,function(){return this}),l(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:i,m:g}})()}function l(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}l=function(e,t,n,o){function i(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},l(e,t,n,o)}function u(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){u(i,o,r,a,c,"next",e)}function c(e){u(i,o,r,a,c,"throw",e)}a(void 0)})}}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,h(o.key),o)}}function h(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}var w=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=b(t),function(e,t){if(t&&("object"==c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,y()?Reflect.construct(t,n||[],b(e).constructor):t.apply(e,n))}(this,t)).config=p({websocketUrl:n.websocketUrl||"wss://speech.talktopc.com/ws/conv",agentId:n.agentId,appId:n.appId,ttpId:n.ttpId,voice:n.voice||"default",language:n.language||"en",sampleRate:n.sampleRate||16e3},n),e.isConnected=!1,e.isRecording=!1,e.isPlaying=!1,e.isDestroyed=!1,e.webSocketManager=new r.default(p(p({},e.config),{},{autoReconnect:!1!==e.config.autoReconnect})),e.audioRecorder=new i.default(e.config),e.audioPlayer=new a.default(e.config),e.setupEventHandlers(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(t,e),n=t,o=[{key:"setupEventHandlers",value:function(){var e=this;this.webSocketManager.on("connected",function(){e.isConnected=!0,e.sendHelloMessage(),e.emit("connected")}),this.webSocketManager.on("disconnected",function(t){e.isConnected=!1,e.isRecording&&e.stopRecording().catch(function(e){console.error("VoiceSDK: Error stopping recording on disconnect:",e)}),e.emit("disconnected",t)}),this.webSocketManager.on("error",function(t){e.emit("error",t)}),this.webSocketManager.on("message",function(t){if("greeting_audio"===t.t&&t.data)try{for(var n=atob(t.data),o=new Uint8Array(n.length),r=0;r<n.length;r++)o[r]=n.charCodeAt(r);e.audioPlayer.playAudio(o),e.emit("greetingStarted")}catch(e){console.error("VoiceSDK: Error playing greeting audio:",e)}else e.emit("message",t)}),this.webSocketManager.on("binaryAudio",function(t){e.audioPlayer.playAudio(t)}),this.webSocketManager.on("bargeIn",function(t){e.emit("bargeIn",t)}),this.webSocketManager.on("stopPlaying",function(t){e.emit("stopPlaying",t),e.audioPlayer.stopImmediate()}),this.audioRecorder.on("recordingStarted",function(){e.isRecording=!0,e.isPlaying&&(e.audioPlayer.stopImmediate(),e.isConnected&&e.webSocketManager.sendMessage({t:"barge_in"})),e.emit("recordingStarted")}),this.audioRecorder.on("recordingStopped",function(){e.isRecording=!1,e.emit("recordingStopped")}),this.audioRecorder.on("audioData",function(t){e.isConnected&&e.webSocketManager.sendBinary(t)}),this.audioPlayer.on("playbackStarted",function(){e.isPlaying=!0,e.emit("playbackStarted"),e.isConnected&&e.webSocketManager.sendMessage({t:"audio_started_playing"})}),this.audioPlayer.on("playbackStopped",function(){e.isPlaying=!1,e.emit("playbackStopped"),e.isConnected&&e.webSocketManager.sendMessage({t:"audio_stopped_playing"})}),this.audioPlayer.on("playbackError",function(t){e.emit("playbackError",t)})}},{key:"connect",value:(w=d(s().m(function e(){var t,n;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isDestroyed){e.n=1;break}return console.warn("VoiceSDK: Cannot connect - SDK is destroyed"),e.a(2,!1);case 1:return e.p=1,t=this.buildWebSocketUrl(),this.webSocketManager.config.websocketUrl=t,e.n=2,this.webSocketManager.connect();case 2:return e.a(2,!0);case 3:return e.p=3,n=e.v,console.error("üîå VoiceSDK: Connection failed with error:",n),this.emit("error",n),e.a(2,!1)}},e,this,[[1,3]])})),function(){return w.apply(this,arguments)})},{key:"buildWebSocketUrl",value:function(){var e=this.config.websocketUrl,t=new URLSearchParams;if(this.config.agentId&&t.append("agentId",this.config.agentId),this.config.appId&&t.append("appId",this.config.appId),this.config.voice&&"default"!==this.config.voice&&t.append("voice",this.config.voice),this.config.language&&"en"!==this.config.language&&t.append("language",this.config.language),t.toString()){var n=e.includes("?")?"&":"?";e+=n+t.toString()}return e}},{key:"disconnect",value:function(){this.isDestroyed||(this.stopRecording(),this.webSocketManager.disconnect())}},{key:"resetReconnectionAttempts",value:function(){this.isDestroyed||this.webSocketManager.resetReconnectionAttempts()}},{key:"reconnect",value:(h=d(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:if(!this.isDestroyed){e.n=1;break}return e.a(2,!1);case 1:return this.disconnect(),this.resetReconnectionAttempts(),e.n=2,this.connect();case 2:return e.a(2,e.v)}},e,this)})),function(){return h.apply(this,arguments)})},{key:"startRecording",value:(g=d(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isConnected){e.n=1;break}throw new Error("Not connected to voice server");case 1:return e.p=1,this.webSocketManager.sendMessage({t:"start_continuous_mode",ttpId:this.generateTtpId(),voice:this.config.voice,language:this.config.language}),e.n=2,this.audioRecorder.start();case 2:return e.a(2,!0);case 3:return e.p=3,t=e.v,console.error("‚ùå VoiceSDK: Failed to start recording:",t),this.emit("error",t),e.a(2,!1)}},e,this,[[1,3]])})),function(){return g.apply(this,arguments)})},{key:"stopRecording",value:(f=d(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isRecording){e.n=1;break}return e.a(2);case 1:return e.p=1,this.webSocketManager.sendMessage({t:"stop_continuous_mode",ttpId:this.generateTtpId()}),e.n=2,this.audioRecorder.stop();case 2:return this.audioPlayer.stopImmediate(),e.a(2,!0);case 3:return e.p=3,t=e.v,this.emit("error",t),e.a(2,!1)}},e,this,[[1,3]])})),function(){return f.apply(this,arguments)})},{key:"toggleRecording",value:(u=d(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:if(!this.isRecording){e.n=2;break}return e.n=1,this.stopRecording();case 1:case 3:return e.a(2,e.v);case 2:return e.n=3,this.startRecording();case 4:return e.a(2)}},e,this)})),function(){return u.apply(this,arguments)})},{key:"stopAudioPlayback",value:function(){this.audioPlayer.stopImmediate()}},{key:"handleBargeIn",value:(l=d(s().m(function e(){return s().w(function(e){for(;;)switch(e.n){case 0:if(this.stopAudioPlayback(),this.isRecording){e.n=1;break}return e.n=1,this.startRecording();case 1:return e.a(2)}},e,this)})),function(){return l.apply(this,arguments)})},{key:"getStatus",value:function(){return{isConnected:this.isConnected,isRecording:this.isRecording,isPlaying:this.isPlaying}}},{key:"updateConfig",value:function(e){this.config=p(p({},this.config),e)}},{key:"generateTtpId",value:function(){return"sdk_"+Math.random().toString(36).substr(2,9)+"_"+Date.now()}},{key:"sendHelloMessage",value:function(){if(this.isConnected){var e={t:"hello"};this.config.appId?e.appId=this.config.appId:this.config.ttpId?e.ttpId=this.config.ttpId:e.ttpId=this.generateTtpId();try{this.webSocketManager.sendMessage(e)}catch(e){console.error("VoiceSDK: Failed to send hello message:",e),this.emit("error",e)}}else console.warn("VoiceSDK: Cannot send hello message - not connected")}},{key:"destroy",value:function(){this.isDestroyed||(this.disconnect(),this.isDestroyed=!0,this.audioRecorder.destroy(),this.audioPlayer.destroy(),this.removeAllListeners())}}],o&&v(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,l,u,f,g,h,w}(o.default)},"./src/core/WebSocketManager.js":(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var o=n("./src/core/EventEmitter.js"),r=n("./src/core/WebSocketSingleton.js");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var a=o&&o.prototype instanceof l?o:l,u=Object.create(a.prototype);return c(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(c(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,c(p,"constructor",d),c(d,"constructor",u),u.displayName="GeneratorFunction",c(d,r,"GeneratorFunction"),c(p),c(p,r,"Generator"),c(p,o,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:g}})()}function c(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}c=function(e,t,n,o){function i(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},c(e,t,n,o)}function s(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function u(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(d=function(){return!!e})()}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}var g=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=f(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,d()?Reflect.construct(t,n||[],f(e).constructor):t.apply(e,n))}(this,t)).config=e,n.ws=null,n.isConnected=!1,n.connectionId=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(t,e),n=t,o=[{key:"connect",value:(u=a().m(function e(){var t=this;return a().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){try{t.connectionId=Date.now()+"_"+Math.random().toString(36).substr(2,9),t.connectResolve=e,t.connectReject=n,r.default.getConnection(t.config.websocketUrl,t.config).then(function(n){t.ws=n,t.setupEventListeners(),n.readyState===WebSocket.OPEN&&(t.isConnected=!0,t.emit("connected"),e(),t.connectResolve=null,t.connectReject=null)}).catch(function(e){console.error("üîå WebSocketManager: Connection failed ".concat(t.connectionId),e),n(e),t.connectResolve=null,t.connectReject=null})}catch(e){console.error("üîå WebSocketManager: Connection error ".concat(t.connectionId),e),n(e),t.connectResolve=null,t.connectReject=null}}))},e)}),g=function(){var e=this,t=arguments;return new Promise(function(n,o){var r=u.apply(e,t);function i(e){s(r,n,o,i,a,"next",e)}function a(e){s(r,n,o,i,a,"throw",e)}i(void 0)})},function(){return g.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;if(this.ws){var t=function(t,n){n===e.config.websocketUrl&&(e.isConnected=!0,e.emit("connected"),e.connectResolve&&(e.connectResolve(),e.connectResolve=null,e.connectReject=null))},n=function(t,n){n===e.config.websocketUrl&&(e.isConnected=!1,e.emit("disconnected",t))},o=function(t,n){n===e.config.websocketUrl&&(e.emit("error",t),e.connectReject&&(e.connectReject(t),e.connectResolve=null,e.connectReject=null))},i=function(t,n){n===e.config.websocketUrl&&e.handleMessage(t)};r.default.on("open",t),r.default.on("close",n),r.default.on("error",o),r.default.on("message",i),this.eventHandlers={open:t,close:n,error:o,message:i}}}},{key:"disconnect",value:function(){this.eventHandlers&&(r.default.off("open",this.eventHandlers.open),r.default.off("close",this.eventHandlers.close),r.default.off("error",this.eventHandlers.error),r.default.off("message",this.eventHandlers.message)),this.config.websocketUrl&&r.default.releaseConnection(this.config.websocketUrl),this.ws=null,this.isConnected=!1}},{key:"sendMessage",value:function(e){if(this.isConnected&&this.ws)try{this.ws.send(JSON.stringify(e))}catch(e){console.warn("üîå WebSocketManager: Failed to send message:",e.message)}}},{key:"sendBinary",value:function(e){if(this.isConnected&&this.ws)try{this.ws.send(e)}catch(e){console.warn("üîå WebSocketManager: Failed to send binary data:",e.message)}}},{key:"handleMessage",value:function(e){var t=this;if(e.data instanceof ArrayBuffer)this.emit("binaryAudio",e.data);else if(e.data instanceof Blob)e.data.arrayBuffer().then(function(e){t.emit("binaryAudio",e)}).catch(function(e){console.error("üîå WebSocketManager: Error converting Blob to ArrayBuffer:",e)});else try{var n=JSON.parse(e.data);"barge_in_ack"!==n.t&&"stop_sending"!==n.t||this.emit("bargeIn",n),"stop_playing"===n.t&&this.emit("stopPlaying",n),this.emit("message",n)}catch(e){this.emit("error",e)}}},{key:"getStatus",value:function(){return{isConnected:this.isConnected,readyState:this.ws?this.ws.readyState:null,connectionId:this.connectionId}}}],c=[{key:"getSingletonStatus",value:function(){return r.default.getAllConnections()}},{key:"clearAllConnections",value:function(){r.default.clearAll()}}],o&&l(n.prototype,o),c&&l(n,c),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o,c,u,g}(o.default)},"./src/core/WebSocketSingleton.js":(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],s=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return c}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function a(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var s=o&&o.prototype instanceof c?o:c,u=Object.create(s.prototype);return l(u,"_invoke",function(n,o,r){var i,c,s,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,o){for(c=n,s=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(c=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,c=0))}if(r||n>1)return a;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),c=u,s=g;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(r="next"),t=i[r]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(o,f))!==a)break}catch(t){i=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var a={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(l(t={},o,function(){return this}),t),p=d.prototype=c.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,l(p,"constructor",d),l(d,"constructor",u),u.displayName="GeneratorFunction",l(d,r,"GeneratorFunction"),l(p),l(p,r,"Generator"),l(p,o,function(){return this}),l(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:i,m:g}})()}function l(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}l=function(e,t,n,o){function i(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},l(e,t,n,o)}function u(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,f(o.key),o)}}function f(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}function p(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(p=function(){return!!e})()}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}n.r(t),n.d(t,{default:()=>h});const h=new(function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=g(t),function(e,t){if(t&&("object"==o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,p()?Reflect.construct(t,n||[],g(e).constructor):t.apply(e,n))}(this,t)).connections=new Map,e.connectionCounts=new Map,e.creatingConnections=new Set,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(t,e),n=t,a=[{key:"getConnection",value:(c=s().m(function e(t){var n,o,r=this;return s().w(function(e){for(;;)switch(e.n){case 0:if(!this.connections.has(t)){e.n=1;break}return n=this.connections.get(t),this.connectionCounts.set(t,(this.connectionCounts.get(t)||0)+1),e.a(2,n);case 1:if(!this.creatingConnections||!this.creatingConnections.has(t)){e.n=2;break}return e.a(2,new Promise(function(e){var n=function(){if(r.connections.has(t)){var o=r.connections.get(t);r.connectionCounts.set(t,(r.connectionCounts.get(t)||0)+1),e(o)}else setTimeout(n,50)};n()}));case 2:return this.creatingConnections.add(t),o=new WebSocket(t),this.connections.set(t,o),this.connectionCounts.set(t,1),o.addEventListener("open",function(e){r.creatingConnections.delete(t),r.emit("open",e,t)}),o.addEventListener("close",function(e){r.creatingConnections.delete(t),r.connections.delete(t),r.connectionCounts.delete(t),r.emit("close",e,t)}),o.addEventListener("error",function(e){r.creatingConnections.delete(t),r.emit("error",e,t)}),o.addEventListener("message",function(e){r.emit("message",e,t)}),e.a(2,o)}},e,this)}),l=function(){var e=this,t=arguments;return new Promise(function(n,o){var r=c.apply(e,t);function i(e){u(r,n,o,i,a,"next",e)}function a(e){u(r,n,o,i,a,"throw",e)}i(void 0)})},function(e){return l.apply(this,arguments)})},{key:"releaseConnection",value:function(e){if(this.connections.has(e)){var t=this.connectionCounts.get(e)||0,n=Math.max(0,t-1);if(this.connectionCounts.set(e,n),0===n){var o=this.connections.get(e);o&&o.readyState===WebSocket.OPEN&&o.close(1e3,"No more subscribers"),this.connections.delete(e),this.connectionCounts.delete(e)}}}},{key:"forceClose",value:function(e){if(this.connections.has(e)){var t=this.connections.get(e);t&&t.readyState===WebSocket.OPEN&&t.close(1e3,"Force close"),this.connections.delete(e),this.connectionCounts.delete(e)}}},{key:"getConnectionStatus",value:function(e){return this.connections.has(e)?{exists:!0,readyState:this.connections.get(e).readyState,subscribers:this.connectionCounts.get(e)||0}:{exists:!1,readyState:null,subscribers:0}}},{key:"getAllConnections",value:function(){var e,t={},n=i(this.connections.entries());try{for(n.s();!(e=n.n()).done;){var o=r(e.value,2),a=o[0],c=o[1];t[a]={readyState:c.readyState,subscribers:this.connectionCounts.get(a)||0}}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"clearAll",value:function(){var e,t=i(this.connections.entries());try{for(t.s();!(e=t.n()).done;){var n=r(e.value,2),o=(n[0],n[1]);o&&o.readyState===WebSocket.OPEN&&o.close(1e3,"Clear all")}}catch(e){t.e(e)}finally{t.f()}this.connections.clear(),this.connectionCounts.clear(),this.creatingConnections.clear()}}],a&&d(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,a,c,l}(n("./src/core/EventEmitter.js").default))},"./src/index.js":(e,t,n)=>{n.r(t),n.d(t,{AgentSDK:()=>d.AgentSDK,AgentWidget:()=>d.AgentWidget,AudioPlayer:()=>c.default,AudioRecorder:()=>a.default,EventEmitter:()=>s.default,TextChatSDK:()=>r.default,TextChatWidget:()=>f.TextChatWidget,VERSION:()=>p,VanillaVoiceButton:()=>u.default,VoiceButton:()=>l.default,VoiceSDK:()=>o.default,WebSocketManager:()=>i.default,default:()=>g});var o=n("./src/core/VoiceSDK.js"),r=n("./src/core/TextChatSDK.js"),i=n("./src/core/WebSocketManager.js"),a=n("./src/core/AudioRecorder.js"),c=n("./src/core/AudioPlayer.js"),s=n("./src/core/EventEmitter.js"),l=n("./src/react/VoiceButton.jsx"),u=n("./src/vanilla/VoiceButton.js"),d=n("./src/legacy/AgentSDK.js"),f=n("./src/legacy/TextChatWidget.js"),p="2.0.0";const g={VoiceSDK:o.default,TextChatSDK:r.default,WebSocketManager:i.default,AudioRecorder:a.default,AudioPlayer:c.default,EventEmitter:s.default,VoiceButton:l.default,VanillaVoiceButton:u.default,AgentSDK:d.AgentSDK,AgentWidget:d.AgentWidget,TextChatWidget:f.TextChatWidget,VERSION:p}},"./src/legacy/AgentSDK.js":(e,t,n)=>{n.r(t),n.d(t,{AgentSDK:()=>h,AgentWidget:()=>y});var o=n("./src/index.js");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var s=o&&o.prototype instanceof c?o:c,u=Object.create(s.prototype);return l(u,"_invoke",function(n,o,r){var i,c,s,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,o){for(c=n,s=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(c=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,c=0))}if(r||n>1)return a;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),c=u,s=g;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(r="next"),t=i[r]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(o,f))!==a)break}catch(t){i=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var a={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(l(t={},o,function(){return this}),t),p=d.prototype=c.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,l(p,"constructor",d),l(d,"constructor",u),u.displayName="GeneratorFunction",l(d,r,"GeneratorFunction"),l(p),l(p,r,"Generator"),l(p,o,function(){return this}),l(p,"toString",function(){return"[object Generator]"}),(s=function(){return{w:i,m:g}})()}function l(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}l=function(e,t,n,o){function i(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},l(e,t,n,o)}function u(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){u(i,o,r,a,c,"next",e)}function c(e){u(i,o,r,a,c,"throw",e)}a(void 0)})}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,v(o.key),o)}}function g(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}var h=function(){return g(function e(t){f(this,e),console.log("üöÄ AgentSDK v2.1.8 initialized with config:",t),this.config=t,this.voiceSDK=null,this.isConnected=!1,this.isListening=!1,this.onConnected=function(){},this.onDisconnected=function(){},this.onError=function(e){return console.error("SDK Error:",e)},this.onTranscript=function(e){},this.onAgentSpeaking=function(e){}},[{key:"connect",value:(t=d(s().m(function e(t){var n,r=this;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t){e.n=1;break}throw new Error("signedUrl is required");case 1:return this.voiceSDK&&(console.log("üîå AgentSDK: Cleaning up existing connection"),this.voiceSDK.destroy(),this.voiceSDK=null),this.voiceSDK=new o.VoiceSDK({websocketUrl:t,autoReconnect:!1,agentId:this.config.agentId,appId:this.config.appId,language:this.config.language||"en"}),this.voiceSDK.on("connected",function(){r.isConnected=!0,r.onConnected()}),this.voiceSDK.on("disconnected",function(){r.isConnected=!1,r.onDisconnected()}),this.voiceSDK.on("error",function(e){r.onError(e)}),this.voiceSDK.on("message",function(e){r.handleWebSocketMessage(e)}),this.voiceSDK.on("recordingStarted",function(){r.isListening=!0}),this.voiceSDK.on("recordingStopped",function(){r.isListening=!1}),this.voiceSDK.on("playbackStarted",function(){r.onAgentSpeaking(!0)}),this.voiceSDK.on("playbackStopped",function(){r.onAgentSpeaking(!1)}),e.n=2,this.voiceSDK.connect();case 2:e.n=4;break;case 3:throw e.p=3,n=e.v,this.onError(n),n;case 4:return e.a(2)}},e,this,[[0,3]])})),function(e){return t.apply(this,arguments)})},{key:"handleWebSocketMessage",value:function(e){switch(e.type){case"connected":console.log("Session started successfully");break;case"user_transcript":this.onTranscript(e.user_transcription||e.text);break;case"agent_response":case"barge_in":case"stop_playing":break;case"error":this.onError(new Error(e.message))}}},{key:"startListening",value:(e=d(s().m(function e(){var t;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("üé§ AgentSDK: startListening() called"),!this.voiceSDK){e.n=5;break}return e.p=1,console.log("üé§ AgentSDK: Starting recording..."),e.n=2,this.voiceSDK.startRecording();case 2:console.log("‚úÖ AgentSDK: Recording started successfully"),e.n=4;break;case 3:throw e.p=3,t=e.v,console.error("‚ùå AgentSDK: Failed to start recording:",t),t;case 4:e.n=6;break;case 5:throw console.error("‚ùå AgentSDK: No voiceSDK instance available"),new Error("No voiceSDK instance available");case 6:return e.a(2)}},e,this,[[1,3]])})),function(){return e.apply(this,arguments)})},{key:"stopListening",value:function(){this.voiceSDK&&this.voiceSDK.stopRecording()}},{key:"updateVariables",value:function(e){this.voiceSDK&&this.isConnected&&this.voiceSDK.webSocketManager.sendMessage({t:"update_variables",variables:e})}},{key:"disconnect",value:function(){this.voiceSDK&&(this.voiceSDK.destroy(),this.voiceSDK=null),this.isConnected=!1,this.isListening=!1}}]);var e,t}(),y=function(){return g(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(f(this,e),this.config=this.mergeWithDefaults(t),this.sdk=new h(this.config),this.isOpen=!1,this.isActive=!1,this.setupEventHandlers(),this.createWidget(),this.config.behavior.startOpen||this.config.behavior.autoOpen){var n=document.getElementById("agent-panel");n&&(this.isOpen=!0,n.classList.add("open"))}},[{key:"mergeWithDefaults",value:function(e){var t,n,o,i,c,s,l,u,d,f,p,g,v,h,y,b,m,w,k,x,S,C,j,O,E,I,P,B,_,T,F,R,A,D,M,L,H,U,z,K,N,W,V,G,$,q,Q,Y,J,X,Z,ee,te,ne,oe=e.position||"bottom-right";if("string"==typeof oe){var re=oe.split("-");oe={vertical:re[0]||"bottom",horizontal:re[1]||"right",offset:e.positionOffset||{x:20,y:20}}}var ie=e.primaryColor||(null===(t=e.button)||void 0===t?void 0:t.primaryColor)||"#4F46E5";return a({agentId:e.agentId,appId:e.appId,getSessionUrl:e.getSessionUrl,websocketUrl:e.websocketUrl,demo:!1!==e.demo,direction:e.direction||"ltr",icon:a({type:(null===(n=e.icon)||void 0===n?void 0:n.type)||"microphone",customImage:(null===(o=e.icon)||void 0===o?void 0:o.customImage)||null,emoji:(null===(i=e.icon)||void 0===i?void 0:i.emoji)||"üé§",text:(null===(c=e.icon)||void 0===c?void 0:c.text)||"AI",size:(null===(s=e.icon)||void 0===s?void 0:s.size)||"medium",backgroundColor:(null===(l=e.icon)||void 0===l?void 0:l.backgroundColor)||null},e.icon),position:a({vertical:oe.vertical||"bottom",horizontal:oe.horizontal||"right",offset:oe.offset||{x:20,y:20}},"object"===r(e.position)?e.position:{}),button:a({size:(null===(u=e.button)||void 0===u?void 0:u.size)||"medium",shape:(null===(d=e.button)||void 0===d?void 0:d.shape)||"circle",backgroundColor:(null===(f=e.button)||void 0===f?void 0:f.backgroundColor)||(null===(p=e.icon)||void 0===p?void 0:p.backgroundColor)||ie,hoverColor:(null===(g=e.button)||void 0===g?void 0:g.hoverColor)||"#7C3AED",shadow:!1!==(null===(v=e.button)||void 0===v?void 0:v.shadow),shadowColor:(null===(h=e.button)||void 0===h?void 0:h.shadowColor)||"rgba(0,0,0,0.15)",primaryColor:(null===(y=e.button)||void 0===y?void 0:y.backgroundColor)||(null===(b=e.icon)||void 0===b?void 0:b.backgroundColor)||ie},e.button),panel:a({width:(null===(m=e.panel)||void 0===m?void 0:m.width)||350,height:(null===(w=e.panel)||void 0===w?void 0:w.height)||500,borderRadius:(null===(k=e.panel)||void 0===k?void 0:k.borderRadius)||12,backgroundColor:(null===(x=e.panel)||void 0===x?void 0:x.backgroundColor)||"#FFFFFF",backdropFilter:(null===(S=e.panel)||void 0===S?void 0:S.backdropFilter)||null,border:(null===(C=e.panel)||void 0===C?void 0:C.border)||"1px solid rgba(0,0,0,0.1)",micButtonColor:(null===(j=e.panel)||void 0===j?void 0:j.micButtonColor)||ie,micButtonActiveColor:(null===(O=e.panel)||void 0===O?void 0:O.micButtonActiveColor)||"#EF4444",micButtonHint:a({text:(null===(E=e.panel)||void 0===E||null===(E=E.micButtonHint)||void 0===E?void 0:E.text)||"Click the button to start voice conversation",color:(null===(I=e.panel)||void 0===I||null===(I=I.micButtonHint)||void 0===I?void 0:I.color)||"#6B7280",fontSize:(null===(P=e.panel)||void 0===P||null===(P=P.micButtonHint)||void 0===P?void 0:P.fontSize)||"12px"},null===(B=e.panel)||void 0===B?void 0:B.micButtonHint)},e.panel),header:a({title:(null===(_=e.header)||void 0===_?void 0:_.title)||"Voice Assistant",showTitle:!1!==(null===(T=e.header)||void 0===T?void 0:T.showTitle),backgroundColor:(null===(F=e.header)||void 0===F?void 0:F.backgroundColor)||(null===(R=e.button)||void 0===R?void 0:R.backgroundColor)||ie,textColor:(null===(A=e.header)||void 0===A?void 0:A.textColor)||"#FFFFFF",showCloseButton:!1!==(null===(D=e.header)||void 0===D?void 0:D.showCloseButton)},e.header),messages:a({userBackgroundColor:(null===(M=e.messages)||void 0===M?void 0:M.userBackgroundColor)||"#E5E7EB",agentBackgroundColor:(null===(L=e.messages)||void 0===L?void 0:L.agentBackgroundColor)||"#F3F4F6",systemBackgroundColor:(null===(H=e.messages)||void 0===H?void 0:H.systemBackgroundColor)||"#DCFCE7",errorBackgroundColor:(null===(U=e.messages)||void 0===U?void 0:U.errorBackgroundColor)||"#FEE2E2",textColor:(null===(z=e.messages)||void 0===z?void 0:z.textColor)||"#1F2937",fontSize:(null===(K=e.messages)||void 0===K?void 0:K.fontSize)||"14px",borderRadius:(null===(N=e.messages)||void 0===N?void 0:N.borderRadius)||8},e.messages),animation:a({enableHover:!1!==(null===(W=e.animation)||void 0===W?void 0:W.enableHover),enablePulse:!1!==(null===(V=e.animation)||void 0===V?void 0:V.enablePulse),enableSlide:!1!==(null===(G=e.animation)||void 0===G?void 0:G.enableSlide),duration:(null===($=e.animation)||void 0===$?void 0:$.duration)||.3},e.animation),behavior:a({autoOpen:(null===(q=e.behavior)||void 0===q?void 0:q.autoOpen)||!1,startOpen:(null===(Q=e.behavior)||void 0===Q?void 0:Q.startOpen)||!1,hidden:(null===(Y=e.behavior)||void 0===Y?void 0:Y.hidden)||!1,autoConnect:(null===(J=e.behavior)||void 0===J?void 0:J.autoConnect)||!1,showWelcomeMessage:!1!==(null===(X=e.behavior)||void 0===X?void 0:X.showWelcomeMessage),welcomeMessage:(null===(Z=e.behavior)||void 0===Z?void 0:Z.welcomeMessage)||"Hello! How can I help you today?"},e.behavior),accessibility:a({ariaLabel:(null===(ee=e.accessibility)||void 0===ee?void 0:ee.ariaLabel)||"Voice Assistant",ariaDescription:(null===(te=e.accessibility)||void 0===te?void 0:te.ariaDescription)||"Click to open voice assistant",keyboardNavigation:!1!==(null===(ne=e.accessibility)||void 0===ne?void 0:ne.keyboardNavigation)},e.accessibility),customStyles:e.customStyles||"",variables:e.variables||{},primaryColor:ie},"string"==typeof e.position?{positionString:e.position}:{})}},{key:"setupEventHandlers",value:function(){var e=this;this.sdk.onConnected=function(){e.updateStatus("connected"),e.config.behavior.showWelcomeMessage&&e.addMessage("system",e.config.behavior.welcomeMessage)},this.sdk.onDisconnected=function(){e.updateStatus("disconnected"),e.isActive=!1,e.updateMicButtonState(!1),e.showError("Conversation ended. Click to start a new conversation.")},this.sdk.onError=function(t){e.showError(t.message)},this.sdk.onTranscript=function(t){e.addMessage("user",t)},this.sdk.onAgentSpeaking=function(t){t?e.showAgentThinking():e.hideAgentThinking()}}},{key:"createWidget",value:function(){var e=document.createElement("div");if(e.id="agent-widget",e.innerHTML=this.generateWidgetHTML(),document.body.appendChild(e),this.setupWidgetEvents(),this.config.behavior.startOpen||this.config.behavior.autoOpen){var t=document.getElementById("agent-panel");t&&(this.isOpen=!0,t.classList.add("open"))}}},{key:"generateWidgetHTML",value:function(){this.config.position;var e=this.config.button,t=this.config.icon,n=this.config.panel,o=this.config.header,r=(this.config.animation,{small:50,medium:60,large:70,xl:80}[e.size]||60),i={small:20,medium:28,large:36,xl:44}[t.size]||28,a=this.generatePositionStyles(),c=this.generateIconHTML(i);return"\n      <style>\n        ".concat(this.generateCSS(a,r,i),"\n        ").concat(this.config.customStyles,"\n      </style>\n      \n      ").concat(this.config.behavior.hidden?"":'\n      <button id="agent-button" \n              aria-label="'.concat(this.config.accessibility.ariaLabel,'"\n              aria-description="').concat(this.config.accessibility.ariaDescription,'">\n        ').concat(c,"\n      </button>\n      "),'\n      \n      <div id="agent-panel">\n        ').concat(o.showTitle?'\n          <div id="agent-header" style="direction: '.concat(this.config.direction,';">\n            ').concat("rtl"===this.config.direction?"\n              ".concat(o.showCloseButton?'<button id="agent-close">&times;</button>':"",'\n              <h3 style="margin: 0; color: ').concat(o.textColor,';">').concat(o.title,"</h3>\n            "):'\n              <h3 style="margin: 0; color: '.concat(o.textColor,';">').concat(o.title,"</h3>\n              ").concat(o.showCloseButton?'<button id="agent-close">&times;</button>':"","\n            "),"\n          </div>\n        "):"",'\n        \n        <div id="agent-messages"></div>\n        \n        <div id="agent-controls">\n          <div style="display: flex; flex-direction: column; align-items: center; gap: 8px;">\n            <button id="agent-mic-button" \n                    aria-label="Start/Stop Voice Recording">\n              ').concat(c,"\n            </button>\n            ").concat(n.micButtonHint.text&&n.micButtonHint.text.trim()?'\n              <div id="agent-mic-hint" style="color: '.concat(n.micButtonHint.color,"; font-size: ").concat(n.micButtonHint.fontSize,'; text-align: center; max-width: 200px;">\n                ').concat(n.micButtonHint.text,"\n              </div>\n            "):"","\n          </div>\n        </div>\n      </div>\n    ")}},{key:"generatePositionStyles",value:function(){var e=this.config.position,t=e.offset||{x:20,y:20},n="";return"top"===e.vertical?n+="top: ".concat(t.y,"px;"):"bottom"===e.vertical?n+="bottom: ".concat(t.y,"px;"):"center"===e.vertical&&(n+="top: 50%; transform: translateY(-50%);"),"left"===e.horizontal?n+="left: ".concat(t.x,"px;"):"right"===e.horizontal?n+="right: ".concat(t.x,"px;"):"center"===e.horizontal&&(n+="left: 50%; transform: translateX(-50%);"),n}},{key:"generateIconHTML",value:function(e){var t=this.config.icon;switch(t.type){case"custom":return'<img src="'.concat(t.customImage,'" alt="Voice Assistant" style="width: ').concat(e,"px; height: ").concat(e,'px; object-fit: contain;" />');case"emoji":return'<span style="font-size: '.concat(e,'px; line-height: 1;">').concat(t.emoji,"</span>");case"text":return'<span style="font-size: '.concat(Math.floor(.6*e),'px; font-weight: bold; color: white;">').concat(t.text,"</span>");default:return'<svg viewBox="0 0 24 24" style="width: '.concat(e,"px; height: ").concat(e,'px; fill: white;">\n          <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>\n          <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>\n        </svg>')}}},{key:"generateCSS",value:function(e,t,n){var o=this.config.button,r=this.config.panel,i=this.config.header,a=this.config.messages,c=this.config.animation,s=o.backgroundColor||o.primaryColor,l=i.backgroundColor,u=r.micButtonColor||o.primaryColor,d=r.micButtonActiveColor||"#EF4444";return"\n      #agent-widget {\n        position: fixed;\n        ".concat(e,'\n        z-index: 10000;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n        -webkit-transform: translateZ(0);\n        transform: translateZ(0);\n        will-change: transform;\n      }\n      \n      #agent-button {\n        width: ').concat(t,"px;\n        height: ").concat(t,"px;\n        border-radius: ").concat("circle"===o.shape?"50%":"square"===o.shape?"0":"12px",";\n        background: ").concat(s,";\n        border: none;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all ").concat(c.duration,"s ease;\n        ").concat(o.shadow?"box-shadow: 0 4px 12px ".concat(o.shadowColor,";"):"","\n        touch-action: manipulation;\n        -webkit-tap-highlight-color: transparent;\n        -webkit-touch-callout: none;\n        user-select: none;\n        min-width: 44px;\n        min-height: 44px;\n      }\n      \n      @media (max-width: 768px) {\n        #agent-button {\n          min-width: 56px;\n          min-height: 56px;\n        }\n      }\n      \n      ").concat(c.enableHover?"\n        #agent-button:hover {\n          background: ".concat(o.hoverColor,";\n          transform: scale(1.05);\n          ").concat(o.shadow?"box-shadow: 0 8px 20px ".concat(o.shadowColor,";"):"","\n        }\n      "):"","\n      \n      #agent-panel {\n        display: none;\n        position: absolute;\n        bottom: ").concat(this.config.behavior.hidden?20:t+20,"px;\n        ").concat("right"===this.config.position.horizontal?"right: 0;":"left: 0;","\n        width: ").concat(r.width,"px;\n        height: ").concat(r.height,"px;\n        background: ").concat(r.backgroundColor,";\n        border-radius: ").concat(r.borderRadius,"px;\n        border: ").concat(r.border,";\n        flex-direction: column;\n        overflow: hidden;\n        ").concat(r.backdropFilter?"backdrop-filter: ".concat(r.backdropFilter,";"):"","\n        ").concat(c.enableSlide?"transition: all ".concat(c.duration,"s ease;"):"","\n      }\n      \n      #agent-panel.open {\n        display: flex;\n        ").concat(c.enableSlide?"transform: translateY(0); opacity: 1;":"","\n      }\n      \n      #agent-header {\n        background: ").concat(l,";\n        color: ").concat(i.textColor,";\n        padding: 16px;\n        display: flex;\n        flex-direction: ").concat("rtl"===this.config.direction?"row-reverse":"row",";\n        justify-content: space-between;\n        align-items: center;\n        border-radius: ").concat(r.borderRadius,"px ").concat(r.borderRadius,"px 0 0;\n        direction: ").concat(this.config.direction,";\n      }\n      \n      #agent-header h3 {\n        margin: 0;\n        flex: 1;\n        text-align: ").concat("rtl"===this.config.direction?"right":"left",";\n      }\n      \n      #agent-close {\n        background: none;\n        border: none;\n        color: ").concat(i.textColor,";\n        cursor: pointer;\n        font-size: 24px;\n        padding: 0;\n        width: 24px;\n        height: 24px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n      }\n      \n      #agent-messages {\n        flex: 1;\n        overflow-y: auto;\n        padding: 16px;\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n      }\n      \n      .message {\n        padding: 12px;\n        border-radius: ").concat(a.borderRadius,"px;\n        max-width: 80%;\n        font-size: ").concat(a.fontSize,";\n        color: ").concat(a.textColor,";\n      }\n      \n      .message.user {\n        background: ").concat(a.userBackgroundColor,";\n        align-self: flex-end;\n      }\n      \n      .message.agent {\n        background: ").concat(a.agentBackgroundColor,";\n        align-self: flex-start;\n      }\n      \n      .message.system {\n        background: ").concat(a.systemBackgroundColor,";\n        align-self: flex-start;\n        font-style: italic;\n      }\n      \n      .error-message {\n        background: ").concat(a.errorBackgroundColor,";\n        color: #991B1B;\n        padding: 12px;\n        border-radius: ").concat(a.borderRadius,"px;\n        margin: 8px;\n      }\n      \n      #agent-controls {\n        padding: 16px;\n        border-top: 1px solid #E5E7EB;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n      \n      #agent-controls > div {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        gap: 8px;\n      }\n      \n      #agent-mic-hint {\n        text-align: center;\n        line-height: 1.4;\n      }\n      \n      #agent-mic-button {\n        width: ").concat(t,"px;\n        height: ").concat(t,"px;\n        border-radius: ").concat("circle"===o.shape?"50%":"square"===o.shape?"0":"12px",";\n        border: none;\n        background: ").concat(u,";\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all ").concat(c.duration,"s ease;\n      }\n      \n      #agent-mic-button.active {\n        background: ").concat(d,";\n        ").concat(c.enablePulse?"\n          animation: pulse 1.5s infinite;\n        ":"","\n      }\n      \n      ").concat(c.enablePulse?"\n        @keyframes pulse {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.05); }\n        }\n      ":"","\n      \n      .agent-thinking {\n        font-style: italic;\n        color: #6B7280;\n      }\n    ")}},{key:"setupWidgetEvents",value:function(){var e=this,t=document.getElementById("agent-button");t&&(t.onclick=function(){return e.togglePanel()});var n=document.getElementById("agent-close");n&&(n.onclick=function(){return e.togglePanel()}),document.getElementById("agent-mic-button").onclick=function(){return e.toggleVoice()},this.config.accessibility.keyboardNavigation&&this.setupKeyboardNavigation()}},{key:"setupKeyboardNavigation",value:function(){var e=this;document.addEventListener("keydown",function(t){"Escape"===t.key&&e.isOpen&&e.togglePanel()})}},{key:"togglePanel",value:function(){this.isOpen=!this.isOpen,document.getElementById("agent-panel").classList.toggle("open")}},{key:"toggleVoice",value:(t=d(s().m(function e(){var t,n,o,r;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.isActive){e.n=13;break}return e.p=1,console.log("üé§ Starting voice session..."),e.n=2,this.getSignedUrl();case 2:return t=e.v,console.log("üîó Got signed URL:",t),e.n=3,this.sdk.connect(t);case 3:n=e.v,console.log("‚úÖ Connected to WebSocket, connected:",n),o=0;case 4:if(this.sdk.isConnected||!(o<50)){e.n=6;break}return e.n=5,new Promise(function(e){return setTimeout(e,100)});case 5:o++,e.n=4;break;case 6:if(!this.sdk.isConnected){e.n=8;break}return console.log("‚úÖ WebSocket ready, starting listening..."),e.n=7,this.sdk.startListening();case 7:console.log("üé§ Started listening"),this.isActive=!0,this.updateMicButtonState(!0),this.addMessage("system","üé§ Listening... Click mic to stop"),e.n=10;break;case 8:return console.warn("‚ö†Ô∏è Connection not fully ready, but trying to start listening anyway..."),e.n=9,this.sdk.startListening();case 9:console.log("üé§ Started listening"),this.isActive=!0,this.updateMicButtonState(!0),this.addMessage("system","üé§ Listening... Click mic to stop");case 10:e.n=12;break;case 11:e.p=11,r=e.v,console.error("‚ùå Failed to start:",r),this.showError(r.message);case 12:e.n=14;break;case 13:console.log("üîá Stopping voice session..."),this.sdk.stopListening(),this.sdk.disconnect(),this.isActive=!1,this.updateMicButtonState(!1),this.addMessage("system","üîá Stopped listening");case 14:return e.a(2)}},e,this,[[1,11]])})),function(){return t.apply(this,arguments)})},{key:"updateMicButtonState",value:function(e){var t=document.getElementById("agent-mic-button");if(t)if(this.config.icon.size,e){if(t.classList.add("active"),t.title="Click to stop listening","microphone"===this.config.icon.type||"custom"===this.config.icon.type){var n=t.querySelector("svg")||t.querySelector("img");n&&"svg"===n.tagName&&(n.innerHTML='\n            <rect x="6" y="6" width="12" height="12" rx="2"/>\n            <path d="M9 9h6"/>\n          ')}}else if(t.classList.remove("active"),t.title="Click to start listening","microphone"===this.config.icon.type){var o=t.querySelector("svg");o&&(o.innerHTML='\n            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>\n            <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>\n          ')}}},{key:"getSignedUrl",value:(e=d(s().m(function e(){var t,n,o,r,i,a,c;return s().w(function(e){for(;;)switch(e.n){case 0:if(this.config.getSessionUrl){e.n=2;break}if(this.config.agentId){e.n=1;break}throw new Error("agentId is required");case 1:return t=this.config.websocketUrl||"wss://speech.talktopc.com/ws/conv",(n=new URLSearchParams).append("agentId",this.config.agentId),this.config.appId&&n.append("appId",this.config.appId),!1!==this.config.demo&&n.append("demo","true"),e.a(2,"".concat(t,"?").concat(n.toString()));case 2:if("string"!=typeof this.config.getSessionUrl){e.n=6;break}return o={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(o.appId=this.config.appId),e.n=3,fetch(this.config.getSessionUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:if((r=e.v).ok){e.n=4;break}throw new Error("Failed to get session URL: ".concat(r.statusText));case 4:return e.n=5,r.json();case 5:return i=e.v,e.a(2,i.signedUrl||i.wsUrl||i.url);case 6:if("function"!=typeof this.config.getSessionUrl){e.n=8;break}return a={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(a.appId=this.config.appId),e.n=7,this.config.getSessionUrl(a);case 7:return c=e.v,e.a(2,"string"==typeof c?c:c.signedUrl||c.wsUrl||c.url);case 8:throw new Error("getSessionUrl must be a string (backend URL), a function, or omitted (for direct connection with agentId/appId)");case 9:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"addMessage",value:function(e,t){var n=document.getElementById("agent-messages"),o=document.createElement("div");o.className="message ".concat(e),o.textContent=t,n.appendChild(o),n.scrollTop=n.scrollHeight}},{key:"showAgentThinking",value:function(){var e=document.getElementById("agent-messages"),t=document.createElement("div");t.className="message agent agent-thinking",t.id="thinking-indicator",t.textContent="Agent is speaking...",e.appendChild(t),e.scrollTop=e.scrollHeight}},{key:"hideAgentThinking",value:function(){var e=document.getElementById("thinking-indicator");e&&e.remove()}},{key:"showError",value:function(e){var t=document.getElementById("agent-messages"),n=document.createElement("div");n.className="error-message",n.textContent=e,t.appendChild(n)}},{key:"updateStatus",value:function(e){}},{key:"updateConfig",value:function(e){var t,n=a({},this.config);e.panel&&(n.panel=a(a({},this.config.panel),e.panel),e.panel.micButtonHint&&(n.panel.micButtonHint=a(a({},null===(t=this.config.panel)||void 0===t?void 0:t.micButtonHint),e.panel.micButtonHint))),e.button&&(n.button=a(a({},this.config.button),e.button)),e.header&&(n.header=a(a({},this.config.header),e.header)),e.icon&&(n.icon=a(a({},this.config.icon),e.icon)),e.messages&&(n.messages=a(a({},this.config.messages),e.messages)),void 0!==e.direction&&(n.direction=e.direction),Object.keys(e).forEach(function(t){["panel","button","header","icon","messages","direction"].includes(t)||(n[t]=e[t])}),this.config=this.mergeWithDefaults(n);var o=document.getElementById("agent-widget");o&&o.remove(),this.createWidget()}},{key:"destroy",value:function(){var e=document.getElementById("agent-widget");e&&e.remove(),this.sdk&&this.sdk.disconnect()}}]);var e,t}()},"./src/legacy/TextChatWidget.js":(e,t,n)=>{n.r(t),n.d(t,{TextChatWidget:()=>h});var o=n("./src/core/TextChatSDK.js"),r=n("./src/legacy/VoiceInterface.js"),i=n("./src/legacy/TextInterface.js");function a(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var a=o&&o.prototype instanceof l?o:l,u=Object.create(a.prototype);return c(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(c(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,c(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,c(p,"constructor",d),c(d,"constructor",u),u.displayName="GeneratorFunction",c(d,r,"GeneratorFunction"),c(p),c(p,r,"Generator"),c(p,o,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:g}})()}function c(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}c=function(e,t,n,o){function i(t,n){c(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},c(e,t,n,o)}function s(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){s(i,o,r,a,c,"next",e)}function c(e){s(i,o,r,a,c,"throw",e)}a(void 0)})}}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){p(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,v(o.key),o)}}function v(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var h=function(){return e=function e(){var t,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=this.mergeWithDefaults(a),this.sdk=new o.default(this.config),this.isOpen=!1,this.isActive=!1;var c=f(f(f({},this.config),this.config.voice),{},{language:(null===(t=this.config.voice)||void 0===t?void 0:t.language)||this.config.language||"en",websocketUrl:(null===(n=this.config.voice)||void 0===n?void 0:n.websocketUrl)||this.config.websocketUrl||"wss://speech.talktopc.com/ws/conv"});this.voiceInterface=new r.VoiceInterface(c);var s=f(f({},this.config),this.config.text);if(this.textInterface=new i.TextInterface(s,this.sdk),this.setupEventHandlers(),this.createWidget(),this.config.behavior.startOpen||this.config.behavior.autoOpen){var l=document.getElementById("text-chat-panel");l&&(this.isOpen=!0,l.classList.add("open"))}},t=[{key:"mergeWithDefaults",value:function(e){var t,n,o,r,i,a,c,s,l,d,p,g,v,h,y,b,m,w,k,x,S,C,j,O,E,I,P,B,_,T,F,R,A,D,M,L,H,U,z,K,N,W,V,G,$,q,Q,Y,J,X,Z,ee,te,ne,oe,re,ie,ae,ce,se,le,ue,de,fe,pe,ge,ve,he,ye,be,me,we,ke,xe,Se,Ce,je,Oe,Ee,Ie,Pe,Be,_e,Te,Fe,Re,Ae,De,Me,Le,He,Ue,ze,Ke,Ne,We,Ve,Ge,$e,qe,Qe,Ye,Je,Xe,Ze,et,tt,nt,ot,rt,it,at,ct,st,lt,ut,dt,ft,pt,gt,vt,ht,yt,bt,mt,wt,kt,xt=e.position||"bottom-right";if("string"==typeof xt){var St=xt.split("-");xt={vertical:St[0]||"bottom",horizontal:St[1]||"right",offset:e.positionOffset||{x:20,y:20}}}var Ct=e.primaryColor||(null===(t=e.button)||void 0===t?void 0:t.primaryColor)||"#4F46E5",jt=(null===(n=e.header)||void 0===n?void 0:n.backgroundColor)||(null===(o=e.button)||void 0===o?void 0:o.backgroundColor)||Ct;return f({agentId:e.agentId,appId:e.appId,getSessionUrl:e.getSessionUrl,websocketUrl:e.websocketUrl,demo:!1!==e.demo,direction:e.direction||"ltr",language:e.language||"en",icon:f({type:(null===(r=e.icon)||void 0===r?void 0:r.type)||"chat",customImage:(null===(i=e.icon)||void 0===i?void 0:i.customImage)||null,emoji:(null===(a=e.icon)||void 0===a?void 0:a.emoji)||"üí¨",text:(null===(c=e.icon)||void 0===c?void 0:c.text)||"AI",size:(null===(s=e.icon)||void 0===s?void 0:s.size)||"medium",backgroundColor:(null===(l=e.icon)||void 0===l?void 0:l.backgroundColor)||null},e.icon),position:f({vertical:xt.vertical||"bottom",horizontal:xt.horizontal||"right",offset:xt.offset||{x:20,y:20}},"object"===u(e.position)?e.position:{}),button:f({size:(null===(d=e.button)||void 0===d?void 0:d.size)||"medium",shape:(null===(p=e.button)||void 0===p?void 0:p.shape)||"circle",backgroundColor:(null===(g=e.button)||void 0===g?void 0:g.backgroundColor)||(null===(v=e.icon)||void 0===v?void 0:v.backgroundColor)||Ct,hoverColor:(null===(h=e.button)||void 0===h?void 0:h.hoverColor)||"#7C3AED",shadow:!1!==(null===(y=e.button)||void 0===y?void 0:y.shadow),shadowColor:(null===(b=e.button)||void 0===b?void 0:b.shadowColor)||"rgba(0,0,0,0.15)",primaryColor:(null===(m=e.button)||void 0===m?void 0:m.backgroundColor)||(null===(w=e.icon)||void 0===w?void 0:w.backgroundColor)||Ct},e.button),panel:f({width:(null===(k=e.panel)||void 0===k?void 0:k.width)||350,height:(null===(x=e.panel)||void 0===x?void 0:x.height)||500,borderRadius:(null===(S=e.panel)||void 0===S?void 0:S.borderRadius)||12,backgroundColor:(null===(C=e.panel)||void 0===C?void 0:C.backgroundColor)||"#FFFFFF",backdropFilter:(null===(j=e.panel)||void 0===j?void 0:j.backdropFilter)||null,border:(null===(O=e.panel)||void 0===O?void 0:O.border)||"1px solid rgba(0,0,0,0.1)"},e.panel),voice:f({micButtonColor:(null===(E=e.voice)||void 0===E?void 0:E.micButtonColor)||(null===(I=e.panel)||void 0===I?void 0:I.micButtonColor)||Ct,micButtonActiveColor:(null===(P=e.voice)||void 0===P?void 0:P.micButtonActiveColor)||(null===(B=e.panel)||void 0===B?void 0:B.micButtonActiveColor)||"#EF4444",micButtonHint:f(f({text:(null===(_=e.voice)||void 0===_||null===(_=_.micButtonHint)||void 0===_?void 0:_.text)||(null===(T=e.panel)||void 0===T||null===(T=T.micButtonHint)||void 0===T?void 0:T.text)||"Click the button to start voice conversation",color:(null===(F=e.voice)||void 0===F||null===(F=F.micButtonHint)||void 0===F?void 0:F.color)||(null===(R=e.panel)||void 0===R||null===(R=R.micButtonHint)||void 0===R?void 0:R.color)||"#6B7280",fontSize:(null===(A=e.voice)||void 0===A||null===(A=A.micButtonHint)||void 0===A?void 0:A.fontSize)||(null===(D=e.panel)||void 0===D||null===(D=D.micButtonHint)||void 0===D?void 0:D.fontSize)||"12px"},null===(M=e.voice)||void 0===M?void 0:M.micButtonHint),null===(L=e.panel)||void 0===L?void 0:L.micButtonHint),avatarBackgroundColor:(null===(H=e.voice)||void 0===H?void 0:H.avatarBackgroundColor)||"#667eea",avatarActiveBackgroundColor:(null===(U=e.voice)||void 0===U?void 0:U.avatarActiveBackgroundColor)||"#667eea",statusTitleColor:(null===(z=e.voice)||void 0===z?void 0:z.statusTitleColor)||"#1e293b",statusSubtitleColor:(null===(K=e.voice)||void 0===K?void 0:K.statusSubtitleColor)||"#64748b",startCallButtonColor:(null===(N=e.voice)||void 0===N?void 0:N.startCallButtonColor)||"#667eea",startCallButtonTextColor:(null===(W=e.voice)||void 0===W?void 0:W.startCallButtonTextColor)||"#FFFFFF",transcriptBackgroundColor:(null===(V=e.voice)||void 0===V?void 0:V.transcriptBackgroundColor)||"#FFFFFF",transcriptTextColor:(null===(G=e.voice)||void 0===G?void 0:G.transcriptTextColor)||"#1e293b",transcriptLabelColor:(null===($=e.voice)||void 0===$?void 0:$.transcriptLabelColor)||"#94a3b8",controlButtonColor:(null===(q=e.voice)||void 0===q?void 0:q.controlButtonColor)||"#FFFFFF",controlButtonSecondaryColor:(null===(Q=e.voice)||void 0===Q?void 0:Q.controlButtonSecondaryColor)||"#64748b",endCallButtonColor:(null===(Y=e.voice)||void 0===Y?void 0:Y.endCallButtonColor)||"#ef4444",language:(null===(J=e.voice)||void 0===J?void 0:J.language)||e.language||"en",websocketUrl:(null===(X=e.voice)||void 0===X?void 0:X.websocketUrl)||e.websocketUrl},e.voice),text:f({sendButtonColor:(null===(Z=e.text)||void 0===Z?void 0:Z.sendButtonColor)||(null===(ee=e.panel)||void 0===ee?void 0:ee.sendButtonColor)||Ct,sendButtonHoverColor:(null===(te=e.text)||void 0===te?void 0:te.sendButtonHoverColor)||(null===(ne=e.panel)||void 0===ne?void 0:ne.sendButtonHoverColor)||"#7C3AED",sendButtonActiveColor:(null===(oe=e.text)||void 0===oe?void 0:oe.sendButtonActiveColor)||(null===(re=e.panel)||void 0===re?void 0:re.sendButtonActiveColor)||"#059669",sendButtonText:(null===(ie=e.text)||void 0===ie?void 0:ie.sendButtonText)||(null===(ae=e.panel)||void 0===ae?void 0:ae.sendButtonText)||"‚û§",sendButtonTextColor:(null===(ce=e.text)||void 0===ce?void 0:ce.sendButtonTextColor)||(null===(se=e.panel)||void 0===se?void 0:se.sendButtonTextColor)||"#FFFFFF",sendButtonFontSize:(null===(le=e.text)||void 0===le?void 0:le.sendButtonFontSize)||(null===(ue=e.panel)||void 0===ue?void 0:ue.sendButtonFontSize)||"18px",sendButtonFontWeight:(null===(de=e.text)||void 0===de?void 0:de.sendButtonFontWeight)||(null===(fe=e.panel)||void 0===fe?void 0:fe.sendButtonFontWeight)||"500",sendButtonHint:f(f({text:(null===(pe=e.text)||void 0===pe||null===(pe=pe.sendButtonHint)||void 0===pe?void 0:pe.text)||(null===(ge=e.panel)||void 0===ge||null===(ge=ge.sendButtonHint)||void 0===ge?void 0:ge.text)||"",color:(null===(ve=e.text)||void 0===ve||null===(ve=ve.sendButtonHint)||void 0===ve?void 0:ve.color)||(null===(he=e.panel)||void 0===he||null===(he=he.sendButtonHint)||void 0===he?void 0:he.color)||"#6B7280",fontSize:(null===(ye=e.text)||void 0===ye||null===(ye=ye.sendButtonHint)||void 0===ye?void 0:ye.fontSize)||(null===(be=e.panel)||void 0===be||null===(be=be.sendButtonHint)||void 0===be?void 0:be.fontSize)||"12px"},null===(me=e.text)||void 0===me?void 0:me.sendButtonHint),null===(we=e.panel)||void 0===we?void 0:we.sendButtonHint),inputPlaceholder:(null===(ke=e.text)||void 0===ke?void 0:ke.inputPlaceholder)||(null===(xe=e.panel)||void 0===xe?void 0:xe.inputPlaceholder)||"Type your message...",inputBorderColor:(null===(Se=e.text)||void 0===Se?void 0:Se.inputBorderColor)||(null===(Ce=e.panel)||void 0===Ce?void 0:Ce.inputBorderColor)||"#E5E7EB",inputFocusColor:(null===(je=e.text)||void 0===je?void 0:je.inputFocusColor)||(null===(Oe=e.panel)||void 0===Oe?void 0:Oe.inputFocusColor)||Ct,inputBackgroundColor:(null===(Ee=e.text)||void 0===Ee?void 0:Ee.inputBackgroundColor)||(null===(Ie=e.panel)||void 0===Ie?void 0:Ie.inputBackgroundColor)||"#FFFFFF",inputTextColor:(null===(Pe=e.text)||void 0===Pe?void 0:Pe.inputTextColor)||(null===(Be=e.panel)||void 0===Be?void 0:Be.inputTextColor)||"#1F2937",inputFontSize:(null===(_e=e.text)||void 0===_e?void 0:_e.inputFontSize)||(null===(Te=e.panel)||void 0===Te?void 0:Te.inputFontSize)||"14px",inputBorderRadius:(null===(Fe=e.text)||void 0===Fe?void 0:Fe.inputBorderRadius)||(null===(Re=e.panel)||void 0===Re?void 0:Re.inputBorderRadius)||20,inputPadding:(null===(Ae=e.text)||void 0===Ae?void 0:Ae.inputPadding)||(null===(De=e.panel)||void 0===De?void 0:De.inputPadding)||"6px 14px"},e.text),landing:f({backgroundColor:(null===(Me=e.landing)||void 0===Me?void 0:Me.backgroundColor)||"linear-gradient(180deg, #f8fafc 0%, #e0e7ff 100%)",logo:(null===(Le=e.landing)||void 0===Le?void 0:Le.logo)||"ü§ñ",title:(null===(He=e.landing)||void 0===He?void 0:He.title)||null,titleColor:(null===(Ue=e.landing)||void 0===Ue?void 0:Ue.titleColor)||"#1e293b",modeCardBackgroundColor:(null===(ze=e.landing)||void 0===ze?void 0:ze.modeCardBackgroundColor)||"#FFFFFF",modeCardBorderColor:(null===(Ke=e.landing)||void 0===Ke?void 0:Ke.modeCardBorderColor)||"#E2E8F0",modeCardHoverBorderColor:(null===(Ne=e.landing)||void 0===Ne?void 0:Ne.modeCardHoverBorderColor)||jt,modeCardIconBackgroundColor:(null===(We=e.landing)||void 0===We?void 0:We.modeCardIconBackgroundColor)||jt,modeCardTitleColor:(null===(Ve=e.landing)||void 0===Ve?void 0:Ve.modeCardTitleColor)||"#111827",voiceCardIcon:(null===(Ge=e.landing)||void 0===Ge?void 0:Ge.voiceCardIcon)||"üé§",textCardIcon:(null===($e=e.landing)||void 0===$e?void 0:$e.textCardIcon)||"üí¨"},e.landing),header:f({title:(null===(qe=e.header)||void 0===qe?void 0:qe.title)||"Chat Assistant",showTitle:!1!==(null===(Qe=e.header)||void 0===Qe?void 0:Qe.showTitle),backgroundColor:(null===(Ye=e.header)||void 0===Ye?void 0:Ye.backgroundColor)||(null===(Je=e.button)||void 0===Je?void 0:Je.backgroundColor)||Ct,textColor:(null===(Xe=e.header)||void 0===Xe?void 0:Xe.textColor)||"#FFFFFF",showCloseButton:!1!==(null===(Ze=e.header)||void 0===Ze?void 0:Ze.showCloseButton)},e.header),messages:f({userBackgroundColor:(null===(et=e.messages)||void 0===et?void 0:et.userBackgroundColor)||"#E5E7EB",agentBackgroundColor:(null===(tt=e.messages)||void 0===tt?void 0:tt.agentBackgroundColor)||"#F3F4F6",systemBackgroundColor:(null===(nt=e.messages)||void 0===nt?void 0:nt.systemBackgroundColor)||"#DCFCE7",errorBackgroundColor:(null===(ot=e.messages)||void 0===ot?void 0:ot.errorBackgroundColor)||"#FEE2E2",textColor:(null===(rt=e.messages)||void 0===rt?void 0:rt.textColor)||"#1F2937",fontSize:(null===(it=e.messages)||void 0===it?void 0:it.fontSize)||"14px",borderRadius:(null===(at=e.messages)||void 0===at?void 0:at.borderRadius)||8},e.messages),animation:f({enableHover:!1!==(null===(ct=e.animation)||void 0===ct?void 0:ct.enableHover),enablePulse:!1!==(null===(st=e.animation)||void 0===st?void 0:st.enablePulse),enableSlide:!1!==(null===(lt=e.animation)||void 0===lt?void 0:lt.enableSlide),duration:(null===(ut=e.animation)||void 0===ut?void 0:ut.duration)||.3},e.animation),behavior:f({autoOpen:(null===(dt=e.behavior)||void 0===dt?void 0:dt.autoOpen)||!1,startOpen:(null===(ft=e.behavior)||void 0===ft?void 0:ft.startOpen)||!1,hidden:(null===(pt=e.behavior)||void 0===pt?void 0:pt.hidden)||!1,autoConnect:(null===(gt=e.behavior)||void 0===gt?void 0:gt.autoConnect)||!1,showWelcomeMessage:!1!==(null===(vt=e.behavior)||void 0===vt?void 0:vt.showWelcomeMessage),welcomeMessage:(null===(ht=e.behavior)||void 0===ht?void 0:ht.welcomeMessage)||"Hello! How can I help you today?",enableVoiceMode:void 0===(null===(yt=e.behavior)||void 0===yt?void 0:yt.enableVoiceMode)||e.behavior.enableVoiceMode,mode:(null===(bt=e.behavior)||void 0===bt?void 0:bt.mode)||"unified"},e.behavior),accessibility:f({ariaLabel:(null===(mt=e.accessibility)||void 0===mt?void 0:mt.ariaLabel)||"Chat Assistant",ariaDescription:(null===(wt=e.accessibility)||void 0===wt?void 0:wt.ariaDescription)||"Click to open chat assistant",keyboardNavigation:!1!==(null===(kt=e.accessibility)||void 0===kt?void 0:kt.keyboardNavigation)},e.accessibility),customStyles:e.customStyles||"",variables:e.variables||{},forceConversationId:e.forceConversationId,primaryColor:Ct},"string"==typeof e.position?{positionString:e.position}:{})}},{key:"setupEventHandlers",value:function(){var e=this;this.sdk.on("error",function(t){e.textInterface.showError(t.message||t),e.textInterface.stopStreamingState()}),this.sdk.on("chunk",function(t){e.textInterface.appendStreamingChunk(t)}),this.sdk.on("done",function(t){var n=t.text;e.textInterface.finalizeStreaming(n)})}},{key:"createWidget",value:function(){var e=document.createElement("div");if(e.id="text-chat-widget",e.innerHTML=this.generateWidgetHTML(),document.body.appendChild(e),this.setupWidgetEvents(),this.config.behavior.startOpen||this.config.behavior.autoOpen){var t=document.getElementById("text-chat-panel");t&&(this.isOpen=!0,t.classList.add("open"))}}},{key:"generateWidgetHTML",value:function(){this.config.position;var e=this.config.button,t=this.config.icon,n=(this.config.panel,this.config.header),o=(this.config.animation,{small:50,medium:60,large:70,xl:80}[e.size]||60),r={small:20,medium:28,large:36,xl:44}[t.size]||28,i=this.generatePositionStyles(),a=this.generateIconHTML(r),c=this.config.behavior.mode||"unified",s="unified"===c,l="unified"===c||"voice-only"===c,u="unified"===c||"text-only"===c;return"\n      <style>\n        ".concat(this.generateCSS(i,o,r),"\n        ").concat(this.config.customStyles,"\n      </style>\n      \n      ").concat(this.config.behavior.hidden?"":'\n      <button id="text-chat-button" \n              aria-label="'.concat(this.config.accessibility.ariaLabel,'"\n              aria-description="').concat(this.config.accessibility.ariaDescription,'">\n        ').concat(a,"\n      </button>\n      "),'\n      \n      <div id="text-chat-panel">\n        <div class="widget-shell">\n          <div class="panel-inner widget-container" style="direction: ').concat(this.config.direction,';">\n          <div class="widget-header">\n            <div>\n              <div class="header-title">').concat(n.title,'</div>\n              <div class="header-status">\n                <span class="status-dot"></span>\n                <span>').concat("rtl"===this.config.direction?"◊û◊ß◊ï◊ï◊ü":"Online",'</span>\n              </div>\n            </div>\n            <div style="display: flex; gap: 12px; align-items: center;">\n              <button class="new-chat-btn header-icon" id="newChatBtn" title="Start new chat">\n                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">\n                  <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>\n                </svg>\n              </button>\n              ').concat(s?'<button class="back-btn header-icon" id="backBtn"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></button>':"","\n              ").concat(n.showCloseButton?'<button class="close-btn header-icon" id="text-chat-close"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg></button>':"","\n            </div>\n          </div>\n\n          ").concat(s?'\n          <div class="landing-screen" id="landingScreen">\n            <div class="landing-logo">ü§ñ</div>\n            <div class="landing-title">'.concat("rtl"===this.config.direction?"◊ê◊ô◊ö ◊™◊®◊¶◊î ◊ú◊™◊ß◊©◊®?":"How would you like to communicate?",'</div>\n            <div class="mode-selection">\n              ').concat(l?'<div class="mode-card voice" id="mode-card-voice">\n                <div class="mode-card-icon">üé§</div>\n                <div class="mode-card-title">'.concat("rtl"===this.config.direction?"◊©◊ô◊ó◊î ◊ß◊ï◊ú◊ô◊™":"Voice Call","</div>\n              </div>"):"","\n              ").concat(u?'<div class="mode-card text" id="mode-card-text">\n                <div class="mode-card-icon">üí¨</div>\n                <div class="mode-card-title">'.concat("rtl"===this.config.direction?"◊¶'◊ê◊ò ◊ò◊ß◊°◊ò":"Text Chat","</div>\n              </div>"):"","\n            </div>\n          </div>"):"","\n\n          ").concat(l?this.voiceInterface.generateHTML():"","\n          ").concat(u?this.textInterface.generateHTML():"","\n          </div>\n        </div>\n      </div>\n    ")}},{key:"generatePositionStyles",value:function(){var e=this.config.position,t=e.offset||{x:20,y:20},n="";return"top"===e.vertical?n+="top: ".concat(t.y,"px;"):"bottom"===e.vertical?n+="bottom: ".concat(t.y,"px;"):"center"===e.vertical&&(n+="top: 50%; transform: translateY(-50%);"),"left"===e.horizontal?n+="left: ".concat(t.x,"px;"):"right"===e.horizontal?n+="right: ".concat(t.x,"px;"):"center"===e.horizontal&&(n+="left: 50%; transform: translateX(-50%);"),n}},{key:"generateIconHTML",value:function(e){var t=this.config.icon;switch(t.type){case"custom":return'<img src="'.concat(t.customImage,'" alt="Chat Assistant" style="width: ').concat(e,"px; height: ").concat(e,'px; object-fit: contain;" />');case"emoji":return'<span style="font-size: '.concat(e,'px; line-height: 1;">').concat(t.emoji,"</span>");case"text":return'<span style="font-size: '.concat(Math.floor(.6*e),'px; font-weight: bold; color: white;">').concat(t.text,"</span>");default:return'<svg viewBox="0 0 24 24" style="width: '.concat(e,"px; height: ").concat(e,'px; fill: white;">\n          <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/>\n        </svg>')}}},{key:"generateCSS",value:function(e,t,n){var o,r,i,a,c,s,l,u=this.config.button,d=this.config.panel,f=this.config.header,p=(this.config.messages,this.config.animation),g=(u.backgroundColor||u.primaryColor,f.backgroundColor),v=(d.sendButtonColor||u.primaryColor,d.sendButtonHoverColor,d.sendButtonActiveColor,this.config.behavior.mode||"unified"),h="unified"===v||"voice-only"===v,y="unified"===v||"text-only"===v;return"\n      #text-chat-widget {\n        position: fixed;\n        ".concat(e,'\n        z-index: 10000;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;\n        -webkit-transform: translateZ(0);\n        transform: translateZ(0);\n        will-change: transform;\n      }\n      \n      #text-chat-button {\n        width: ').concat(t,"px;\n        height: ").concat(t,"px;\n        border-radius: ").concat("circle"===u.shape?"50%":"square"===u.shape?"0":"12px",";\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        border: none;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all ").concat(p.duration,"s ease;\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n        touch-action: manipulation;\n        -webkit-tap-highlight-color: transparent;\n        -webkit-touch-callout: none;\n        user-select: none;\n        min-width: 44px;\n        min-height: 44px;\n      }\n      \n      @media (max-width: 768px) {\n        #text-chat-button {\n          min-width: 56px;\n          min-height: 56px;\n        }\n        \n        #text-chat-panel {\n          width: calc(100vw - 20px) !important;\n          max-width: ").concat(d.width,"px;\n          max-height: calc(100vh - 120px) !important;\n          left: 10px !important;\n          right: 10px !important;\n        }\n        \n        #text-chat-input {\n          font-size: 16px !important; /* Prevents iOS zoom on focus */\n        }\n        \n        #text-chat-send {\n          min-width: 60px;\n          min-height: 44px;\n        }\n      }\n      \n      ").concat(p.enableHover?"\n        #text-chat-button:hover {\n          background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);\n          transform: scale(1.05);\n          box-shadow: 0 8px 20px rgba(102, 126, 234, 0.5);\n        }\n      ":"","\n      \n      #text-chat-panel {\n        display: none;\n        position: fixed;\n        bottom: calc(").concat(t,"px + 20px);\n        ").concat("right"===this.config.position.horizontal?"right: 20px;":"left: 20px;","\n        width: ").concat(d.width,"px;\n        max-width: calc(100vw - 40px);\n        height: ").concat(d.height,"px;\n        max-height: calc(100vh - ").concat(t,"px - 40px);\n        background: transparent;\n        border-radius: ").concat(d.borderRadius,"px;\n        border: none;\n        flex-direction: column;\n        overflow: hidden;\n        ").concat(d.backdropFilter?"backdrop-filter: ".concat(d.backdropFilter,";"):"","\n        ").concat(p.enableSlide?"transition: all ".concat(p.duration,"s ease;"):"","\n      }\n      \n      #text-chat-panel.open {\n        display: flex;\n        ").concat(p.enableSlide?"transform: translateY(0); opacity: 1;":"","\n      }\n\n      /* Shell for gradient border/background */\n      .widget-shell { width: 100%; height: 100%; padding: 0; border-radius: ").concat(d.borderRadius,"px; background: transparent; box-shadow: 0 20px 60px rgba(0,0,0,0.15); overflow: hidden; display: flex; flex-direction: column; }\n      .panel-inner { width: 100%; height: 100%; background: #ffffff; border-radius: ").concat(d.borderRadius,"px; overflow: hidden; display:flex; flex-direction: column; padding: 0; box-sizing: border-box; }\n\n      /* New structure styles matching provided design */\n      #text-chat-panel .widget-container {\n        width: 100%; height: 100%; min-height: 0; background: #FFFFFF; overflow: hidden; display: flex; flex-direction: column; border-radius: ").concat(d.borderRadius,"px;\n      }\n      #text-chat-panel .widget-header {\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: #FFFFFF;\n        padding: 12px 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        border-top-left-radius: ").concat(d.borderRadius,"px;\n        border-top-right-radius: ").concat(d.borderRadius,"px;\n        flex-shrink: 0;\n        min-height: 60px;\n        box-sizing: border-box;\n      }\n      #text-chat-panel .header-title { font-size: 16px; font-weight: 600; }\n      #text-chat-panel .header-status { display: flex; align-items: center; gap: 8px; font-size: 12px; opacity: 0.9; }\n      #text-chat-panel .status-dot { width: 8px; height: 8px; background: #4ade80; border-radius: 50%; animation: pulse 2s ease-in-out infinite; }\n      @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }\n      #text-chat-panel .back-btn, #text-chat-panel .close-btn {\n        background: rgba(255,255,255,0.2);\n        border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer;\n        display: flex; align-items: center; justify-content: center;\n      }\n      #text-chat-panel .new-chat-btn { background: rgba(255,255,255,0.2); border: none; color: white; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }\n\n      /* Landing and mode selection (shown only if voice enabled) */\n      .landing-screen { \n        display: none; \n        flex: 1; \n        padding: 20px; \n        background: ").concat((null===(o=this.config.landing)||void 0===o?void 0:o.backgroundColor)||"linear-gradient(180deg, #f8fafc 0%, #e0e7ff 100%)","; \n        align-items: center; \n        justify-content: flex-start; \n        flex-direction: column; \n        gap: 16px; \n        overflow-y: auto; \n        min-height: 0; \n      }\n      .landing-screen.active { display: flex; }\n      .landing-logo { font-size: 48px; }\n      .landing-title { \n        font-size: 20px; \n        color: ").concat((null===(r=this.config.landing)||void 0===r?void 0:r.titleColor)||"#1e293b","; \n        font-weight: 700; \n        margin-bottom: 20px; \n      }\n      .mode-selection { display: flex; gap: 16px; width: 100%; justify-content: center; }\n      .mode-card { \n        flex: 1; \n        max-width: 180px; \n        background: ").concat((null===(i=this.config.landing)||void 0===i?void 0:i.modeCardBackgroundColor)||"#FFFFFF","; \n        border: 2px solid ").concat((null===(a=this.config.landing)||void 0===a?void 0:a.modeCardBorderColor)||"#E2E8F0","; \n        border-radius: 20px; \n        padding: 20px 12px; \n        cursor: pointer; \n        display: flex; \n        flex-direction: column; \n        align-items: center; \n        gap: 8px; \n        transition: transform ").concat(p.duration,"s ease, box-shadow ").concat(p.duration,"s ease, border-color ").concat(p.duration,"s ease; \n        box-shadow: 0 4px 12px rgba(0,0,0,0.05); \n      }\n      .mode-card:hover { \n        transform: translateY(-6px); \n        box-shadow: 0 12px 24px rgba(102, 126, 234, 0.2); \n        border-color: ").concat((null===(c=this.config.landing)||void 0===c?void 0:c.modeCardHoverBorderColor)||g,"; \n      }\n      .mode-card-icon { \n        width: 60px; \n        height: 60px; \n        display: flex; \n        align-items: center; \n        justify-content: center; \n        border-radius: 50%; \n        background: ").concat((null===(s=this.config.landing)||void 0===s?void 0:s.modeCardIconBackgroundColor)||g,"; \n        color: #fff; \n        font-size: 32px; \n      }\n      .mode-card-title { \n        color: ").concat((null===(l=this.config.landing)||void 0===l?void 0:l.modeCardTitleColor)||"#111827","; \n        font-weight: 600; \n      }\n\n      ").concat(h?this.voiceInterface.generateCSS():"","\n      ").concat(y?this.textInterface.generateCSS():"","\n      \n      #text-chat-send-hint {\n        text-align: center;\n        line-height: 1.4;\n      }\n      \n      .agent-thinking {\n        font-style: italic;\n        color: #6B7280;\n      }\n    ")}},{key:"setupWidgetEvents",value:function(){var e=this,t=document.getElementById("text-chat-button");t&&(t.onclick=function(){return e.togglePanel()});var n=document.getElementById("text-chat-close");n&&(n.onclick=function(){return e.togglePanel()});var o=this.config.behavior.mode||"unified",r="unified"===o,i="unified"===o||"voice-only"===o,a="unified"===o||"text-only"===o,c=document.getElementById("backBtn"),s=document.getElementById("landingScreen"),l=document.getElementById("mode-card-voice"),u=document.getElementById("mode-card-text"),d=document.getElementById("textInterface"),f=document.getElementById("voiceInterface");r?(c&&(c.onclick=function(){return e.showLanding()}),l&&(l.onclick=function(){return e.showVoice()}),u&&(u.onclick=function(){return e.showText()}),s&&s.classList.add("active"),d&&d.classList.remove("active"),f&&f.classList.remove("active")):"voice-only"===o?(f&&f.classList.add("active"),d&&d.classList.remove("active"),s&&s.classList.remove("active")):"text-only"===o&&(d&&d.classList.add("active"),f&&f.classList.remove("active"),s&&s.classList.remove("active")),i&&this.voiceInterface.setupEventHandlers(),a&&this.textInterface.setupEventHandlers(),this.config.accessibility.keyboardNavigation&&this.setupKeyboardNavigation()}},{key:"startNewChat",value:function(){this.textInterface.startNewChat()}},{key:"showLanding",value:function(){if("unified"===(this.config.behavior.mode||"unified")){var e=document.getElementById("landingScreen"),t=document.getElementById("textInterface"),n=document.getElementById("voiceInterface");e&&e.classList.add("active"),t&&t.classList.remove("active"),n&&n.classList.remove("active")}}},{key:"showText",value:function(){var e=document.getElementById("landingScreen"),t=document.getElementById("voiceInterface");e&&e.classList.remove("active"),t&&t.classList.remove("active"),this.textInterface.show()}},{key:"showVoice",value:function(){var e=document.getElementById("landingScreen"),t=document.getElementById("textInterface"),n=document.getElementById("voiceInterface");e&&e.classList.remove("active"),t&&t.classList.remove("active"),n&&n.classList.add("active")}},{key:"setupKeyboardNavigation",value:function(){var e=this;document.addEventListener("keydown",function(t){"Escape"===t.key&&e.isOpen&&e.togglePanel()})}},{key:"togglePanel",value:function(){this.isOpen=!this.isOpen,document.getElementById("text-chat-panel").classList.toggle("open"),this.isOpen&&setTimeout(function(){var e=document.getElementById("messageInput");e&&e.focus()},100),this.isOpen&&!this.isActive&&this.config.behavior.autoConnect&&this.startChat()}},{key:"startChat",value:(d=l(a().m(function e(){return a().w(function(e){for(;;)switch(e.n){case 0:this.isActive=!0,this.textInterface.setActive(!0);case 1:return e.a(2)}},e,this)})),function(){return d.apply(this,arguments)})},{key:"sendMessage",value:(s=l(a().m(function e(){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.textInterface.sendMessage();case 1:return e.a(2)}},e,this)})),function(){return s.apply(this,arguments)})},{key:"updateSendButtonState",value:function(){this.textInterface.updateSendButtonState()}},{key:"getSignedUrl",value:(c=l(a().m(function e(){var t,n,o,r,i,c,s;return a().w(function(e){for(;;)switch(e.n){case 0:if(this.config.getSessionUrl){e.n=2;break}if(this.config.agentId){e.n=1;break}throw new Error("agentId is required");case 1:return t=this.config.websocketUrl||"wss://backend.talktopc.com/ws/conv",(n=new URLSearchParams).append("agentId",this.config.agentId),this.config.appId&&n.append("appId",this.config.appId),!1!==this.config.demo&&n.append("demo","true"),e.a(2,"".concat(t,"?").concat(n.toString()));case 2:if("string"!=typeof this.config.getSessionUrl){e.n=6;break}return o={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(o.appId=this.config.appId),e.n=3,fetch(this.config.getSessionUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:if((r=e.v).ok){e.n=4;break}throw new Error("Failed to get session URL: ".concat(r.statusText));case 4:return e.n=5,r.json();case 5:return i=e.v,e.a(2,i.signedUrl||i.wsUrl||i.url);case 6:if("function"!=typeof this.config.getSessionUrl){e.n=8;break}return c={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(c.appId=this.config.appId),e.n=7,this.config.getSessionUrl(c);case 7:return s=e.v,e.a(2,"string"==typeof s?s:s.signedUrl||s.wsUrl||s.url);case 8:throw new Error("getSessionUrl must be a string (backend URL), a function, or omitted (for direct connection with agentId/appId)");case 9:return e.a(2)}},e,this)})),function(){return c.apply(this,arguments)})},{key:"addMessage",value:function(e,t){this.textInterface.addMessage(e,t)}},{key:"beginStreaming",value:function(){this.textInterface.beginStreaming()}},{key:"appendStreamingChunk",value:function(e){this.textInterface.appendStreamingChunk(e)}},{key:"finalizeStreaming",value:function(e){this.textInterface.finalizeStreaming(e)}},{key:"stopStreamingState",value:function(){this.textInterface.stopStreamingState()}},{key:"showError",value:function(e){this.textInterface.showError(e)}},{key:"updateStatus",value:function(e){}},{key:"updateConfig",value:function(e){var t,n,o,a,c=f({},this.config);e.panel&&(c.panel=f(f({},this.config.panel),e.panel)),e.voice&&(c.voice=f(f({},this.config.voice),e.voice),e.voice.micButtonHint&&(c.voice.micButtonHint=f(f({},null===(o=this.config.voice)||void 0===o?void 0:o.micButtonHint),e.voice.micButtonHint))),e.text&&(c.text=f(f({},this.config.text),e.text),e.text.sendButtonHint&&(c.text.sendButtonHint=f(f({},null===(a=this.config.text)||void 0===a?void 0:a.sendButtonHint),e.text.sendButtonHint))),e.button&&(c.button=f(f({},this.config.button),e.button)),e.header&&(c.header=f(f({},this.config.header),e.header)),e.icon&&(c.icon=f(f({},this.config.icon),e.icon)),e.messages&&(c.messages=f(f({},this.config.messages),e.messages)),e.animation&&(c.animation=f(f({},this.config.animation),e.animation)),e.behavior&&(c.behavior=f(f({},this.config.behavior),e.behavior)),e.accessibility&&(c.accessibility=f(f({},this.config.accessibility),e.accessibility)),void 0!==e.direction&&(c.direction=e.direction),void 0!==e.language&&(c.language=e.language),Object.keys(e).forEach(function(t){["panel","button","header","icon","messages","direction","voice","text","animation","behavior","accessibility","language"].includes(t)||(c[t]=e[t])}),this.config=this.mergeWithDefaults(c);var s=f(f(f({},this.config),this.config.voice),{},{language:(null===(t=this.config.voice)||void 0===t?void 0:t.language)||this.config.language||"en",websocketUrl:(null===(n=this.config.voice)||void 0===n?void 0:n.websocketUrl)||this.config.websocketUrl||"wss://speech.talktopc.com/ws/conv"});this.voiceInterface=new r.VoiceInterface(s);var l=f(f({},this.config),this.config.text);this.textInterface=new i.TextInterface(l,this.sdk);var u=document.getElementById("text-chat-widget");u&&u.remove(),this.createWidget()}},{key:"destroy",value:function(){var e=document.getElementById("text-chat-widget");e&&e.remove(),this.sdk&&this.sdk.destroy(),this.voiceInterface&&this.voiceInterface.destroy()}},{key:"startVoiceCall",value:(n=l(a().m(function e(){return a().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.voiceInterface.startVoiceCall();case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"endVoiceCall",value:function(){this.voiceInterface.endVoiceCall()}},{key:"toggleMute",value:function(){this.voiceInterface.toggleMute()}},{key:"toggleSpeaker",value:function(){this.voiceInterface.toggleSpeaker()}}],t&&g(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,c,s,d}()},"./src/legacy/TextInterface.js":(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,o,r,a){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return i(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,a),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(i(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,i(p,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,a,"GeneratorFunction"),i(p),i(p,a,"Generator"),i(p,o,function(){return this}),i(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:g}})()}function i(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}i=function(e,t,n,o){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,o)}function a(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function c(e){a(i,o,r,c,s,"next",e)}function s(e){a(i,o,r,c,s,"throw",e)}c(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function l(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}n.r(t),n.d(t,{TextInterface:()=>u});var u=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.sdk=n,this.streamingEl=null,this.hasStartedStreaming=!1,this.isActive=!1},t=[{key:"generateHTML",value:function(){var e,t,n,o,r,i,a,c,s,l=this.config.inputPlaceholder||(null===(e=this.config.panel)||void 0===e?void 0:e.inputPlaceholder)||"Type your message...";return'<div class="text-interface" id="textInterface">\n      <div class="messages-container" id="messagesContainer">\n        <div class="empty-state">\n          <div class="empty-state-icon">üí¨</div>\n          <div class="empty-state-title">'.concat("rtl"===this.config.direction?"◊©◊ú◊ï◊ù! ◊ê◊ô◊ö ◊ê◊§◊©◊® ◊ú◊¢◊ñ◊ï◊®?":"Hello! How can I help?",'</div>\n          <div class="empty-state-text">').concat("rtl"===this.config.direction?"◊©◊ú◊ó ◊î◊ï◊ì◊¢◊î ◊ê◊ï ◊¢◊ë◊ï◊® ◊ú◊û◊¶◊ë ◊ß◊ï◊ú◊ô ◊ú◊©◊ô◊ó◊î ◊ë◊ñ◊û◊ü ◊ê◊û◊™":"Send a message to get started",'</div>\n        </div>\n      </div>\n      <div class="input-container">\n        ').concat("rtl"===this.config.direction?'\n          <button class="send-button" id="sendButton" aria-label="Send message">'.concat(this.config.sendButtonText||"‚û§",'</button>\n          <div class="input-wrapper" style="flex:1;">\n            <textarea class="message-input" id="messageInput" placeholder="').concat(l,'" rows="1"></textarea>\n          </div>\n        '):'\n          <div class="input-wrapper" style="flex:1;">\n            <textarea class="message-input" id="messageInput" placeholder="'.concat(l,'" rows="1"></textarea>\n          </div>\n          <button class="send-button" id="sendButton" aria-label="Send message">').concat(this.config.sendButtonText||"‚û§","</button>\n        "),"\n        ").concat(null!==(t=this.config.sendButtonHint)&&void 0!==t&&t.text||null!==(n=this.config.panel)&&void 0!==n&&null!==(n=n.sendButtonHint)&&void 0!==n&&n.text?'\n          <div class="send-button-hint" style="color: '.concat((null===(o=this.config.sendButtonHint)||void 0===o?void 0:o.color)||(null===(r=this.config.panel)||void 0===r||null===(r=r.sendButtonHint)||void 0===r?void 0:r.color)||"#6B7280","; font-size: ").concat((null===(i=this.config.sendButtonHint)||void 0===i?void 0:i.fontSize)||(null===(a=this.config.panel)||void 0===a||null===(a=a.sendButtonHint)||void 0===a?void 0:a.fontSize)||"12px",'; text-align: center; margin-top: 4px;">\n            ').concat((null===(c=this.config.sendButtonHint)||void 0===c?void 0:c.text)||(null===(s=this.config.panel)||void 0===s||null===(s=s.sendButtonHint)||void 0===s?void 0:s.text),"\n          </div>\n        "):"","\n      </div>\n    </div>")}},{key:"generateCSS",value:function(){var e,t,n,o,r,i,a,c,s,l,u,d,f,p=this.config.messages,g=(this.config.panel,this.config.animation,this.config.sendButtonColor||(null===(e=this.config.panel)||void 0===e?void 0:e.sendButtonColor)||"#667eea"),v=this.config.sendButtonHoverColor||(null===(t=this.config.panel)||void 0===t?void 0:t.sendButtonHoverColor)||"#7C3AED",h=this.config.sendButtonTextColor||(null===(n=this.config.panel)||void 0===n?void 0:n.sendButtonTextColor)||"#FFFFFF",y=(this.config.inputPlaceholder||null===(o=this.config.panel)||void 0===o||o.inputPlaceholder,this.config.inputBorderColor||(null===(r=this.config.panel)||void 0===r?void 0:r.inputBorderColor)||"#E5E7EB"),b=this.config.inputFocusColor||(null===(i=this.config.panel)||void 0===i?void 0:i.inputFocusColor)||g,m=this.config.inputBackgroundColor||(null===(a=this.config.panel)||void 0===a?void 0:a.inputBackgroundColor)||"#FFFFFF",w=this.config.inputTextColor||(null===(c=this.config.panel)||void 0===c?void 0:c.inputTextColor)||"#1F2937",k=this.config.inputFontSize||(null===(s=this.config.panel)||void 0===s?void 0:s.inputFontSize)||"14px",x=this.config.inputBorderRadius||(null===(l=this.config.panel)||void 0===l?void 0:l.inputBorderRadius)||20,S=this.config.inputPadding||(null===(u=this.config.panel)||void 0===u?void 0:u.inputPadding)||"6px 14px";return"\n      /* Messages container using new classes */\n      #messagesContainer { \n        flex: 1; \n        overflow-y: auto; \n        overflow-x: hidden; \n        padding: 20px; \n        background: #f8fafc; \n        display: flex; \n        flex-direction: column; \n        gap: 16px; \n        min-height: 0; \n      }\n      .empty-state { \n        flex: 1; \n        display: flex; \n        flex-direction: column; \n        align-items: center; \n        justify-content: center; \n        gap: 12px; \n        color: #64748b; \n        text-align: center; \n        padding: 20px; \n      }\n      .empty-state-icon { font-size: 48px; opacity: 0.3; }\n      .empty-state-title { font-size: 20px; font-weight: 700; color: #334155; }\n      .empty-state-text { font-size: 13px; max-width: 280px; }\n\n      .text-interface { \n        display: none; \n        flex: 1; \n        flex-direction: column; \n        min-height: 0; \n        overflow: hidden; \n      }\n      .text-interface.active { display: flex; }\n      \n      .message { \n        display: flex; \n        gap: 8px; \n        padding: 4px 0; \n        max-width: 100%; \n        align-items: center; \n      }\n      .message.edge-left { flex-direction: row; }\n      .message.edge-right { flex-direction: row-reverse; }\n      .message-bubble { \n        padding: 12px; \n        border-radius: ".concat(p.borderRadius,"px; \n        max-width: 80%; \n        font-size: ").concat(p.fontSize,"; \n        color: ").concat(p.textColor,"; \n        word-wrap: break-word; \n        text-align: ").concat("rtl"===this.config.direction?"right":"left","; \n      }\n      .message.user { \n        background: ").concat(p.userBackgroundColor,"; \n        align-self: ").concat("rtl"===this.config.direction?"flex-start":"flex-end","; \n      }\n      .message.agent { \n        background: ").concat(p.agentBackgroundColor,"; \n        align-self: ").concat("rtl"===this.config.direction?"flex-end":"flex-start","; \n      }\n      .message .message-bubble { \n        text-align: ").concat("rtl"===this.config.direction?"right":"left","; \n      }\n      .message-avatar { \n        width: 20px; \n        height: 20px; \n        display: flex; \n        align-items: center; \n        justify-content: center; \n        flex-shrink: 0; \n        color: inherit; \n        font-size: 18px; \n        line-height: 1; \n        background: transparent; \n        border: none; \n      }\n      .message-avatar.user { background: transparent; }\n      .message-avatar.agent { background: transparent; }\n      \n      .message.system {\n        background: ").concat(p.systemBackgroundColor,";\n        align-self: flex-start;\n      }\n      .message.error {\n        background: ").concat(p.errorBackgroundColor,";\n        align-self: flex-start;\n      }\n      \n      .input-container {\n        display: flex;\n        gap: 8px;\n        padding: 12px 16px;\n        background: #FFFFFF;\n        border-top: 1px solid #E5E7EB;\n        align-items: flex-end;\n        flex-shrink: 0;\n      }\n      \n      .input-wrapper {\n        position: relative;\n        display: flex;\n        align-items: center;\n      }\n      \n      .message-input {\n        width: 100%;\n        min-height: 32px;\n        max-height: 120px;\n        padding: ").concat(S,";\n        border: 1px solid ").concat(y,";\n        border-radius: ").concat(x,"px;\n        font-size: ").concat(k,";\n        font-family: inherit;\n        line-height: 1.3;\n        resize: none;\n        overflow-y: auto;\n        background: ").concat(m,";\n        color: ").concat(w,";\n        vertical-align: top;\n        margin: 0;\n        display: block;\n        white-space: pre-wrap;\n        word-wrap: break-word;\n        text-align: start;\n        -webkit-appearance: none;\n        appearance: none;\n        box-sizing: border-box;\n      }\n      \n      .message-input:focus {\n        outline: none;\n        border-color: ").concat(b,";\n        background: ").concat("#FFFFFF"===m?"#FFFFFF":m,";\n        box-shadow: 0 0 0 3px ").concat(b,"33;\n      }\n      \n      .message-input::placeholder {\n        color: #9CA3AF;\n      }\n      \n      .send-button {\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        border: none;\n        background: ").concat(g,";\n        color: ").concat(h,";\n        font-size: ").concat(this.config.sendButtonFontSize||(null===(d=this.config.panel)||void 0===d?void 0:d.sendButtonFontSize)||"18px",";\n        font-weight: ").concat(this.config.sendButtonFontWeight||(null===(f=this.config.panel)||void 0===f?void 0:f.sendButtonFontWeight)||"500",";\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        flex-shrink: 0;\n        transition: all 0.2s ease;\n      }\n      \n      .send-button:hover:not(:disabled) {\n        background: ").concat(v,";\n        transform: scale(1.05);\n      }\n      \n      .send-button-hint {\n        width: 100%;\n        text-align: center;\n        margin-top: 4px;\n      }\n      \n      .send-button:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n      \n      .typing-indicator {\n        display: inline-flex;\n        gap: 4px;\n        align-items: center;\n      }\n      \n      .typing-dot {\n        width: 6px;\n        height: 6px;\n        border-radius: 50%;\n        background: #64748b;\n        animation: typingDot 1.4s ease-in-out infinite;\n      }\n      \n      .typing-dot:nth-child(2) { animation-delay: 0.2s; }\n      .typing-dot:nth-child(3) { animation-delay: 0.4s; }\n      \n      @keyframes typingDot {\n        0%, 60%, 100% { transform: translateY(0); opacity: 0.7; }\n        30% { transform: translateY(-8px); opacity: 1; }\n      }\n      \n      .error-message {\n        padding: 12px;\n        background: ").concat(p.errorBackgroundColor,";\n        border-radius: ").concat(p.borderRadius,"px;\n        color: #991B1B;\n        font-size: ").concat(p.fontSize,";\n        margin: 8px 0;\n      }\n    ")}},{key:"setupEventHandlers",value:function(){var e=this,t=document.getElementById("sendButton"),n=document.getElementById("messageInput"),o=document.getElementById("newChatBtn");if(t&&(t.onclick=function(){return e.sendMessage()}),o&&(o.onclick=function(){return e.startNewChat()}),n){n.style.height="32px",n.style.overflow="hidden";var r=function(){n.style.height="auto";var e=Math.min(n.scrollHeight,120);n.style.height=e+"px",n.style.overflowY=e>=120?"auto":"hidden",e>=120&&setTimeout(function(){n.scrollTop=n.scrollHeight},0)};n.addEventListener("input",r),n.addEventListener("keydown",function(t){"Enter"!==t.key||t.shiftKey?"Enter"===t.key&&t.shiftKey&&setTimeout(r,0):(t.preventDefault(),e.sendMessage())})}}},{key:"startNewChat",value:function(){try{localStorage.removeItem("ttp_text_chat_conversation_id")}catch(e){}this.sdk&&(this.sdk.config.conversationId=null);var e=document.getElementById("messagesContainer");e&&(e.innerHTML='\n        <div class="empty-state">\n          <div class="empty-state-icon">üí¨</div>\n          <div class="empty-state-title">'.concat("rtl"===this.config.direction?"◊©◊ú◊ï◊ù! ◊ê◊ô◊ö ◊ê◊§◊©◊® ◊ú◊¢◊ñ◊ï◊®?":"Hello! How can I help?",'</div>\n          <div class="empty-state-text">').concat("rtl"===this.config.direction?"◊©◊ú◊ó ◊î◊ï◊ì◊¢◊î ◊õ◊ì◊ô ◊ú◊î◊™◊ó◊ô◊ú":"Send a message to get started","</div>\n        </div>"));var t=document.getElementById("messageInput");t&&t.focus()}},{key:"show",value:function(){var e=document.getElementById("textInterface");e&&e.classList.add("active"),setTimeout(function(){var e=document.getElementById("messageInput");e&&e.focus()},50)}},{key:"hide",value:function(){var e=document.getElementById("textInterface");e&&e.classList.remove("active")}},{key:"startChat",value:(o=c(r().m(function e(){return r().w(function(e){for(;;)switch(e.n){case 0:this.isActive=!0,this.updateSendButtonState();case 1:return e.a(2)}},e,this)})),function(){return o.apply(this,arguments)})},{key:"sendMessage",value:(n=c(r().m(function e(){var t,n,o;return r().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("messageInput"),n=t.value.trim()){e.n=1;break}return e.a(2);case 1:if(this.isActive){e.n=2;break}return e.n=2,this.startChat();case 2:return this.addMessage("user",n),t.value="",t.style.height="32px",t.style.overflow="hidden",e.p=3,this.beginStreaming(),e.n=4,this.sdk.sendMessage(n);case 4:e.n=6;break;case 5:e.p=5,o=e.v,console.error("‚ùå Failed to send message:",o),this.showError(o.message),this.stopStreamingState();case 6:return e.a(2)}},e,this,[[3,5]])})),function(){return n.apply(this,arguments)})},{key:"updateSendButtonState",value:function(){var e=document.getElementById("sendButton");e&&(e.disabled=!this.isActive)}},{key:"addMessage",value:function(e,t){var n=document.getElementById("messagesContainer");if(n){var o=n.querySelector(".empty-state");o&&o.remove();var r=document.createElement("div"),i="rtl"===this.config.direction?"user"===e?"edge-left":"edge-right":"user"===e?"edge-right":"edge-left";r.className="message ".concat(e," ").concat(i);var a=document.createElement("div");a.className="message-avatar ".concat(e),a.textContent="user"===e?"üë§":"ü§ñ";var c=document.createElement("div");c.className="message-bubble",c.textContent=t,r.appendChild(a),r.appendChild(c),n.appendChild(r),n.scrollTop=n.scrollHeight}}},{key:"beginStreaming",value:function(){var e=document.getElementById("messagesContainer");if(e){this.stopStreamingState();var t=document.createElement("div"),n="rtl"===this.config.direction?"edge-right":"edge-left";t.className="message agent ".concat(n),t.id="agent-streaming";var o=document.createElement("div");o.className="message-avatar agent",o.textContent="ü§ñ";var r=document.createElement("div");r.className="message-bubble",r.innerHTML='<span class="typing-indicator"><span class="typing-dot"></span><span class="typing-dot"></span><span class="typing-dot"></span></span>',t.appendChild(o),t.appendChild(r),e.appendChild(t),this.streamingEl=r,this.hasStartedStreaming=!1,e.scrollTop=e.scrollHeight}}},{key:"appendStreamingChunk",value:function(e){if(this.streamingEl){this.hasStartedStreaming||(this.streamingEl.textContent="",this.hasStartedStreaming=!0),this.streamingEl.textContent+=e;var t=document.getElementById("messagesContainer");t&&(t.scrollTop=t.scrollHeight)}}},{key:"finalizeStreaming",value:function(e){if(this.streamingEl){this.streamingEl.textContent=e||this.streamingEl.textContent;var t=document.getElementById("agent-streaming");t&&(t.id=""),this.streamingEl=null}this.updateSendButtonState()}},{key:"stopStreamingState",value:function(){var e=document.getElementById("agent-streaming");e&&e.remove(),this.streamingEl=null,this.hasStartedStreaming=!1}},{key:"showError",value:function(e){var t=document.getElementById("messagesContainer");if(t){var n=document.createElement("div");n.className="error-message",n.textContent=e,t.appendChild(n),t.scrollTop=t.scrollHeight}}},{key:"setActive",value:function(e){this.isActive=e,this.updateSendButtonState()}}],t&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,o}()},"./src/legacy/VoiceInterface.js":(e,t,n)=>{n.r(t),n.d(t,{VoiceInterface:()=>d});var o=n("./src/index.js");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function c(n,o,r,i){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return a(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(a(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,a(p,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,r,"GeneratorFunction"),a(p),a(p,r,"Generator"),a(p,o,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:c,m:g}})()}function a(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}a=function(e,t,n,o){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},a(e,t,n,o)}function c(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){c(i,o,r,a,s,"next",e)}function s(e){c(i,o,r,a,s,"throw",e)}a(void 0)})}}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function u(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}var d=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.audioStream=null,this.callStartTime=null,this.callTimerInterval=null,this.sdk=null,this.isActive=!1,this.sdk=new o.AgentSDK({agentId:t.agentId,appId:t.appId,getSessionUrl:t.getSessionUrl,websocketUrl:t.websocketUrl,variables:t.variables||{},language:t.language||"en"}),this.setupSDKEventHandlers()},t=[{key:"setupSDKEventHandlers",value:function(){var e=this;this.sdk.onTranscript=function(t){e.updateTranscript(t)},this.sdk.onAgentSpeaking=function(e){var t=document.getElementById("voiceAvatarActive");t&&(e?t.classList.add("speaking"):t.classList.remove("speaking"))},this.sdk.onError=function(t){console.error("‚ùå Voice SDK Error:",t),e.showError(t.message||t)}}},{key:"generateHTML",value:function(){return'<div class="voice-interface" id="voiceInterface">\n      \x3c!-- Before Call State --\x3e\n      <div id="voiceIdleState" style="display: flex; flex-direction: column; align-items: center; width: 100%;">\n        <div class="voice-avatar" id="voiceAvatar">\n          ü§ñ\n        </div>\n        <div class="voice-status">\n          <div class="voice-status-title">'.concat("rtl"===this.config.direction?"◊ú◊ó◊• ◊ú◊î◊™◊ó◊ú◊™ ◊©◊ô◊ó◊î":"Click to Start Call",'</div>\n          <div class="voice-status-subtitle">').concat("rtl"===this.config.direction?"◊©◊ô◊ó◊î ◊ß◊ï◊ú◊ô◊™ ◊ë◊ñ◊û◊ü ◊ê◊û◊™":"Real-time voice conversation",'</div>\n        </div>\n        \x3c!-- BIG START CALL BUTTON --\x3e\n        <button class="start-call-btn" id="startCallBtn">\n          <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">\n            <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/>\n          </svg>\n          <span>').concat("rtl"===this.config.direction?"◊î◊™◊ó◊ú ◊©◊ô◊ó◊î":"Start Call",'</span>\n        </button>\n      </div>\n      \x3c!-- During Call State --\x3e\n      <div id="voiceActiveState" style="display: none; flex-direction: column; align-items: center; width: 100%; height: 100%; justify-content: flex-start; overflow: hidden; padding-top: 10px;">\n        <div class="voice-avatar-active" id="voiceAvatarActive">\n          <div class="voice-rings">\n            <div class="voice-ring"></div>\n            <div class="voice-ring"></div>\n            <div class="voice-ring"></div>\n          </div>\n          ü§ñ\n        </div>\n        <div class="voice-status">\n          <div class="voice-status-title" id="voiceStatusTitleActive">').concat("rtl"===this.config.direction?"◊û◊ß◊©◊ô◊ë...":"Listening...",'</div>\n          <div class="voice-status-subtitle" id="voiceStatusSubtitleActive">').concat("rtl"===this.config.direction?"◊ì◊ë◊® ◊ë◊ó◊ï◊§◊©◊ô◊ï◊™":"Speak freely",'</div>\n        </div>\n        <div class="voice-transcript">\n          <div class="transcript-label">').concat("rtl"===this.config.direction?"◊™◊û◊ú◊ï◊ú ◊ë◊ñ◊û◊ü ◊ê◊û◊™":"Live Transcript",'</div>\n          <div class="transcript-text empty" id="transcriptText">\n            ').concat("rtl"===this.config.direction?"◊î◊™◊û◊ú◊ï◊ú ◊ô◊ï◊§◊ô◊¢ ◊õ◊ê◊ü ◊ë◊û◊î◊ú◊ö ◊î◊©◊ô◊ó◊î...":"Transcript will appear here during the call...",'\n          </div>\n        </div>\n        <div class="voice-controls">\n          <button class="voice-control-btn secondary" id="muteBtn" title="').concat("rtl"===this.config.direction?"◊î◊©◊™◊ß":"Mute",'">\n            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="mute-icon">\n              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>\n              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>\n              <line x1="12" y1="19" x2="12" y2="23"/>\n              <line x1="8" y1="23" x2="16" y2="23"/>\n              <line x1="2" y1="2" x2="22" y2="22" class="mute-cross" style="display: none; stroke: #ef4444; stroke-width: 3.5;"/>\n            </svg>\n          </button>\n          <button class="voice-control-btn primary active" id="endCallBtn">\n            <svg width="56" height="56" viewBox="0 0 24 24" fill="#ef4444">\n              <rect x="6" y="6" width="12" height="12" rx="2"/>\n            </svg>\n            <div class="voice-timer" id="voiceTimer">00:00</div>\n          </button>\n          <button class="voice-control-btn secondary" id="speakerBtn" title="').concat("rtl"===this.config.direction?"◊®◊û◊ß◊ï◊ú":"Speaker",'">\n            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">\n              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>\n              <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>\n              <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>')}},{key:"generateCSS",value:function(){var e=this.config.avatarBackgroundColor||"#667eea",t=this.config.avatarActiveBackgroundColor||this.config.avatarBackgroundColor||"#667eea",n=this.config.statusTitleColor||"#1e293b",o=this.config.statusSubtitleColor||"#64748b",r=this.config.startCallButtonColor||"#667eea",i=this.config.startCallButtonTextColor||"#FFFFFF",a=this.config.transcriptBackgroundColor||"#FFFFFF",c=this.config.transcriptTextColor||"#1e293b",s=this.config.transcriptLabelColor||"#94a3b8",l=this.config.controlButtonColor||"#FFFFFF",u=this.config.controlButtonSecondaryColor||"#64748b",d=this.config.endCallButtonColor||"#ef4444";return"\n      /* Voice Interface Styles */\n      .voice-interface { \n        display: none; \n        flex: 1; \n        flex-direction: column;\n        align-items: center; \n        justify-content: flex-start; \n        padding: 10px 20px 20px 20px; \n        background: linear-gradient(180deg, #f8fafc 0%, #e0e7ff 100%);\n        overflow: hidden;\n        min-height: 0;\n      }\n      .voice-interface.active { display: flex; }\n      \n      /* Voice Avatar (idle state) */\n      .voice-avatar {\n        width: 120px;\n        height: 120px;\n        border-radius: 50%;\n        background: linear-gradient(135deg, ".concat(e," 0%, ").concat(t," 100%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 56px;\n        margin-top: 10px;\n        margin-bottom: 16px;\n        box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);\n        transition: all 0.3s ease;\n        flex-shrink: 0;\n      }\n      \n      /* Voice Avatar (active state with animations) */\n      .voice-avatar-active {\n        width: 120px;\n        height: 120px;\n        border-radius: 50%;\n        background: linear-gradient(135deg, ").concat(e," 0%, ").concat(t," 100%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 56px;\n        margin-top: 10px;\n        margin-bottom: 16px;\n        position: relative;\n        box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);\n        animation: avatarPulse 2s ease-in-out infinite;\n        flex-shrink: 0;\n      }\n      \n      @keyframes avatarPulse {\n        0%, 100% { \n          transform: scale(1);\n          box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);\n        }\n        50% { \n          transform: scale(1.05);\n          box-shadow: 0 15px 50px rgba(102, 126, 234, 0.5);\n        }\n      }\n      \n      .voice-avatar-active.speaking {\n        animation: avatarSpeak 0.5s ease-in-out infinite;\n      }\n      \n      @keyframes avatarSpeak {\n        0%, 100% { transform: scale(1); }\n        50% { transform: scale(1.08); }\n      }\n      \n      /* Voice Rings Animation */\n      .voice-rings {\n        position: absolute;\n        width: 100%;\n        height: 100%;\n        border-radius: 50%;\n      }\n      \n      .voice-ring {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        border: 2px solid rgba(102, 126, 234, 0.3);\n        border-radius: 50%;\n        opacity: 0;\n        animation: ringExpand 2s ease-out infinite;\n      }\n      \n      .voice-ring:nth-child(2) { animation-delay: 0.5s; }\n      .voice-ring:nth-child(3) { animation-delay: 1s; }\n      \n      @keyframes ringExpand {\n        0% {\n          width: 100%;\n          height: 100%;\n          opacity: 0.6;\n        }\n        100% {\n          width: 160%;\n          height: 160%;\n          opacity: 0;\n        }\n      }\n      \n      /* Voice Status */\n      .voice-status {\n        text-align: center;\n        margin-bottom: 10px;\n        flex-shrink: 0;\n      }\n      \n      .voice-status-title {\n        font-size: 18px;\n        font-weight: 600;\n        color: ").concat(n,";\n        margin-bottom: 4px;\n      }\n      \n      .voice-status-subtitle {\n        font-size: 12px;\n        color: ").concat(o,";\n      }\n      \n      /* Start Call Button */\n      .start-call-btn {\n        margin-top: 20px;\n        width: 200px;\n        height: 56px;\n        border-radius: 28px;\n        border: none;\n        background: ").concat(r,";\n        color: ").concat(i,";\n        font-size: 18px;\n        font-weight: 600;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 12px;\n        box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);\n        transition: all 0.3s ease;\n        flex-shrink: 0;\n      }\n      \n      .start-call-btn:hover {\n        transform: translateY(-4px);\n        box-shadow: 0 16px 40px rgba(102, 126, 234, 0.5);\n      }\n      \n      .start-call-btn:active {\n        transform: translateY(-2px);\n      }\n      \n      /* Voice Transcript */\n      .voice-transcript {\n        background: ").concat(a,";\n        padding: 12px;\n        border-radius: 12px;\n        max-width: 300px;\n        width: 100%;\n        margin-bottom: 12px;\n        min-height: 50px;\n        max-height: 90px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n        flex-shrink: 1;\n        overflow-y: auto;\n      }\n      \n      .transcript-label {\n        font-size: 10px;\n        color: ").concat(s,";\n        font-weight: 600;\n        text-transform: uppercase;\n        letter-spacing: 0.5px;\n        margin-bottom: 6px;\n      }\n      \n      .transcript-text {\n        font-size: 14px;\n        color: ").concat(c,";\n        line-height: 1.5;\n        min-height: 30px;\n      }\n      \n      .transcript-text.empty {\n        color: #cbd5e1;\n        font-style: italic;\n      }\n      \n      /* Voice Controls */\n      .voice-controls {\n        display: flex;\n        gap: 12px;\n        align-items: center;\n        flex-shrink: 0;\n      }\n      \n      .voice-control-btn {\n        width: 72px;\n        height: 72px;\n        border-radius: 50%;\n        border: none;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s;\n        position: relative;\n        flex-shrink: 0;\n      }\n      \n      .voice-control-btn.primary {\n        width: 80px;\n        height: 80px;\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);\n      }\n      \n      .voice-control-btn.primary:hover {\n        transform: scale(1.05);\n        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.5);\n      }\n      \n      .voice-control-btn.primary.active {\n        background: ").concat("#ef4444"===d?"white":l,";\n        animation: recordingPulse 1.5s ease-in-out infinite;\n        box-shadow: 0 8px 20px ").concat("#ef4444"===d?"rgba(239, 68, 68, 0.4)":"rgba(0, 0, 0, 0.2)",";\n      }\n      \n      @keyframes recordingPulse {\n        0%, 100% { \n          box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);\n        }\n        50% { \n          box-shadow: 0 8px 30px rgba(239, 68, 68, 0.7);\n        }\n      }\n      \n      .voice-control-btn.secondary {\n        background: ").concat(l,";\n        color: ").concat(u,";\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      }\n      \n      .voice-control-btn.secondary:hover {\n        background: #f8fafc;\n        transform: scale(1.05);\n      }\n      \n      .voice-control-btn.secondary.muted {\n        background: #f3f4f6;\n      }\n      \n      .voice-control-btn.secondary.muted .mute-icon {\n        stroke: #9ca3af !important;\n      }\n      \n      .voice-timer {\n        position: absolute;\n        bottom: -24px;\n        font-size: 12px;\n        color: #64748b;\n        font-weight: 500;\n      }\n    ")}},{key:"setupEventHandlers",value:function(e){var t=this,n=document.getElementById("startCallBtn"),o=document.getElementById("endCallBtn"),r=document.getElementById("muteBtn"),i=document.getElementById("speakerBtn");n&&(n.onclick=function(){return t.startVoiceCall()}),o&&(o.onclick=function(){return t.endVoiceCall()}),r&&(r.onclick=function(){return t.toggleMute()}),i&&(i.onclick=function(){return t.toggleSpeaker()})}},{key:"getSignedUrl",value:(r=s(i().m(function e(){var t,n,o,r,a,c,s;return i().w(function(e){for(;;)switch(e.n){case 0:if(this.config.getSessionUrl){e.n=2;break}if(this.config.agentId){e.n=1;break}throw new Error("agentId is required");case 1:return t=this.config.websocketUrl||"wss://speech.talktopc.com/ws/conv",(n=new URLSearchParams).append("agentId",this.config.agentId),this.config.appId&&n.append("appId",this.config.appId),!1!==this.config.demo&&n.append("demo","true"),e.a(2,"".concat(t,"?").concat(n.toString()));case 2:if("string"!=typeof this.config.getSessionUrl){e.n=6;break}return o={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(o.appId=this.config.appId),e.n=3,fetch(this.config.getSessionUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});case 3:if((r=e.v).ok){e.n=4;break}throw new Error("Failed to get session URL: ".concat(r.statusText));case 4:return e.n=5,r.json();case 5:return a=e.v,e.a(2,a.signedUrl||a.wsUrl||a.url);case 6:if("function"!=typeof this.config.getSessionUrl){e.n=8;break}return c={agentId:this.config.agentId,variables:this.config.variables||{}},this.config.appId&&(c.appId=this.config.appId),e.n=7,this.config.getSessionUrl(c);case 7:return s=e.v,e.a(2,"string"==typeof s?s:s.signedUrl||s.wsUrl||s.url);case 8:throw new Error("getSessionUrl must be a string (backend URL), a function, or omitted (for direct connection with agentId/appId)");case 9:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"startVoiceCall",value:(n=s(i().m(function e(){var t,n,o,r,a,c,s,l,u,d=this;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isActive){e.n=1;break}return console.log("‚ö†Ô∏è Voice call already active"),e.a(2);case 1:return console.log("üé§ Starting voice call..."),e.p=2,t=document.getElementById("voiceIdleState"),n=document.getElementById("voiceActiveState"),o=document.getElementById("voiceInterface"),t&&(t.style.display="none"),n&&(n.style.display="flex"),o&&(o.scrollTop=0),e.n=3,this.getSignedUrl();case 3:return r=e.v,console.log("üîó Got signed URL:",r),e.n=4,this.sdk.connect(r);case 4:a=e.v,console.log("‚úÖ Connected to WebSocket, connected:",a),c=0;case 5:if(this.sdk.isConnected||!(c<50)){e.n=7;break}return e.n=6,new Promise(function(e){return setTimeout(e,100)});case 6:c++,e.n=5;break;case 7:if(!this.sdk.isConnected){e.n=9;break}return console.log("‚úÖ WebSocket ready, starting listening..."),e.n=8,this.sdk.startListening();case 8:console.log("üé§ Started listening"),this.isActive=!0,this.callStartTime=Date.now(),this.callTimerInterval=setInterval(function(){var e=Date.now()-d.callStartTime,t=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3),o=document.getElementById("voiceTimer");o&&(o.textContent="".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0")))},1e3),e.n=11;break;case 9:return console.warn("‚ö†Ô∏è Connection not fully ready, but trying to start listening anyway..."),e.n=10,this.sdk.startListening();case 10:console.log("üé§ Started listening"),this.isActive=!0,this.callStartTime=Date.now(),this.callTimerInterval=setInterval(function(){var e=Date.now()-d.callStartTime,t=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3),o=document.getElementById("voiceTimer");o&&(o.textContent="".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0")))},1e3);case 11:console.log("‚úÖ Voice call started successfully"),e.n=13;break;case 12:e.p=12,u=e.v,console.error("‚ùå Error starting voice call:",u),this.showError(u.message||u),s=document.getElementById("voiceIdleState"),l=document.getElementById("voiceActiveState"),s&&(s.style.display="flex"),l&&(l.style.display="none");case 13:return e.a(2)}},e,this,[[2,12]])})),function(){return n.apply(this,arguments)})},{key:"endVoiceCall",value:function(){console.log("üî¥ Ending voice call..."),this.sdk&&this.isActive&&(this.sdk.stopListening(),this.sdk.disconnect(),this.isActive=!1),this.audioStream&&(this.audioStream.getTracks().forEach(function(e){return e.stop()}),this.audioStream=null),this.callTimerInterval&&(clearInterval(this.callTimerInterval),this.callTimerInterval=null);var e=document.getElementById("voiceIdleState"),t=document.getElementById("voiceActiveState");e&&(e.style.display="flex"),t&&(t.style.display="none");var n=document.getElementById("transcriptText");n&&(n.textContent="rtl"===this.config.direction?"◊î◊™◊û◊ú◊ï◊ú ◊ô◊ï◊§◊ô◊¢ ◊õ◊ê◊ü ◊ë◊û◊î◊ú◊ö ◊î◊©◊ô◊ó◊î...":"Transcript will appear here during the call...",n.classList.add("empty"));var o=document.getElementById("voiceAvatarActive");o&&o.classList.remove("speaking"),console.log("‚úÖ Voice call ended")}},{key:"updateTranscript",value:function(e){var t=document.getElementById("transcriptText");t&&(t.textContent=e,t.classList.remove("empty"))}},{key:"showError",value:function(e){var t=document.getElementById("transcriptText");t&&(t.textContent="rtl"===this.config.direction?"◊©◊í◊ô◊ê◊î: ".concat(e):"Error: ".concat(e),t.classList.remove("empty"))}},{key:"toggleMute",value:function(){if(this.sdk&&this.isActive){var e=null;if(this.sdk.voiceSDK&&this.sdk.voiceSDK.audioRecorder&&this.sdk.voiceSDK.audioRecorder.mediaStream&&(e=this.sdk.voiceSDK.audioRecorder.mediaStream.getAudioTracks()[0]),!e&&this.audioStream&&(e=this.audioStream.getAudioTracks()[0]),e){e.enabled=!e.enabled;var t=document.getElementById("muteBtn"),n=null==t?void 0:t.querySelector(".mute-icon"),o=null==t?void 0:t.querySelector(".mute-cross");t&&n&&o&&(e.enabled?(n.style.stroke="",o.style.display="none",t.classList.remove("muted")):(n.style.stroke="#9ca3af",o.style.display="block",t.classList.add("muted"))),console.log(e.enabled?"üîä Unmuted":"üîá Muted")}else console.warn("‚ö†Ô∏è No audio track available for mute toggle")}}},{key:"toggleSpeaker",value:function(){console.log("üîä Speaker toggle")}},{key:"destroy",value:function(){this.isActive&&this.endVoiceCall(),this.audioStream&&(this.audioStream.getTracks().forEach(function(e){return e.stop()}),this.audioStream=null),this.callTimerInterval&&(clearInterval(this.callTimerInterval),this.callTimerInterval=null),this.sdk&&(this.sdk.disconnect(),this.sdk=null)}}],t&&l(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}()},"./src/react/VoiceButton.jsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var o=n("./node_modules/react/index.js"),r=n("./src/core/VoiceSDK.js"),i=n("./node_modules/react/jsx-runtime.js");function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t,n){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return d(l,"_invoke",function(n,o,r){var i,c,s,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,c=0,s=e,f.n=n,a}};function p(n,o){for(c=n,s=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(s=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(c=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,c=0))}if(r||n>1)return a;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),c=u,s=g;(t=c<2?e:s)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,i){if(c||(r="next"),t=i[r]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=i.return)&&t.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),c=1);i=e}else if((t=(d=f.n<0)?s:n.call(o,f))!==a)break}catch(t){i=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),l}var a={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(d(t={},o,function(){return this}),t),p=l.prototype=c.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,d(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return s.prototype=l,d(p,"constructor",l),d(l,"constructor",s),s.displayName="GeneratorFunction",d(l,r,"GeneratorFunction"),d(p),d(p,r,"Generator"),d(p,o,function(){return this}),d(p,"toString",function(){return"[object Generator]"}),(u=function(){return{w:i,m:g}})()}function d(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}d=function(e,t,n,o){function i(t,n){d(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},d(e,t,n,o)}function f(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,a,c=[],s=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}const v=function(e){var t=e.websocketUrl,n=e.agentId,a=e.voice,c=void 0===a?"default":a,l=e.language,d=void 0===l?"en":l,g=e.autoReconnect,v=void 0===g||g,h=e.onConnected,y=e.onDisconnected,b=e.onRecordingStarted,m=e.onRecordingStopped,w=e.onPlaybackStarted,k=e.onPlaybackStopped,x=e.onError,S=e.onMessage,C=e.onBargeIn,j=e.onStopPlaying,O=e.className,E=void 0===O?"":O,I=e.style,P=void 0===I?{}:I,B=e.children,_=p((0,o.useState)(!1),2),T=_[0],F=_[1],R=p((0,o.useState)(!1),2),A=R[0],D=R[1],M=p((0,o.useState)(!1),2),L=(M[0],M[1]),H=p((0,o.useState)("Disconnected"),2),U=(H[0],H[1]),z=(0,o.useRef)(null);(0,o.useEffect)(function(){console.log("üéôÔ∏è VoiceButton: Creating VoiceSDK instance for ".concat(t)),z.current&&(console.log("üéôÔ∏è VoiceButton: Destroying existing VoiceSDK instance"),z.current.destroy(),z.current=null);var e=new r.default({websocketUrl:t,agentId:n,voice:c,language:d,autoReconnect:v});return e.on("connected",function(){F(!0),U("Connected"),null==h||h()}),e.on("disconnected",function(){F(!1),U("Disconnected"),null==y||y()}),e.on("recordingStarted",function(){D(!0),null==b||b()}),e.on("recordingStopped",function(){D(!1),null==m||m()}),e.on("playbackStarted",function(){L(!0),null==w||w()}),e.on("playbackStopped",function(){L(!1),null==k||k()}),e.on("error",function(e){null==x||x(e)}),e.on("message",function(e){null==S||S(e)}),e.on("bargeIn",function(e){null==C||C(e)}),e.on("stopPlaying",function(e){null==j||j(e)}),z.current=e,e.connect(),function(){console.log("üéôÔ∏è VoiceButton: Cleaning up VoiceSDK instance for ".concat(t)),z.current&&(z.current.destroy(),z.current=null)}},[t,n,c,d]);var K=function(){var e,t=(e=u().m(function e(){var t;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(z.current){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,z.current.toggleRecording();case 2:e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error toggling recording:",t);case 4:return e.a(2)}},e,null,[[1,3]])}),function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){f(i,o,r,a,c,"next",e)}function c(e){f(i,o,r,a,c,"throw",e)}a(void 0)})});return function(){return t.apply(this,arguments)}}(),N=(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("div",{style:{fontSize:"20px"},children:A?"üî¥":"üé§"}),(0,i.jsx)("div",{children:A?"Stop Listening":"Start Listening"})]});return(0,i.jsx)("button",{className:"voice-button ".concat(A?"recording":""," ").concat(E),style:s({padding:"12px 24px",border:"none",borderRadius:"8px",backgroundColor:A?"#dc3545":"#007bff",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"500",transition:"all 0.2s ease"},P),onClick:K,disabled:!T,children:B||N})}},"./src/vanilla/VoiceButton.js":(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var o=n("./src/core/VoiceSDK.js");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function c(n,o,r,i){var c=o&&o.prototype instanceof l?o:l,u=Object.create(c.prototype);return a(u,"_invoke",function(n,o,r){var i,a,c,l=0,u=r||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,c=e,f.n=n,s}};function p(n,o){for(a=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,i=u[t],p=f.p,g=i[2];n>3?(r=g===o)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=o,f.n=i[1]):p<g&&(r=n<3||i[0]>o||o>g)&&(i[4]=n,i[5]=o,f.n=g,a=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,g){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,g),a=u,c=g;(t=a<2?e:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=e}else if((t=(d=f.n<0)?c:n.call(o,f))!==s)break}catch(t){i=e,a=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,i),!0),u}var s={};function l(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=[][o]?t(t([][o]())):(a(t={},o,function(){return this}),t),p=d.prototype=l.prototype=Object.create(f);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,r,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,a(p,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,r,"GeneratorFunction"),a(p),a(p,r,"Generator"),a(p,o,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(i=function(){return{w:c,m:g}})()}function a(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}a=function(e,t,n,o){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},a(e,t,n,o)}function c(e,t,n,o,r,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){c(i,o,r,a,s,"next",e)}function s(e){c(i,o,r,a,s,"throw",e)}a(void 0)})}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function u(e,t,n){return(t=f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,f(o.key),o)}}function f(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}var p=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({websocketUrl:t.websocketUrl||"wss://speech.talktopc.com/ws/conv",agentId:t.agentId,voice:t.voice||"default",language:t.language||"en",container:t.container||document.body,buttonText:t.buttonText||"Start Listening",buttonClass:t.buttonClass||"voice-button"},t),this.isConnected=!1,this.isRecording=!1,this.isPlaying=!1,this.voiceSDK=new o.default({websocketUrl:this.options.websocketUrl,agentId:this.options.agentId,voice:this.options.voice,language:this.options.language}),this.setupEventListeners(),this.createButton(),this.connect()},t=[{key:"setupEventListeners",value:function(){var e=this;this.voiceSDK.on("connected",function(){var t,n;e.isConnected=!0,e.updateButton(),null===(t=(n=e.options).onConnected)||void 0===t||t.call(n)}),this.voiceSDK.on("disconnected",function(){var t,n;e.isConnected=!1,e.updateButton(),null===(t=(n=e.options).onDisconnected)||void 0===t||t.call(n)}),this.voiceSDK.on("recordingStarted",function(){var t,n;e.isRecording=!0,e.updateButton(),null===(t=(n=e.options).onRecordingStarted)||void 0===t||t.call(n)}),this.voiceSDK.on("recordingStopped",function(){var t,n;e.isRecording=!1,e.updateButton(),null===(t=(n=e.options).onRecordingStopped)||void 0===t||t.call(n)}),this.voiceSDK.on("playbackStarted",function(){var t,n;e.isPlaying=!0,null===(t=(n=e.options).onPlaybackStarted)||void 0===t||t.call(n)}),this.voiceSDK.on("playbackStopped",function(){var t,n;e.isPlaying=!1,null===(t=(n=e.options).onPlaybackStopped)||void 0===t||t.call(n)}),this.voiceSDK.on("error",function(t){var n,o;null===(n=(o=e.options).onError)||void 0===n||n.call(o,t)}),this.voiceSDK.on("message",function(t){var n,o;null===(n=(o=e.options).onMessage)||void 0===n||n.call(o,t)}),this.voiceSDK.on("bargeIn",function(t){var n,o;null===(n=(o=e.options).onBargeIn)||void 0===n||n.call(o,t)}),this.voiceSDK.on("stopPlaying",function(t){var n,o;null===(n=(o=e.options).onStopPlaying)||void 0===n||n.call(o,t)})}},{key:"createButton",value:function(){var e=this;this.button=document.createElement("button"),this.button.className=this.options.buttonClass,this.button.style.cssText="\n      padding: 12px 24px;\n      border: none;\n      border-radius: 8px;\n      background-color: #6c757d;\n      color: white;\n      cursor: pointer;\n      font-size: 16px;\n      font-weight: 500;\n      transition: all 0.2s ease;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    ",this.button.addEventListener("click",function(){return e.toggleRecording()}),this.options.container.appendChild(this.button),this.updateButton()}},{key:"updateButton",value:function(){if(this.button){var e=this.isRecording?"üî¥":"üé§",t=this.isRecording?"Stop Listening":"Start Listening";this.button.innerHTML='\n      <span style="font-size: 20px;">'.concat(e,"</span>\n      <span>").concat(t,"</span>\n    "),this.button.disabled=!this.isConnected,this.button.style.backgroundColor=this.isRecording?"#dc3545":this.isConnected?"#007bff":"#6c757d"}}},{key:"connect",value:(r=s(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.voiceSDK.connect();case 1:e.n=3;break;case 2:e.p=2,t=e.v,console.error("Failed to connect:",t);case 3:return e.a(2)}},e,this,[[0,2]])})),function(){return r.apply(this,arguments)})},{key:"toggleRecording",value:(n=s(i().m(function e(){var t;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.voiceSDK){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,this.voiceSDK.toggleRecording();case 2:e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error toggling recording:",t);case 4:return e.a(2)}},e,this,[[1,3]])})),function(){return n.apply(this,arguments)})},{key:"getStatus",value:function(){return{isConnected:this.isConnected,isRecording:this.isRecording,isPlaying:this.isPlaying}}},{key:"updateConfig",value:function(e){this.voiceSDK.updateConfig(e)}},{key:"destroy",value:function(){this.button&&this.button.parentNode&&this.button.parentNode.removeChild(this.button),this.voiceSDK&&this.voiceSDK.destroy()}}],t&&d(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}()}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o](i,i.exports,n),i.loaded=!0,i.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n("./src/index.js")})());
//# sourceMappingURL=agent-widget.js.map